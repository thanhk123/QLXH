{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/admin/assets/js/_alternating.js","webpack:///./app/admin/assets/js/_changeTheme.js","webpack:///./app/admin/assets/js/_chart.js","webpack:///./app/admin/assets/js/_customRenderer.js","webpack:///./app/admin/assets/js/_functions.js","webpack:///./app/admin/assets/js/_initHandsontable.js","webpack:///./app/admin/assets/js/_toolbarOptions.js","webpack:///./app/admin/assets/js/_wptm.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AACyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;;AAET;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA;AACA,kDAAkD;AAClD;AACA;;AAEA,+BAA+B,oBAAoB;AACnD,mCAAmC,oBAAoB;AACvD;AACA;AACA,2GAA2G,sBAAsB;AACjI,iBAAiB,OAAO;AACxB,6DAA6D;AAC7D,sDAAsD;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,gCAAgC,SAAS;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,4CAA4C;;AAE5C,iFAAiF,QAAQ;AACzF;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA,KAAK;;;;AAIL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS,OAAO;AAChB;AACA;AACA;;AAEA;AACA;;AAEA,YAAY,kDAAa;AACzB;AACA;AACA;AACA,YAAY,kDAAa;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oEAAoE,mBAAmB;AAClH;;AAEA;AACA;;AAEA;AACA;AACA,wBAAwB,iBAAiB;AACzC,4BAA4B,iBAAiB;AAC7C;AACA;AACA,qBAAqB;AACrB,qEAAqE;AACrE,6EAA6E,GAAG,kBAAkB;AAClG;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6CAA6C;AAC7C,KAAK;AACL;AACA;AACA;AACA,kCAAkC;AAClC,6EAA6E;AAC7E,sEAAsE;;AAEtE;AACA;AACA,sEAAsE,uDAAuD;AAC7H,0EAA0E,uDAAuD;AACjI;AACA,iIAAiI,0DAA0D;AAC3L,qBAAqB,OAAO;AAC5B,wEAAwE;AACxE,mEAAmE;AACnE;AACA;AACA;;AAEA,+DAA+D,qFAAqF,2DAA2D;AAC/M;AACA;;AAEA,QAAQ,kDAAa;AACrB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC,iBAAiB;AACjB,oCAAoC;AACpC;AACA;AACA;AACA;AACA,mCAAmC,kDAAa;AAChD;AACA,mCAAmC,kDAAa;AAChD,iBAAiB;AACjB;AACA,mCAAmC,kDAAa;AAChD;AACA,mCAAmC,kDAAa;AAChD,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;;AAEe,0EAAW;;;;;;;;;;;;;ACvU1B;AAAA;AAAA;AAAA;AAAyC;AACA;AACG;;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,IAAI;AAC3C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oBAAoB,kDAAa;;AAEjC;AACA;AACA;AACA;;AAEA;AACA,yDAAyD;;AAEzD;AACA;AACA;AACA;AACA;AACA,gFAAgF;AAChF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,kDAAa;;AAEjC;AACA;;AAEA;;AAEA;AACA,4BAA4B,oDAAW;AACvC;;AAEA;AACA;AACA,iFAAiF;AACjF;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC;AACA,6DAA6D,IAAI;AACjE,yBAAyB;AACzB,qBAAqB;AACrB,oBAAoB,kDAAa;;AAEjC,gEAAgE;AAChE,wBAAwB,uDAAY;AACpC;AACA,iBAAiB;AACjB;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,KAAK;AACL;;AAEe,2EAAY;;;;;;;;;;;;;ACvI3B;AAAA;AAAA;AAAA;AAAyC;AACA;AACM;;AAE/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,SAAS;AACT;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,QAAQ,kDAAa;AACrB;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,YAAY,kDAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA,2BAA2B,6BAA6B;AACxD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA6F;AAC7F;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wIAAwI;AACxI;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oDAAW;AAC3B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,gBAAgB;AACnC,kCAAkC,IAAI;AACtC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,oCAAoC,IAAI;;AAExC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,uDAAuD;;AAEvD;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,wIAAwI;AACxI;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sCAAsC;AACtC,KAAK;AACL,sCAAsC;AACtC;;AAEA;AACA,kCAAkC;AAClC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,kDAAkD;AAClD,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA6E,eAAe;AAC5F,aAAa;AACb,iCAAiC,eAAe;AAChD;AACA;AACA,SAAS;AACT;AACA,6BAA6B,eAAe;AAC5C;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wHAAwH;AACxH;AACA;AACA,SAAS,OAAO;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,oDAAoD;;AAEpD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iHAAiH;AACjH,4BAA4B,iBAAiB;AAC7C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA,SAAS;AACT,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;;AAEA,wBAAwB,yBAAyB;AACjD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,8BAA8B;AAC9B;AACA;;AAEA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA,yBAAyB,uDAAc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wHAAwH;AACxH;AACA;AACA,SAAS,OAAO;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,0CAA0C;AAC1C,kDAAkD;;AAElD;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6HAA6H;AAC7H,4BAA4B,iBAAiB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC;AACA,SAAS;AACT,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;;AAEA,eAAe,sBAAsB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe,oBAAoB;AACnC;AACA,uBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA,+BAA+B,qBAAqB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,kBAAkB;AACjD;AACA,mCAAmC,qBAAqB;AACxD;AACA,yCAAyC,kDAAa;AACtD,yBAAyB;AACzB,mDAAmD;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;;AAEtB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;;AAEnD,iBAAiB;AACjB,iBAAiB;AACjB;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,eAAe,gBAAgB;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA,qBAAqB,kDAAa;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA,6DAA6D,kDAAa;AAC1E;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,gBAAgB;AACnC,kBAAkB,kDAAa;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;;AAEe,wEAAS;;;;;;;;;;;;;AC58CxB;AAAA;AAAyC;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,QAAQ,kDAAa;AACrB;AACA;AACA,QAAQ,kDAAa;AACrB;AACA;;AAEA,QAAQ,kDAAa;AACrB;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,YAAY,kDAAa;AACzB;AACA;AACA,YAAY,kDAAa;AACzB;AACA;;AAEA,YAAY,kDAAa;AACzB;AACA,+CAA+C;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kDAAa;AACjD;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA;;AAEA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA,2EAA2E;AAC3E,iBAAiB;AACjB,iDAAiD;AACjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8EAA8E;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT,yDAAyD,kDAAa;AACtE;AACA,KAAK;AACL;AACA;AACA,SAAS;AACT,yDAAyD,kDAAa;AACtE;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,oCAAoC,kDAAa;AACjD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,kDAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,2BAA2B,uDAAuD;AAClF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,+BAA+B,kDAAa;AAC5C;AACA;AACA;AACA,oCAAoC,kDAAa,yEAAyE;;AAE1H;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sCAAsC;AACtC;AACA,wBAAwB,OAAO,OAAO,QAAQ,GAAG,aAAa,cAAc;AAC5E;AACA;AACA,oBAAoB,mBAAmB;AACvC;AACA;AACA;AACA;AACA,qCAAqC;AACrC;;AAEA;AACA;AACA;AACA,+BAA+B,qBAAqB;AACpD;AACA;AACA;AACA,yFAAyF,kDAAa;AACtG;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sGAAsG,kDAAa;;AAEnH;AACA;AACA,uFAAuF;AACvF;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,6EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA,oFAAoF,kDAAa;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6FAA6F,kDAAa,mDAAmD,kDAAa;AAC1K;AACA,+BAA+B,mBAAmB;AAClD,+EAA+E;AAC/E;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,iBAAiB;AACjB,wBAAwB,kDAAa;AACrC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,yEAAyE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,kDAAa;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;;AAEA,6CAA6C,aAAa;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEe;AACf;AACA;AACA,CAAC;;;;;;;;;;;;;AChhCD;AAAA;AAAA;AAAA;AAAwC;AACN;AACmB;;AAErD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,6BAA6B,iDAAiD,EAAE;AACxG,KAAK;AACL;AACA,sBAAsB,wBAAwB;AAC9C;AACA;AACA;AACA,8BAA8B,yBAAyB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iDAAiD;AACxF;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,6BAA6B,iDAAiD,EAAE;AAC9G;AACA;AACA;;AAEA;AACA,wBAAwB,QAAQ,QAAQ,iBAAiB;AACzD,8DAA8D;AAC9D;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,QAAQ,QAAQ,iBAAiB;AACzD,sEAAsE;AACtE;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,KAAK;AACL,2BAA2B;AAC3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC,gBAAgB;AACnD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gCAAgC;AAC1E;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iDAAiD,EAAE,oDAAW;AAC9D;;AAEA;;AAEA,uDAAuD;AACvD;AACA;AACA,uBAAuB,0CAA0C;AACjE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,sEAAsE,wBAAwB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,wCAAwC,IAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,uCAAuC,iGAAiG;AACxI;AACA,yDAAyD,iFAAiF;AAC1I;AACA;AACA;AACA,iBAAiB;AACjB,wBAAwB;AACxB,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA;AACA,SAAS;;AAET;AACA,YAAY,6CAAW;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gBAAgB,wCAAwC;AACxD,kCAAkC,uBAAuB;AACzD,sCAAsC,uBAAuB;AAC7D;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ,6CAAW;AACnB;AACA,uDAAuD;AACvD;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA4B,gEAAgE;AAC5F;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wDAAwD;AACxD,8DAA8D;AAC9D;;AAEA;AACA;AACA;AACA;;AAEA;AACA,8DAA8D;AAC9D,oEAAoE;AACpE;AACA;;AAEA,yFAAyF;AACzF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2FAA2F,yEAAyE;AACpK,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,mBAAmB,uCAAuC;AAC1D,sCAAsC,uBAAuB;AAC7D;AACA;AACA;AACA,KAAK;AACL,mBAAmB,uCAAuC;AAC1D,sCAAsC,uBAAuB;AAC7D,0CAA0C,uBAAuB;AACjE;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,+BAA+B,mDAAmD;AAClF;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,2BAA2B,mDAAmD;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,uCAAuC;AACvC;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT,sDAAsD;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,uCAAuC;AACvC;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,SAAS;AACT,sDAAsD;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT,mCAAmC;AACnC;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT,sDAAsD;AACtD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,mCAAmC,gBAAgB;AACnD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yFAAyF,EAAE;;AAE3F;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,wBAAwB;AAC3C;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA,iBAAiB,kBAAkB;AACnC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uDAAuD,2BAA2B;AAClF,uDAAuD,wBAAwB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,OAAO;AAChB,kFAAkF;AAClF;AACA,aAAa;AACb,6BAA6B;AAC7B;AACA;;AAEA,sDAAsD,wBAAwB;AAC9E;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,UAAU;AACzB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA,sDAAsD,2BAA2B;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gGAAgG,8BAA8B;AAC9H,wBAAwB,qCAAqC,wCAAwC,2BAA2B,yBAAyB,0BAA0B,sCAAsC,yBAAyB,uBAAuB,uCAAuC,0BAA0B,wBAAwB,qCAAqC,wBAAwB,sBAAsB,wBAAwB,uBAAuB,oBAAoB,kBAAkB,4DAA4D,gBAAgB,oBAAoB,kBAAkB,mBAAmB,mBAAmB,mBAAmB,oBAAoB,kBAAkB,mBAAmB,iBAAiB,mBAAmB,oBAAoB,oBAAoB,oBAAoB;AAC90B,mGAAmG,qBAAqB;AACxH;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,KAAK,OAAO;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,6CAA6C;AAC7C;AACA,0EAA0E;AAC1E,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,8BAA8B,mBAAmB,OAAO;AACxD,kCAAkC,mBAAmB,OAAO;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,+BAA+B,wDAAwD,iBAAiB;AACxG,aAAa;AACb,yDAAyD;AACzD;;AAEA;AACA;AACA;AACA,+BAA+B,wDAAwD,mBAAmB;;AAE1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA,KAAK;AACL,iCAAiC,sBAAsB;AACvD,qCAAqC,sBAAsB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAA0B,2CAA2C,4BAA4B,+BAA+B;AAChI,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,eAAe,+CAA+C;AAC9D;AACA;AACA;AACA;AACA;AACA,wEAAwE;AACxE;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,4BAA4B;AAC5B,SAAS;AACT,4BAA4B;AAC5B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA,qBAAqB,wFAAwF;AAC7G;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA,qBAAqB,wFAAwF;AAC7G;AACA;AACA;AACA;AACA,8DAA8D;AAC9D,2FAA2F;AAC3F;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA,qBAAqB,wFAAwF;AAC7G;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA,+FAA+F;AAC/F;AACA;AACA,yBAAyB,OAAO;AAChC;AACA;AACA;AACA,qBAAqB,wFAAwF;AAC7G;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC,oBAAoB,QAAQ;AAC/D,4CAA4C,qBAAqB;AACjE;AACA,yHAAyH,aAAa;AACtI;AACA;AACA;AACA,SAAS,8BAA8B;AACvC;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC,oBAAoB;AACvD;AACA;AACA,SAAS,OAAO;AAChB;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,2FAA2F;AAC3F;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,sGAAsG;AACtG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC,oBAAoB;AACvD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,6EAA6E,0CAA0C;AACvH;AACA;AACA,gFAAgF,6CAA6C;AAC7H;AACA;AACA,8EAA8E,2CAA2C;AACzH;AACA;AACA,+EAA+E,4CAA4C;AAC3H;;AAEA;AACA;AACA;AACA;AACA,sGAAsG,oBAAoB;AAC1H,4GAA4G,iBAAiB;AAC7H;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;ACtvEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACyC;AACI;AACE;AACd;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,+DAA+D;AAC/D,mCAAmC;AACnC;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,kBAAkB,uDAAc;AAChC,gBAAgB,kDAAa;AAC7B;AACA,YAAY,8CAAS;AACrB;AACA;;AAEA,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA,4CAA4C,QAAQ;AACpD,2EAA2E;AAC3E,yBAAyB,8CAAS;AAClC;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA,oGAAoG,iDAAiD;AACrJ;AACA,6GAA6G,iDAAiD;AAC9J;AACA;AACA,8GAA8G,iDAAiD;AAC/J;AACA;AACA,gHAAgH,iDAAiD;AACjK;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,YAAY,kDAAa;;AAEzB;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,SAAS;AACT,gDAAgD;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,kDAAa;AAC7B;;AAEA;AACA,uBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;;AAEA,2GAA2G;AAC3G;AACA,4CAA4C,kDAAa;AACzD;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,+DAA+D,0EAA0E;AACzI,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE;AACrE;AACA;AACA,qCAAqC;AACrC;AACA;AACA,+DAA+D,iFAAiF;AAChJ,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,iCAAiC;AACjC,mDAAmD,iFAAiF;AACpI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,oGAAoG;AACpG;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA,aAAa;AACb;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,6DAA6D;;AAE7D;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;AACA,uEAAuE;AACvE;AACA,2CAA2C;AAC3C;AACA,8DAA8D;AAC9D;AACA,6EAA6E;AAC7E;AACA,8FAA8F;AAC9F;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA,oCAAoC;AACpC,wFAAwF;AACxF;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC,+EAA+E;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA,4CAA4C;AAC5C,oCAAoC,8BAA8B;AAClE,gEAAgE;AAChE,8DAA8D;AAC9D;AACA,iBAAiB;AACjB,oCAAoC,uCAAuC;AAC3E,8CAA8C;AAC9C,qDAAqD;AACrD;AACA;;AAEA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;AACA,2BAA2B,iEAAiE;;AAE5F;AACA;AACA,YAAY,kDAAa,sDAAsD,iDAAiD;;AAEhI,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA,+GAA+G;AAC/G;AACA;AACA,wEAAwE;AACxE;AACA;AACA,+GAA+G;AAC/G;AACA,wGAAwG;AACxG;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA,gCAAgC,8BAA8B;AAC9D;AACA,8CAA8C;AAC9C,qDAAqD;AACrD,qBAAqB;AACrB;AACA;AACA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;;AAEA,2BAA2B,uHAAuH;AAClJ;AACA;AACA,YAAY,kDAAa,sDAAsD,iDAAiD;;AAEhI,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA;AACA;AACA,4DAA4D;;AAE5D;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;AACA,uEAAuE;AACvE;AACA,2CAA2C;AAC3C;AACA,8DAA8D;AAC9D;AACA,6EAA6E;AAC7E;AACA,8FAA8F;AAC9F;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA,mCAAmC;AACnC,+EAA+E;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,OAAO;AAChC,+EAA+E;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA,4CAA4C;AAC5C,oCAAoC,8BAA8B;AAClE,gEAAgE;AAChE,8DAA8D;AAC9D;AACA,iBAAiB;AACjB,oCAAoC,uCAAuC;AAC3E,8CAA8C;AAC9C,qDAAqD;AACrD;AACA;;AAEA,6CAA6C;AAC7C;;AAEA,+BAA+B,4BAA4B;AAC3D;AACA;;AAEA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;;AAEA;AACA,YAAY,kDAAa;;AAEzB;AACA,2BAA2B,+DAA+D;;AAE1F;AACA;AACA,YAAY,kDAAa,sDAAsD,8CAA8C;;AAE7H,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA,8CAA8C;;AAE9C,kFAAkF;AAClF;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA,+GAA+G;AAC/G;AACA;AACA,wEAAwE;AACxE;AACA;AACA,+GAA+G;AAC/G;AACA,wGAAwG;AACxG;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C;AACA,gCAAgC,8BAA8B;AAC9D;AACA,8CAA8C;AAC9C,qDAAqD;AACrD,qBAAqB;AACrB;AACA;AACA;AACA,6CAA6C;AAC7C;;AAEA,8CAA8C,aAAa;AAC3D;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA+B,uBAAuB;AACtD;AACA;AACA;;AAEA;AACA,YAAY,kDAAa;AACzB;AACA,2BAA2B,0HAA0H;;AAErJ;AACA,YAAY,kDAAa,sDAAsD,iDAAiD;;AAEhI,YAAY,kDAAa;AACzB,SAAS;AACT;AACA,YAAY,kDAAa;AACzB,SAAS;AACT;AACA,qCAAqC;AACrC;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;;AAEA,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA,YAAY,uDAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,sFAAsF,mBAAmB;AACzG;AACA,SAAS;AACT;AACA;AACA;AACA,sFAAsF,mBAAmB;AACzG;AACA,SAAS;AACT;AACA,gBAAgB,kDAAa;AAC7B;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA,gBAAgB,kDAAa;AAC7B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6EAA6E;AAC7E;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,mBAAmB,kDAAa;AAChC,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,uCAAuC;AAC1F;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,uCAAuC;AAC1F;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA,wCAAwC,kDAAa;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,yCAAyC;AACzC,qCAAqC;AACrC,yDAAyD;AACzD;AACA,iDAAiD,kDAAa;AAC9D;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA,mDAAmD,uCAAuC;AAC1F;AACA;AACA;AACA,0FAA0F,2CAA2C;AACrI;AACA;AACA;AACA,8FAA8F,2CAA2C;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,yFAAyF;AAChK;AACA,wDAAwD,kDAAa;AACrE,qDAAqD;AACrD,iDAAiD;AACjD;AACA;AACA;AACA,6CAA6C;AAC7C;AACA,qCAAqC;AACrC,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,oBAAoB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA,mDAAmD,mBAAmB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,mDAAmD,mBAAmB;AACtE;AACA;AACA;AACA;AACA;AACA,0DAA0D,oBAAoB;AAC9E;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;AACzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;;AAEzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;;AAEzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;;AAEzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,4DAA4D,wCAAwC;AACpG,kGAAkG,2CAA2C;AAC7I;AACA;AACA;AACA;;AAEA,kEAAkE,uEAAuE;AACzI;AACA;AACA;AACA,iDAAiD;AACjD,gDAAgD,kDAAa;AAC7D,gDAAgD,kDAAa;AAC7D;AACA,yCAAyC;;AAEzC,qCAAqC;AACrC,iCAAiC;AACjC;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,0DAA0D,kDAAa,6BAA6B,eAAe;AACnH,qCAAqC;AACrC,0DAA0D,kDAAa,6BAA6B,eAAe;AACnH;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,0DAA0D,kDAAa,6BAA6B,eAAe;AACnH,qCAAqC;AACrC,0DAA0D,kDAAa,6BAA6B,eAAe;AACnH;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4BAA4B,kDAAa,iCAAiC,iBAAiB;AAC3F,4BAA4B,kDAAa,8BAA8B,iBAAiB;AACxF;AACA,4BAA4B,kDAAa;AACzC,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA,wCAAwC,kDAAa;AACrD;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,kDAAa;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qDAAqD;AACrD,wDAAwD,kDAAa;AACrE;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA,gCAAgC,uDAAY;AAC5C;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA,IAAI,uDAAY;;AAEhB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0CAA0C;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C,QAAQ,kDAAa;AACrB;;AAEA;;AAEA,eAAe,qCAAqC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ,kDAAa;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,uBAAuB,UAAU;AACjC;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,4BAA4B;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,+BAA+B;AAC5E;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACpwDA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkC;AACO;AACC;AACD;AACR;;AAEjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,IAAI;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,gCAAgC;AACjE;AACA;AACA,qBAAqB;AACrB,+BAA+B,kBAAkB;AACjD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA,iGAAiG;AACjG;AACA,sDAAsD,UAAU;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;;AAErB,oBAAoB,4DAAY;AAChC,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,+JAA+J;AAC/J;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,6BAA6B;AAC5E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,uDAAuD,wCAAwC;AAC/F;AACA;AACA,sEAAsE,kDAAa;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAuC,iCAAiC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,oDAAW;AAC/C,iCAAiC;AACjC,gDAAgD,oDAAW;;AAE3D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oCAAoC,oDAAW;AAC/C,wCAAwC,oDAAW;AACnD;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;;AAEA;AACA;AACA,yCAAyC;AACzC;AACA;;AAEA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,wCAAwC,oDAAW;AACnD;AACA,iCAAiC;AACjC;AACA,gDAAgD,oDAAW;AAC3D;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;;AAEA;AACA;AACA,yCAAyC;AACzC;AACA;;AAEA;;AAEA,wCAAwC,oDAAW;AACnD,4CAA4C,oDAAW;AACvD;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,4BAA4B,oDAAW;AACvC,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,wDAAwD;AACxD;AACA,6BAA6B;AAC7B,8DAA8D,EAAE,oDAAW;AAC3E,wEAAwE;AACxE;;AAEA,4BAA4B,oDAAW;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,sBAAsB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,sEAAsE;AACtE;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B,kDAAa;AACzC;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kCAAkC;AAC1E,0DAA0D,uBAAuB;AACjF;AACA,kEAAkE,+BAA+B;AACjG;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,4BAA4B,kDAAa;AACzC;;AAEA;AACA,wBAAwB,kDAAa;AACrC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,sBAAsB;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,6BAA6B;AAC7B,0EAA0E;AAC1E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B,kDAAa;AACzC;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,kCAAkC;AAC1E,0DAA0D,uBAAuB;AACjF;AACA;AACA,sEAAsE,iCAAiC;AACvG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,kBAAkB;AAC7D;AACA,kEAAkE,kBAAkB;AACpF;AACA;AACA;AACA,mDAAmD,kDAAa,8BAA8B,wBAAwB;AACtH;AACA;AACA;AACA,uCAAuC;AACvC;AACA,4BAA4B,kDAAa;AACzC;;AAEA;AACA,wBAAwB,kDAAa;AACrC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,OAAO;AAC9C;AACA,gDAAgD,2BAA2B;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,wBAAwB,kDAAa,oCAAoC,yBAAyB;AAClG,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA,8EAA8E,gCAAgC;AAC9G,yBAAyB;AACzB,8EAA8E,gBAAgB;AAC9F;;AAEA,wBAAwB,kDAAa;AACrC;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,gCAAgC,kDAAa;AAC7C;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA,4BAA4B,kDAAa;AACzC,4BAA4B,kDAAa;AACzC;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,wBAAwB,kDAAa;AACrC;;AAEA,wBAAwB,kDAAa;AACrC;;AAEA,wBAAwB,kDAAa;AACrC;;AAEA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;;AAErC;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;;AAEA;AACA;AACA;AACA;;AAEA,gCAAgC,kDAAa;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA,uCAAuC,6BAA6B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C,kDAAa,6BAA6B,wCAAwC;AAChI,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,mCAAmC,kDAAa;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;;AAErC,wBAAwB,kDAAa;AACrC;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA,kEAAkE,kDAAa;AAC/E;;AAEA,wCAAwC,kDAAa;AACrD;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,kDAAa;AACzC;AACA,uDAAuD,kDAAa,kDAAkD;AACtH;;AAEA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA,gCAAgC,kDAAa;AAC7C,6BAA6B;AAC7B;AACA,oCAAoC,kDAAa;AACjD,iCAAiC;AACjC,oCAAoC,kDAAa;AACjD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oDAAW;AAC/C;AACA;AACA,oCAAoC,kDAAa;;AAEjD;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,kDAAa;;AAE7C;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA,4BAA4B,oDAAW;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,kDAAa;AACzC,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,wCAAwC,kDAAa;;AAErD,sDAAsD;AACtD;AACA,wBAAwB,kDAAa;;AAErC;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,kDAAa,gCAAgC,mFAAmF;AAC5J;;AAEA;AACA,4BAA4B,kDAAa,gCAAgC,2FAA2F;AACpK;;AAEA;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;;AAErC;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,kDAAa,gCAAgC,gFAAgF;AACzJ;AACA;AACA,4BAA4B,kDAAa,gCAAgC,0HAA0H;AACnM;AACA;AACA,4BAA4B,kDAAa,gCAAgC,mFAAmF;AAC5J;;AAEA;AACA,wBAAwB,kDAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA,yBAAyB;AACzB,wEAAwE,kDAAa;AACrF;;AAEA,8EAA8E;AAC9E,4JAA4J,GAAG;AAC/J;;AAEA;AACA,4BAA4B,kDAAa;AACzC,sEAAsE,aAAa,+BAA+B,eAAe;AACjI,yBAAyB;AACzB,qBAAqB;AACrB;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;;AAErC,wBAAwB,kDAAa;AACrC;;AAEA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,wCAAwC;AACxC;;AAEA;AACA;AACA,6BAA6B;AAC7B,+DAA+D,kDAAa;AAC5E;;AAEA,4BAA4B,kDAAa;AACzC;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,4BAA4B,kDAAa;AACzC;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;AACrC;;AAEA;AACA;AACA,2CAA2C,kDAAa;AACxD;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC;AACxC;;AAEA,4BAA4B,kDAAa;AACzC;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,2CAA2C,kDAAa;AACxD;;AAEA,4BAA4B,kDAAa;AACzC;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa;AACrC,wBAAwB,kDAAa;;AAErC,wBAAwB,kDAAa;AACrC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wCAAwC;AACxC;;AAEA,4BAA4B,kDAAa;AACzC;AACA,yBAAyB;;AAEzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,4BAA4B,kDAAa;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,8CAAS;AACzB;AACA;AACA;AACA;AACA;AACA,oBAAoB,kDAAa;AACjC,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA,0CAA0C,mBAAmB;AAC7D,8CAA8C,mBAAmB;AACjE;AACA,mDAAmD,kDAAa;AAChE;AACA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B,mDAAmD,kDAAa,8BAA8B,yBAAyB;AACvH;AACA;AACA,+CAA+C;AAC/C;AACA;AACA,sCAAsC;AACtC,gCAAgC,kDAAa;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC;AACnC;;AAEA,QAAQ,kDAAa;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,YAAY,kDAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B;;AAE/B;AACA,mBAAmB,uCAAuC;AAC1D,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,wCAAwC;AACjG;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA,YAAY,kDAAa,gCAAgC,sBAAsB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,wBAAwB;AACjF;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,6BAA6B;AACtF;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,uBAAuB;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,wBAAwB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,0BAA0B;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,yBAAyB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,8BAA8B;AACvF;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kDAAa,gCAAgC,2BAA2B;AACpF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;;AAEjC,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;AACjC,oBAAoB,kDAAa;;AAEjC;AACA;AACA;AACA;AACA;AACA,gCAAgC,kDAAa,gCAAgC,yBAAyB;AACtG;AACA;AACA,gCAAgC,kDAAa,gCAAgC,wBAAwB;AACrG;AACA;AACA,gCAAgC,kDAAa,gCAAgC,0BAA0B;AACvG;AACA;AACA,gCAAgC,kDAAa,gCAAgC,2BAA2B;AACxG;AACA;AACA,gCAAgC,kDAAa,gCAAgC,uCAAuC;AACpH;AACA;AACA,gCAAgC,kDAAa,gCAAgC,wCAAwC;AACrH;AACA;AACA,gCAAgC,kDAAa,gCAAgC,2CAA2C;AACxH;AACA;AACA,gCAAgC,kDAAa,gCAAgC,0CAA0C;AACvH;AACA;AACA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA,oBAAoB,kDAAa;AACjC;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kDAAa,gCAAgC,kBAAkB;AACnF;;AAEA;AACA;AACA;;AAEA,gCAAgC,wCAAwC;AACxE,sEAAsE,2CAA2C;AACjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,oBAAoB,kDAAa;AACjC,iBAAiB;AACjB,oBAAoB,kDAAa,gCAAgC,gBAAgB;AACjF;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kDAAa,gCAAgC,qBAAqB;AAClF,gBAAgB,kDAAa,gCAAgC,oBAAoB;AACjF,gBAAgB,kDAAa,gCAAgC,sBAAsB;AACnF,gBAAgB,kDAAa,gCAAgC,uBAAuB;AACpF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA,gBAAgB,kDAAa,uCAAuC,qBAAqB;AACzF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA,gBAAgB,kDAAa,uCAAuC,sBAAsB;AAC1F;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uBAAuB,uCAAuC;AAC9D;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA,gBAAgB,kDAAa,uCAAuC,uBAAuB;AAC3F;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY,kDAAa,gCAAgC,qBAAqB;AAC9E,YAAY,kDAAa,gCAAgC,oBAAoB;AAC7E,YAAY,kDAAa,gCAAgC,sBAAsB;AAC/E,YAAY,kDAAa,gCAAgC,uBAAuB;AAChF;AACA,gBAAgB,kDAAa,gCAAgC,0BAA0B;AACvF,gBAAgB,kDAAa,gCAAgC,2BAA2B;AACxF;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY,kDAAa,yCAAyC,uBAAuB;;AAEzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,gBAAgB,kDAAa,0CAA0C,sBAAsB;AAC7F;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA,gBAAgB,kDAAa,uCAAuC,sBAAsB;AAC1F;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,gBAAgB,kDAAa,6CAA6C,sBAAsB;AAChG,gBAAgB,kDAAa,8CAA8C,uBAAuB;AAClG;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA,mCAAmC,YAAY;AAC/C,wBAAwB,kDAAa,8BAA8B,sBAAsB,gBAAgB;AACzG,wBAAwB,kDAAa,8BAA8B,sBAAsB;AACzF,wBAAwB,kDAAa,8BAA8B,qBAAqB,gBAAgB;AACxG,wBAAwB,kDAAa,8BAA8B,qBAAqB;AACxF;AACA,mCAAmC,YAAY;AAC/C,wBAAwB,kDAAa,8BAA8B,oBAAoB;AACvF,wBAAwB,kDAAa,8BAA8B,oBAAoB;AACvF,wBAAwB,kDAAa,8BAA8B,uBAAuB;AAC1F,wBAAwB,kDAAa,8BAA8B,uBAAuB;AAC1F;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAa,0CAA0C,sBAAsB;AACrG;AACA,iBAAiB;AACjB;AACA,oBAAoB,kDAAa,yCAAyC,gFAAgF;AAC1J;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,oBAAoB,kDAAa,0CAA0C,+EAA+E;AAC1J;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,kDAAa;AACzB;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;;AAEvC;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,QAAQ,oDAAW;AACnB;AACA,KAAK;AACL;AACA;AACA,YAAY,oDAAW;AACvB;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,iFAAiF;AACjF;AACA;AACA;AACA;AACA,uBAAuB,uCAAuC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kDAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;;AAEA,SAAS,kDAAa,+CAA+C;AACrE;AACA;;AAEA,mDAAmD;AACnD;;AAEA;AACA,gCAAgC;AAChC;AACA;AACA,gCAAgC;AAChC;;AAEA,QAAQ,kDAAa;AACrB;AACA,oCAAoC;AACpC;AACA,KAAK,OAAO;AACZ,QAAQ,kDAAa,iCAAiC;AACtD;;AAEA;AACA;AACA;AACA,QAAQ,kDAAa;;AAErB;AACA,QAAQ,kDAAa;AACrB;;AAEA,sCAAsC;AACtC;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,kDAAa,iFAAiF;AACtG;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,IAAI,kDAAa;AACjB,IAAI,kDAAa;AACjB,IAAI,kDAAa;;AAEjB,IAAI,kDAAa;AACjB,IAAI,kDAAa;;AAEjB,IAAI,kDAAa;;;AAGjB,IAAI,kDAAa;AACjB,IAAI,kDAAa;AACjB,IAAI,kDAAa;AACjB;AACA,KAAK;;AAEL,IAAI,kDAAa;AACjB;AACA;AACA;AACA;AACA,IAAI,kDAAa;AACjB;AACA;AACA;AACA;AACA,IAAI,kDAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,kDAAa;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,kDAAa;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,kDAAa;AACjB;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI,kDAAa;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,IAAI,kDAAa;AACjB;;;AAGA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,6EAA6E;;AAEvH;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEe,gEAAC,8DAA8D;;;;;;;;;;;;;AC3yF9E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D;AACyC;AAC2C;AAC3C;AACI;AACZ;AACc;;AAE/C;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,wBAAwB;AACxB,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA,mDAAmD;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,mDAAmD;;AAEnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA,yBAAyB;;AAEzB,qBAAqB;AACrB;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,4BAA4B;AAC5B,4BAA4B;AAC5B;AACA,iBAAiB;AACjB;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,mCAAmC;AACzG;AACA,SAAS;AACT;AACA;AACA,0EAA0E,mCAAmC;AAC7G,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,kDAAa;;AAErB,sCAAsC;;AAEtC;AACA;AACA;AACA;AACA;AACA;;AAEA,wIAAwI;AACxI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,uBAAuB;AAClD;AACA;AACA;;;AAGA,qCAAqC,kDAAa;;AAElD;AACA,+DAA+D,kDAAa;AAC5E;;AAEA,iCAAiC;;AAEjC;AACA;AACA,QAAQ,kDAAa;;AAErB,QAAQ,kDAAa;;AAErB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B,kDAAa;AAC1C,uEAAuE,eAAe;AACtF;AACA,aAAa;AACb;;AAEA;AACA;AACA,YAAY,oDAAW;AACvB;;AAEA;AACA,iEAAiE;AACjE;;AAEA;AACA,iEAAiE;AACjE;;AAEA;AACA,QAAQ,uDAAY;;AAEpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D;AAC1D,qBAAqB;AACrB,0DAA0D;AAC1D;AACA;AACA;AACA,0DAA0D;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,+DAA+D;AAC/D,wBAAwB;AACxB,+DAA+D;AAC/D;AACA;AACA;AACA;;AAEA;AACA,YAAY,kDAAa;AACzB;;AAEA;;AAEA;AACA,QAAQ,0EAAgB;AACxB;AACA;AACA,gBAAgB,kDAAa;AAC7B;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,SAAS;;AAET,mDAAmD;AACnD;AACA,YAAY,kDAAa;AACzB;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD,SAAS;AACT,kCAAkC,kBAAkB;AACpD;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0CAA0C;AAC1C;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,kDAAa;AACxC;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,2DAA2D,+BAA+B;AAC1F;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,QAAQ,kDAAa;AACrB;AACA;AACA;AACA,kCAAkC,kBAAkB;AACpD,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAoC,kBAAkB;AACtD;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,kDAAa;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,kDAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,eAAe,kDAAa;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,eAAe,kDAAa;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,YAAY,kDAAa;AACzB,SAAS;AACT;AACA;AACA;AACA,YAAY,kDAAa;AACzB;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2DAA2D,iBAAiB;;AAE5E;AACA;AACA;;AAEe;AACf;AACA;AACA,CAAC,EAAC","file":"wptm.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","//alternate color handling functions\nimport tableFunction from \"./_functions\";\n\nconst alternating = {\n    /**\n     * Check that the selection matches the saved alternate values\n     *\n     * @param selection\n     * @param oldAlternate\n     * @returns {*}\n     */\n    setNumberAlternate : (selection, oldAlternate) => {\n        var count = _.size(oldAlternate);\n\n        window.jquery.each(oldAlternate, function (i, v) {\n            if (typeof v.selection !== 'undefined') {\n                if (v.selection[0] == selection[0] &&\n                    v.selection[1] == selection[1] &&\n                    v.selection[2] == selection[2] &&\n                    v.selection[3] == selection[3]) {\n                    count = i;\n                }\n            } else {\n                return count;\n            }\n        });\n\n        return count;\n    },\n    /**\n     * when select alternating_color\n     *\n     * @param value\n     * @param selection\n     * @param count\n     */\n    selectAlternatingColor : (value, selection, count) => {//when select alternating_color\n        //ij is row, ik is coll\n        var ij, ik;\n        var beforeChange = window.jquery.extend({}, window.Wptm.style.cells);\n        var size = _.size(window.table_function_data.checkChangeAlternate);\n        window.table_function_data.checkChangeAlternate[size] = {};\n\n        for (ij = selection[0]; ij <= selection[2]; ij++) {\n            for (ik = selection[1]; ik <= selection[3]; ik++) {\n                if (typeof (beforeChange[ij + \"!\" + ik]) !== 'undefined') {\n                    window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] = beforeChange[ij + \"!\" + ik][2].AlternateColor;\n                    beforeChange[ij + \"!\" + ik][2] = window.jquery.extend(beforeChange[ij + \"!\" + ik][2], {AlternateColor: count});\n                } else { //cell not have style\n                    beforeChange[ij + \"!\" + ik] = [ij, ik, {}];\n                    beforeChange[ij + \"!\" + ik][2] = {AlternateColor: count};\n                }\n                if (typeof window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] === 'undefined' || window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] === null) {\n                    window.table_function_data.checkChangeAlternate[size][ij + \"!\" + ik] = -1;\n                }\n            }\n        }\n\n        window.Wptm.style.cells = beforeChange;\n\n        var listChangeAlternate = [];\n        var i = count, oldCount = count;\n        window.table_function_data.changeAlternate = [];\n        for (var ii = count - 1; ii >= 0; ii--) {\n            var check = 1;\n            if (value[ii] !== false && typeof value[ii].selection !== 'undefined') {\n                if(value[ii].selection[0] >= value[i].selection[0]) {\n                    check++;\n                }\n\n                if(value[ii].selection[1] >= value[i].selection[1]) {\n                    check++;\n                }\n\n                if(value[ii].selection[2] <= value[i].selection[2]) {\n                    check++;\n                }\n\n                if(value[ii].selection[3] <= value[i].selection[3]) {\n                    check++;\n                }\n            } else {\n                check = 5;\n            }\n\n            if (check === 5) {\n                value[ii] = value[count];\n                listChangeAlternate[ii] = count;\n                if (typeof listChangeAlternate[count] !== 'undefined') {\n                    listChangeAlternate[ii] = listChangeAlternate[count];\n                    delete listChangeAlternate[count];\n                }\n                delete value[count];\n                count--;\n                i = ii;\n            }\n        }\n        for (var j = 0; j < oldCount; j ++) {\n            if (typeof listChangeAlternate[j] !== 'undefined') {\n                window.table_function_data.changeAlternate[listChangeAlternate[j]] = j;\n            }\n        }\n        window.table_function_data.alternateIndex = count;\n        window.table_function_data.alternateSelection = selection;\n    },\n    /**\n     * Cancel alternateColor\n     */\n    reAlternateColor : () => {\n        var styleCells = {};\n        styleCells = window.jquery.extend({}, Wptm.style.cells);\n\n        for (var i = _.size(window.table_function_data.checkChangeAlternate) - 1; i >= 0; i--) {\n            window.jquery.map(window.table_function_data.checkChangeAlternate[i], function (v, ii) {\n                if (typeof styleCells[ii] !== 'undefined') {\n                    if (v !== -1) {\n                        styleCells[ii][2].AlternateColor = v;\n                    } else {\n                        delete styleCells[ii][2].AlternateColor;\n                    }\n                }\n            });\n        }\n\n        window.table_function_data.checkChangeAlternate = [];\n        return styleCells;\n    },\n\n\n\n    /**\n     * Set alternate color by alternate_row_odd_color option(in params)\n     *\n     * @param styleRows style.rows\n     * @param Wptm\n     * @param $element\n     */\n    setAlternateColor : (styleRows, Wptm, $element) => {\n        Wptm.style.table.alternateColorValue = {};\n\n        if (typeof Wptm.container !== 'undefined') {\n            var countCols = Wptm.container.handsontable('countCols');\n            var countRows = Wptm.container.handsontable('countRows');\n        } else {/*get count cols, rows when handsontable not activated*/\n            countCols = Wptm.datas[0].length - 1;\n            countRows = Wptm.datas.length - 1;\n        }\n\n        var checkExistAlternateOld = 0;\n        var checkExistAlternateEven = 0;\n\n        if (tableFunction.checkObjPropertyNested(Wptm.style.table, 'alternate_row_odd_color') && Wptm.style.table.alternate_row_odd_color) {\n            checkExistAlternateOld = 1;\n            // Wptm.style.table.alternate_row_odd_color;\n        }\n        if (tableFunction.checkObjPropertyNested(Wptm.style.table, 'alternate_row_even_color') && Wptm.style.table.alternate_row_even_color) {\n            checkExistAlternateEven = 1;\n            // Wptm.style.table.alternate_row_even_color;\n        }\n\n        var header = '';\n        if (styleRows !== null && typeof styleRows[0][1].cell_background_color !== 'undefined') {\n            header = styleRows[0][1].cell_background_color;\n        }\n\n        if (checkExistAlternateEven + checkExistAlternateOld > 0) {\n            Wptm.style.table.alternateColorValue = {};\n            Wptm.style.table.alternateColorValue[0] = {};\n            Wptm.style.table.alternateColorValue[0].selection = [0, 0, countRows - 1, countCols - 1];\n            Wptm.style.table.alternateColorValue[0].footer = '';\n            Wptm.style.table.alternateColorValue[0].even = checkExistAlternateEven === 1 ? Wptm.style.table.alternate_row_even_color : '#ffffff';\n            Wptm.style.table.alternateColorValue[0].header = header;\n            Wptm.style.table.alternateColorValue[0].old = checkExistAlternateOld === 1 ? Wptm.style.table.alternate_row_odd_color : '#ffffff';\n            Wptm.style.table.alternateColorValue[0].default = '' + header + '|' + Wptm.style.table.alternateColorValue[0].even + '|' + Wptm.style.table.alternateColorValue[0].old + '|' + '';\n            saveData.push({action: 'style', selection: [[0, 0, countRows, countCols]], style: {AlternateColor: 0}});\n        }\n\n        Wptm.style.table.alternate_row_even_color = null;\n        Wptm.style.table.alternate_row_odd_color = null;\n\n        if (typeof Wptm.style.table.alternateColorValue[0] !== 'undefined') {\n            var ij, ik;\n            for (ij = 0; ij <= countRows; ij++) {\n                for (ik = 0; ik <= countCols; ik++) {\n                    if (typeof (Wptm.style.cells[ij + \"!\" + ik]) !== 'undefined') {\n                        Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor = 0;\n                    } else {\n                        Wptm.style.cells[ij + \"!\" + ik] = [ij, ik, {}];\n                        Wptm.style.cells[ij + \"!\" + ik][2] = jQuery.extend({}, {AlternateColor: 0});\n                    }\n                    if (header !== '' && ij === 0) {\n                        delete Wptm.style.cells[ij + \"!\" + ik][2].cell_background_color;\n                    }\n                }\n            }\n        }\n\n        window.Wptm = window.jquery.extend({}, Wptm);\n    },\n    /**\n     * add new alternate to saving function and Wptm.style.table\n     */\n    applyAlternate : function () { //save oldAlternate value to Wptm and save\n        window.Wptm.style.table.alternateColorValue = window.jquery.extend({}, window.table_function_data.oldAlternate);\n        window.Wptm.style.table.allAlternate = window.jquery.extend({}, window.table_function_data.allAlternate);\n\n        if(window.table_function_data.alternateIndex !== '') {\n            var i, k;\n            for (i = window.table_function_data.alternateSelection[0]; i <= window.table_function_data.alternateSelection[2]; i++) {\n                for (k = window.table_function_data.alternateSelection[1]; k <= window.table_function_data.alternateSelection[3]; k++) {\n                    if (typeof (window.Wptm.style.cells[i + \"!\" + k]) !== 'undefined') {\n                        window.Wptm.style.cells[i + \"!\" + k][2] = window.jquery.extend(window.Wptm.style.cells[i + \"!\" + k][2], {AlternateColor: window.table_function_data.alternateIndex});\n                    } else { //cell not have style\n                        window.Wptm.style.cells[i + \"!\" + k] = [i, k, {}];\n                        window.Wptm.style.cells[i + \"!\" + k][2] = {AlternateColor: window.table_function_data.alternateIndex};\n                    }\n                }\n            }\n\n            window.table_function_data.save_table_params.push({action: 'style', selection: [window.table_function_data.alternateSelection], style: {AlternateColor: window.table_function_data.alternateIndex}});\n        }\n        window.table_function_data.checkChangeAlternate = [];\n\n        tableFunction.saveChanges(true);\n        this.siblings('.colose_popup').trigger('click');\n    },\n    /**\n     * set the change options of altenate when selector cell/change rangeLabe\n     * @param Wptm\n     * @param $\n     */\n    affterRangeLabe : function (Wptm, $) {\n        try {\n            var rangeLabel = this.find('.cellRangeLabelAlternate').val();\n            rangeLabel = rangeLabel.replace(/[ ]+/g, \"\").toUpperCase();\n            var arrayRange = rangeLabel.split(\":\");\n            if (arrayRange.length > 1) {\n                var check_value = 0;\n                if (arrayRange[0].replace(/[ |A-Za-z]+/g, \"\") === '') {\n                    check_value = 1;//value A:B\n                } else if (arrayRange[0].replace(/[ |1-9]+/g, \"\") === '') {\n                    check_value = 2;//value 8:9\n                }\n                var selection = [];\n                if (check_value === 0) {\n                    selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[1]) - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n                    selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[1]) - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n                } else if (check_value === 1) {\n                    selection.push(0);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n                    selection.push(Wptm.max_row - 1);\n                    selection.push(tableFunction.convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n                } else {\n                    selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[0]) - 1);\n                    selection.push(0);\n                    selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[0]) - 1);\n                    selection.push(Wptm.max_Col - 1);\n                }\n\n                if (Wptm.type === 'mysql') {\n                    if (selection[2] + selection[0] === 0) {\n                        this.find('.wptm_range_labe_show').removeClass('wptm_hiden');\n                    } else {\n                        this.find('.wptm_range_labe_show').addClass('wptm_hiden');\n                    }\n                }\n                $(Wptm.container).handsontable(\"selectCell\", selection[0], selection[1], selection[2], selection[3]);\n\n                if (typeof this.find('.cellRangeLabelAlternate').data('text_change') !== 'undefined') {\n                    if (this.find('.cellRangeLabelAlternate').hasClass('select_row')) {\n                        if (selection[0] === selection[2]) {\n                            $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.rows_height);\n                        } else {\n                            $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.rows_height_start + (selection[0] + 1) + '-' + (selection[2] + 1));\n                        }\n                    } else if (this.find('.cellRangeLabelAlternate').hasClass('select_column')) {\n                        $(this.find('.cellRangeLabelAlternate').data('text_change')).text(wptmContext.columns_width_start\n                            + arrayRange[0].split(/[ |1-9]+/g)[0] + '-' + arrayRange[1].split(/[ |1-9]+/g)[0]);\n                    } else {\n                        $(this.find('.cellRangeLabelAlternate').data('text_change')).text(rangeLabel);\n                    }\n                }\n            }\n        } catch (err) {}\n    },\n    /**\n     * active alternating\n     *\n     * @param format\n     */\n    getActiveFormatColor: (format) => {\n        $alternating_color.find('.formatting_style .pane-color-tile').each(function () {\n            if (window.jquery(this).find('.pane-color-tile-1').data('value') === format.even) {\n                if (window.jquery(this).find('.pane-color-tile-2').data('value') === format.old) {\n                    var check = 0;\n                    if (format.header !== '') {\n                        check = format.header === window.jquery(this).find('.pane-color-tile-header').data('value') ? 1 : -1;\n                    } else {\n                        check = 1;\n                    }\n\n                    if (format.footer !== '') {\n                        check = format.footer === window.jquery(this).find('.pane-color-tile-footer').data('value') ? check : -1;\n                    }\n\n                    switch (check) {\n                        case 1:\n                            window.jquery(this).addClass('active');\n                            break;\n                        case -1:\n                            // No active\n                            break;\n                    }\n                }\n            }\n        });\n    },\n    /**\n     * handsontable render after set alternating\n     */\n    renderCell : () => { //render cells\n        window.jquery(window.Wptm.container).handsontable('render');\n    }\n}\n\nexport default alternating\n","import alternating from \"./_alternating\";\nimport tableFunction from \"./_functions\";\nimport selectOption from \"./_toolbarOptions\"\n\n//change default theme to table, get ajax\nfunction change_theme(ret, id, cellsData) {\n    var $ = window.jquery;\n    var $jform_css = $('#jform_css');\n    bootbox.confirm(wptmText.WARNING_CHANGE_THEME, wptmText.Cancel, wptmText.Ok, function (result) {\n        if (result) {\n            Wptm.container.handsontable(\"selectCell\", 0,0,0,0);\n\n            $.ajax({\n                url: wptm_ajaxurl + \"view=style&format=json&id=\" + id +\"&id-table=\" + Wptm.id,\n                type: 'POST',\n                dataType: 'json',\n                data: {}\n            }).done(function (data) {\n                if (typeof (data) === 'object') {\n                    saveData=[];\n                    Wptm.mergeCellsSetting = [];\n                    window.Wptm.style.table = {};\n\n                    //backup old style\n                    var oldStyle = JSON.parse(JSON.stringify(window.Wptm.style));\n                    delete window.Wptm.style;\n                    //Apply cols and row style to cells\n                    var style;\n                    window.Wptm.style = $.parseJSON(data.style);\n                    style = $.extend({}, {}, window.Wptm.style);\n                    window.Wptm.datas = data.datas;\n\n                    if($jform_css.next().hasClass('CodeMirror')) {\n                        $jform_css.next().remove();\n                    }\n\n                    window.Wptm.css = data.css.replace(/\\\\n/g, \"\\n\");\n                    // window.Wptm.css = data.css;\n                    $jform_css.val(window.Wptm.css);\n                    $jform_css.change();\n\n                    tableFunction.mergeCollsRowsstyleToCells();\n\n                    //re-apply responsive parameters\n                    if (typeof oldStyle.table.responsive_type !== \"undefined\") {\n                        window.Wptm.style.table.responsive_type = oldStyle.table.responsive_type;\n                    }\n\n                    // add default val to window.Wptm.style.table\n                    window.Wptm.style.table = $.extend({}, default_value, window.Wptm.style.table);\n\n                    var colIndex, col, row;\n                    for (col in style.cols) {\n                        colIndex = style.cols[col][0];\n                        if (typeof oldStyle.cols[colIndex] !== \"undefined\" && typeof oldStyle.cols[colIndex][1][\"res_priority\"] !== \"undefined\") {\n                            if (typeof window.Wptm.style.cols[colIndex] == \"undefined\") {\n                                window.Wptm.style.cols[colIndex] = [colIndex, {}];\n                            }\n                        }\n                    }\n\n                    //If no content we can set our own cols and rows size\n                    for (row in style.rows) {\n                        if (typeof (style.rows[row]) !== 'undefined' && (typeof (style.rows[row][1].height) !== 'undefined')) {\n                            if (typeof (window.Wptm.style.rows[style.rows[row][0]]) === 'undefined') {\n                                window.Wptm.style.rows[style.rows[row][0]] = [row, {}];\n                            }\n                            window.Wptm.style.rows[style.rows[row][0]][1].height = style.rows[row][1].height;\n                        }\n                    }\n\n                    for (col in style.cols) {\n                        if (typeof (style.cols[col]) !== 'undefined' && (typeof (style.cols[col][1].width) !== 'undefined')) {\n                            if (typeof (window.Wptm.style.cols[style.cols[col][0]]) === 'undefined') {\n                                window.Wptm.style.cols[style.cols[col][0]] = [col, {}];\n                            }\n                            window.Wptm.style.cols[style.cols[col][0]][1].width = style.cols[col][1].width;\n                        }\n                    }\n\n                    Wptm.updateSettings.mergeCells = $.extend([], Wptm.mergeCellsSetting);\n                    Wptm.updateSettings.data = $.extend([], data.datas);\n                    tableFunction.pullDims(Wptm, $, false);\n\n                    setTimeout(function () {\n                        saveData = [];\n\n                        Wptm.container.handsontable('updateSettings', Wptm.updateSettings);\n\n                        if (typeof (window.Wptm.style.table.alternateColorValue) === 'undefined' || typeof window.Wptm.style.table.alternateColorValue[0] === 'undefined') {\n                            alternating.setAlternateColor(Wptm.style.rows, window.Wptm, window.wptm_element);\n                        }\n\n                        window.table_function_data.oldAlternate = {};\n                        if (_.size(window.table_function_data.oldAlternate) < 1) {\n                            window.table_function_data.oldAlternate = $.extend({}, window.Wptm.style.table.alternateColorValue);\n                        }\n                        window.table_function_data.checkChangeAlternate = [];\n\n                        if (typeof data.update_type_columns !== 'undefined') {\n                            saveData.push({\n                                action: 'set_columns_types',\n                                value: data.update_type_columns\n                            });\n                            Wptm.style.table.col_types = data.update_type_columns;\n\n                            Wptm.headerOption = 1;\n                            Wptm.hyperlink = typeof Wptm.style.table.hyperlink !== 'undefined' ? Wptm.style.table.hyperlink : {};\n                            Wptm.mergeCellsSetting = typeof Wptm.style.table.mergeCellsSetting !== 'undefined' ? Wptm.style.table.mergeCellsSetting : [];\n                        }\n                        table_function_data.changeTheme = true;\n                        window.jquery(window.Wptm.container).handsontable('render');\n\n                        tableFunction.cleanHandsontable();\n                        tableFunction.saveChanges(true);\n                        setTimeout(function () {\n                            Wptm.updateSettings = $.extend({}, {});\n                        },500);\n                    },300);\n                    tableFunction.parseCss($);\n\n                    if (table_function_data.selectionSize > 0) { //when have select cell\n                        selectOption.loadSelection($, Wptm, table_function_data.selection);\n                    }\n                } else {\n                    bootbox.alert(data, wptmText.Ok);\n                }\n                $('#wptm_popup').find('.colose_popup').trigger('click');\n            });\n        } else {\n            $('#wptm_popup').find('.colose_popup').trigger('click');\n        }\n    });\n}\n\nexport default change_theme\n","import tableFunction from \"./_functions\";\nimport alternating from \"./_alternating\";\nimport customRenderer from \"./_customRenderer\";\n\n/* Chart functions */\nvar DropChart = {};\nDropChart.default = {\n    \"dataUsing\": \"row\",\n    \"switchDataUsing\": true,\n    \"useFirstRowAsLabels\": true,\n    \"useFirstRowAsGraph\": true,\n    \"width\": 500,\n    \"height\": 375,\n    \"chart_align\": \"center\",\n    \"scaleShowGridLines\": false,\n    \"scaleBeginAtZero\": false,\n};\nDropChart.default.colors = \"#DCDCDC,#97BBCD,#4C839E\";\nDropChart.default.pieColors = \"#F7464A,#46BFBD,#FDB45C,#949FB1,#4D5360\";\nDropChart.datas = {};\n\nDropChart.currency_symbol = window.default_value.currency_symbol;\nDropChart.thousand_symbol = window.default_value.thousand_symbol;\nDropChart.decimal_symbol = window.default_value.decimal_symbol;\n\nDropChart.functions = {};\n\n//get list chart of table\nDropChart.functions.loadCharts = function () {\n    var $ = jquery;\n\n    if (typeof idTable !== 'undefined' && idTable !== '') {\n        var url = wptm_ajaxurl + \"view=charts&format=json&id_table=\" + idTable;\n        $.ajax({\n            url: url,\n            type: \"POST\",\n            data: {},\n            dataType: \"json\",\n        }).done(function (data) {\n            var i = 0;\n            for (i = 0; i < data.length; i++) {\n                var cells = $.parseJSON(data[i].datas);\n                if ($.isArray(cells) !== false || cells.length !== 0) {\n                    DropChart.datas[data[i].id] = {\n                        author: data[i].author,\n                        config: $.parseJSON(data[i].config),\n                        data: cells,\n                        title: data[i].title,\n                        type: data[i].type,\n                    };\n                    $('#list_chart').append('<li class=\"chart-menu\" data-id=\"' + data[i].id + '\"><a>' + data[i].title + '</a></li>');\n                }\n            }\n            wptm_chart();\n        });\n    }\n}\n\nfunction wptm_chart(first_load) {\n    var $ = jquery;\n    var $wptm_top_chart = $('#wptm_chart').find('.wptm_left_content .wptm_top_chart');\n    $('#list_chart').find('.chart-menu').unbind('click').on('click', function (e) {\n        var chart_name = '';\n        if (!$(this).data('id')) {\n            $(this).closest('.chart-menu').siblings('.chart-menu').removeClass('active');\n            var chart_id = $(this).closest('.chart-menu').data('id');\n            $(this).closest('.chart-menu').addClass('active');\n            chart_name = $(this).text();\n        } else {\n            $(this).siblings('.chart-menu').removeClass('active');\n            var chart_id = $(this).data('id');\n            $(this).addClass('active');\n            chart_name = $(this).find('a').text();\n        }\n        $wptm_top_chart.find('.wptm_name_edit').text(chart_name);\n\n        if ($('#inserttable').length > 0) {\n            Wptm.chart_active = chart_id;\n            if (!$('#inserttable').hasClass('not_change_type')) {\n                jquery('#inserttable').data('type', 'chart').attr('data-type', 'chart').text(insert_chart);\n            }\n            $('#inserttable').removeClass(\"no_click\");\n        }\n\n        if(first_load) {\n            DropChart.functions.render(chart_id, false, first_load);\n        } else {\n            DropChart.functions.render(chart_id);\n        }\n        return false;\n    });\n\n    if (typeof Wptm.chart_active !== 'undefined' && parseInt(Wptm.chart_active) > 0) {\n        if ($('.over_popup').length > 0) {\n            $('.over_popup').hide();\n        }\n        tableFunction.showChartOrTable(true, $('#list_chart').find('.chart-menu[data-id=\"' + Wptm.chart_active + '\"]'));\n    }\n\n    $wptm_top_chart.find('.edit').unbind('click').on('click', function (e) {\n        $wptm_top_chart.find('.wptm_name_edit').addClass('rename');\n        $wptm_top_chart.find('.wptm_name_edit').trigger('click');\n    });\n\n    $wptm_top_chart.find('.wptm_name_edit').click(function () {\n        if (!$(this).hasClass('editable')) {\n            tableFunction.setText.call(\n                $(this),\n                $wptm_top_chart.find('.wptm_name_edit'),\n                '#wptm_chart .wptm_name_edit',\n                {\n                    'url': wptm_ajaxurl + \"task=chart.setTitle&id=\" + DropChart.id_chart + '&title=',\n                    'selected': true,\n                    'action': function (obj) {\n                        if (arguments[0] != '') {\n                            $('#list_chart').find('.chart-menu.active a').text(arguments[0]);\n                        }\n                    }\n                }\n            );\n        }\n    });\n\n    $wptm_top_chart.find('.trash').unbind('click').on('click', function (e) {\n        var that = this;\n        var list_chart = $('#list_chart');\n\n        bootbox.confirm(wptmText.JS_WANT_DELETE + \"\\\"\" + $(this).siblings('.wptm_name_edit').text().trim() + '\"?', wptmText.Cancel, wptmText.Ok, function (result) {\n            if (result === true) {\n                $.ajax({\n                    url: wptm_ajaxurl + \"task=chart.delete&id=\" + DropChart.id_chart,\n                    type: \"POST\",\n                    data: {},\n                    dataType: \"json\",\n                    success: function (datas) {\n                        if (datas.response === true) {\n                            list_chart.find('li.chart-menu[data-id=\"' + DropChart.id_chart + '\"]').remove();\n                            wptm_element.wptmContentChart.find('canvas.wptm_chart_' + DropChart.id_chart).remove();\n                            if (list_chart.find('li.chart-menu').length > 1) {\n                                list_chart.find('.chart-menu').eq(0).trigger('click');\n                            } else {\n                                list_chart.find('.current_table').trigger('click');\n                            }\n                        } else {\n                            bootbox.alert(datas.response, wptmText.Ok);\n                        }\n                    },\n                    error: function (jqxhr, textStatus, error) {\n                        bootbox.alert(textStatus, wptmText.Ok);\n                    }\n                });\n                return false;\n            }\n        });\n    });\n    wptm_element.chartTabContent.find('.copy_shortcode').unbind('click').on('click', function (e) {\n        wptm_element.chartTabContent.find('.controls[name=\"shortcode\"] input').select();\n        document.execCommand('copy');\n    });\n    Wptm.dataChart = $.extend([], DropChart.datas);\n}\n\nfunction updateOption(chartData) {\n    var $ = jquery;\n    //get cell range label to input selected range and add range to handsontable\n    var selection = DropChart.helper.getCellRangeLabel(DropChart.cells);\n    var cellRangeLabel = Handsontable.helper.spreadsheetColumnLabel(selection[1]) + '' + (selection[0] + 1);\n    cellRangeLabel += \":\" + Handsontable.helper.spreadsheetColumnLabel(selection[3]) + '' + (selection[2] + 1);\n    wptm_element.chartTabContent.find('.cellRangeLabelAlternate').val(cellRangeLabel);\n    Wptm.container.handsontable(\"selectCell\", selection[0], selection[1], selection[2], selection[3]);\n\n    if (typeof chartData.type !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"type\"]').find('img').each(function () {\n            $(this).removeClass('active');\n            if ($(this).attr('alt') === chartData.type) {\n                $(this).addClass('active');\n            }\n        });\n\n        var $dataset_select = wptm_element.chartTabContent.find('.controls[name=\"dataset_select\"] select');\n        var $dataset_color = wptm_element.chartTabContent.find('.controls[name=\"dataset_color\"] input.minicolors');\n        $dataset_select.html(\"\");\n        if (DropChart.type == \"Line\" || DropChart.type == \"Bar\" || DropChart.type == \"Radar\") {\n            for (var i = 0; i < DropChart.datasets.length; i++) {\n                $dataset_select.append('<option value=\"' + i + '\">' + DropChart.datasets[i].label + '</option>');\n            }\n            $dataset_select.trigger('liszt:updated');\n            $dataset_color.wpColorPicker('color', DropChart.config.colors.split(\",\")[0]);\n        } else {\n            var chartData = {};\n            chartData.datasets = DropChart.datasets;\n            chartData.labels = DropChart.labels;\n\n            for (var i = 0; i < chartData.labels.length; i++) {\n                $dataset_select.append('<option value=\"' + i + '\">' + chartData.labels[i] + '</option>');\n            }\n            $dataset_select.trigger('liszt:updated');\n            $dataset_color.wpColorPicker('color', DropChart.config.pieColors.split(\",\")[0]);\n        }\n    }\n\n    if (typeof DropChart.id_chart !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"shortcode\"] input').val('[wptm id-chart=' + DropChart.id_chart + ']');\n    }\n    if (typeof DropChart.config.dataUsing !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"dataUsing\"] select').val(DropChart.config.dataUsing).change();\n    }\n    if (typeof DropChart.config.useFirstRowAsLabels !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"useFirstRowAsLabels\"] input')\n            .val(DropChart.config.useFirstRowAsLabels === true ? 'yes' : 'no').prop(\"checked\", DropChart.config.useFirstRowAsLabels);\n    }\n    if (typeof DropChart.config.useFirstRowAsGraph !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"useFirstRowAsGraph\"] input')\n            .val(DropChart.config.useFirstRowAsGraph === true ? 'yes' : 'no').prop(\"checked\", DropChart.config.useFirstRowAsGraph);\n    }\n    if (typeof DropChart.config.width !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"width\"] input').val(DropChart.config.width).change();\n    }\n    if (typeof DropChart.config.height !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"height\"] input').val(DropChart.config.height).change();\n    }\n    if (typeof DropChart.config.chart_align !== 'undefined') {\n        wptm_element.chartTabContent.find('.controls[name=\"chart_align\"] select').val(DropChart.config.chart_align).change();\n        wptm_element.wptmContentChart.css('text-align', DropChart.config.chart_align);\n    }\n    DropChart.optionsChanged = true;\n}\n\n//action option changing\nfunction initChartObserver() {\n    if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n        return false;\n    }\n    var $ = jquery;\n\n    $('#wptm_chart .option_chart').unbind('change').on('change', function (e) {\n        if (DropChart.optionsChanged !== true) {\n            return;\n        }\n        var dropChart = DropChart.datas[DropChart.id_chart];\n\n        switch ($(this).parents('.controls').attr('name')) {\n            case 'Shortcode':\n                break;\n            case 'dataUsing':\n                dropChart.config.dataUsing = $(this).val();\n                // var dataSets = DropChart.functions.getDataSets(DropChart.cells, dropChart.config.dataUsing);\n                // DropChart.datasets = addChartStyles(dataSets[0], dropChart.config.colors);  // dataSets[0];\n                // if (dropChart.config.useFirstRowAsLabels) {\n                //     DropChart.labels = dataSets[1];\n                // } else {\n                //     DropChart.labels = DropChart.helper.getEmptyArray(dataSets[1].length);\n                // }\n                DropChart.functions.render(DropChart.id_chart, false, true);\n                break;\n            case 'useFirstRowAsLabels':\n                if ($(this).is(\":checked\")) {\n                    dropChart.config.useFirstRowAsLabels = true;\n                } else {\n                    dropChart.config.useFirstRowAsLabels = false;\n                }\n                DropChart.functions.render(DropChart.id_chart, false, true);\n                break;\n            case 'useFirstRowAsGraph':\n                if ($(this).is(\":checked\")) {\n                    dropChart.config.useFirstRowAsGraph = true;\n                } else {\n                    dropChart.config.useFirstRowAsGraph = false;\n                }\n                DropChart.functions.render(DropChart.id_chart, false, true);\n                break;\n            case 'width':\n                dropChart.config.width = parseInt($(this).val());\n                DropChart.functions.render(DropChart.id_chart, true, true);\n                break;\n            case 'height':\n                dropChart.config.height = parseInt($(this).val());\n                DropChart.functions.render(DropChart.id_chart, true, true);\n                break;\n            case 'chart_align':\n                dropChart.config.chart_align = $(this).val();\n                if (dropChart.config.chart_align !== 'none') {\n                    wptm_element.wptmContentChart.css('text-align', dropChart.config.chart_align);\n                } else {\n                    wptm_element.wptmContentChart.css('text-align', 'left');\n                }\n                break;\n            case 'dataset_select':\n                var index = parseInt($(this).val());\n                var $dataset_color = wptm_element.chartTabContent.find('.controls[name=\"dataset_color\"] input.minicolors');\n                dropChart.change_dataset_select = true;\n                if (DropChart.type == \"Line\" || DropChart.type == \"Bar\" || DropChart.type == \"Radar\") {\n                    if (dropChart.config.colors.split(\",\").length > index) {\n                        $dataset_color.wpColorPicker('color', dropChart.config.colors.split(\",\")[index]);\n                    } else {\n                        $dataset_color.wpColorPicker('color', \"\");\n                    }\n                } else {\n                    if (dropChart.config.pieColors.split(\",\").length > index) {\n                        $dataset_color.wpColorPicker('color', dropChart.config.pieColors.split(\",\")[index]);\n                    } else {\n                        $dataset_color.wpColorPicker('color', \"\");\n                    }\n                }\n                break;\n            case 'dataset_color':\n                var index = parseInt(wptm_element.chartTabContent.find('.controls[name=\"dataset_select\"] select').val());\n                if (DropChart.type == \"Line\" || DropChart.type == \"Bar\" || DropChart.type == \"Radar\") {\n                    var colors = dropChart.config.colors.split(\",\");\n                    colors[index] = $(this).val();\n                    dropChart.config.colors = colors.join(\",\");\n                    // var dataSets = DropChart.functions.getDataSets(DropChart.cells, dropChart.config.dataUsing);\n                    // if (typeof DropChart.config.useFirstRowAsGraph !== 'undefined' && DropChart.config.useFirstRowAsGraph !== true) {//remove first row/column\n                    //     dataSets[0].shift();\n                    // }\n                    // DropChart.datasets = addChartStyles(dataSets[0], dropChart.config.colors);\n                } else {\n                    var pieColors = dropChart.config.pieColors.split(\",\");\n                    if (pieColors.length <= index) {\n                        var maxLabels = DropChart.labels.length;\n                        var maxPieColors = pieColors.length;\n                        var i;\n                        for (i = 0; i < maxLabels; i++) {\n                            pieColors[i] = pieColors[i % maxPieColors];\n                        }\n                    }\n                    pieColors[index] = $(this).val();\n                    dropChart.config.pieColors = pieColors.join(\",\");\n                }\n                if (dropChart.change_dataset_select === true) {\n                    dropChart.change_dataset_select = false;\n                } else {\n                    DropChart.functions.render(DropChart.id_chart, true, true);\n                }\n                break;\n            default:\n                break;\n        }\n    });\n\n    $('#wptm_chart .option_chart').unbind('click').on('click', function (e) {\n        if (DropChart.optionsChanged !== true) {\n            return;\n        }\n        var dropChart = DropChart.datas[DropChart.id_chart];\n\n        switch ($(this).parents('.controls').attr('name')) {\n            case 'type':\n                changeStyleChart($(this).data('id'));\n                break;\n            case 'changerChart':\n                alternating.affterRangeLabe.call(wptm_element.chartTabContent, window.Wptm, window.jquery);\n                changerRangeChart();\n                break;\n            default:\n                break;\n        }\n    });\n}\n\nfunction changeStyleChart(charttype_id) {\n    var $ = jquery;\n    var id_chart = DropChart.id_chart;\n    $.ajax({\n        url: wptm_ajaxurl + \"view=charttype&format=json&id=\" + charttype_id,\n        type: 'POST',\n        data: {}\n    }).done(function (data) {\n        if (typeof (data) === 'object') {\n            //local save\n            if (data.config !== '') {\n                $.extend(DropChart.datas[id_chart].config, $.parseJSON(data.config));\n            }\n            DropChart.datas[id_chart].type = data.name;\n\n            DropChart.functions.render(id_chart, false, true);\n        }\n    });\n}\n\nfunction changerRangeChart() {\n    var $ = jquery;\n    var id_chart = DropChart.id_chart;\n    var dataChart = DropChart.datas[id_chart];\n\n    var dataCell = DropChart.functions.validateChartData();\n    if (dataCell === false) {\n        bootbox.alert(wptmText.CHART_INVALID_DATA, wptmText.GOT_IT);\n    } else {\n        dataChart.data = dataCell;\n        DropChart.changer = true;\n        DropChart.functions.render(id_chart, false, true);\n    }\n}\n\nfunction convertForPie(dataSets, useFirstRowAsLabels, colors, dataUsing) {\n    var result = {};\n    result.datasets = [];\n\n    if (typeof dataSets.data === 'undefined' || dataSets.data.length < 1) {\n        return false;\n    }\n\n    var numberLine, countDatasets, dataSet, pieColors;\n\n    numberLine = dataSets.data.length;\n    countDatasets = dataSets.data[0].length;\n    for (var i = 0; i < numberLine; i++) {\n        dataSet = jquery.extend({}, {});\n        dataSet.label = dataSets.graphLabel[i];\n        dataSet.currency_symbol = dataSets.currency_symbol[i];\n        if (typeof dataSets.data2 !== 'undefined' && typeof dataSets.data2[i] !== 'undefined') {\n            dataSet.data_format = dataSets.data2[i];\n        } else {\n            dataSet.data_format = dataSets.data[i];\n        }\n        result.labels = jquery.extend([], []);\n        pieColors = jquery.extend({}, {});\n\n        if (dataUsing === 'pieColors') {\n            dataSet.highlight = [];\n            dataSet.backgroundColor = [];\n            dataSet.borderColor = [];\n            dataSet.pointBackgroundColor = [];\n            dataSet.pointColor = [];\n            dataSet.pointBorderColor = [];\n            dataSet.pointHighlightFill = [];\n        }\n\n        for (var j = 0; j < countDatasets; j++) {\n            if (!(typeof dataSets.deleteData !== 'undefined'\n                && ((typeof dataSets.arrayShiftData !== 'undefined' && typeof dataSets.deleteData[j + 1] !== 'undefined' && dataSets.deleteData[j + 1] !== 0)\n                    || (typeof dataSets.arrayShiftData !== 'undefined' && typeof dataSets.deleteData[j] !== 'undefined' && dataSets.deleteData[j] !== 0))\n            )\n            ) {//thoa man\n                if (typeof dataSet.data === 'undefined') {\n                    dataSet.data = [];\n                }\n                dataSet.data.push(dataSets.data[i][j]);//data da duoc remove tu truoc\n\n                if (useFirstRowAsLabels) {\n                    result.labels.push(dataSets.axisLabels[j]);\n                } else {\n                    result.labels.push('');\n                }\n\n                if (dataUsing === 'pieColors') {\n                    pieColors = getStyleSet(j, colors);\n                    dataSet.highlight.push(pieColors.highlight);\n                    dataSet.backgroundColor.push(pieColors.backgroundColor);\n                    dataSet.borderColor.push(pieColors.borderColor);\n                    dataSet.pointBackgroundColor.push(pieColors.pointBackgroundColor);\n                    dataSet.pointColor.push(pieColors.pointColor);\n                    dataSet.pointBorderColor.push(pieColors.pointBorderColor);\n                    dataSet.pointHighlightFill.push(pieColors.pointHighlightFill);\n                }\n            }\n        }\n        if (dataUsing !== 'pieColors') {\n            pieColors = getStyleSet(i, colors);\n            dataSet = jquery.extend({}, dataSet, pieColors);\n        }\n        result.datasets[i] = dataSet;\n    }\n\n    return result;\n}\n\nfunction getStyleSet(i, colors) {\n    var styleSet = {};\n\n    var color = getColor(i, colors);\n    if (color != \"\") {\n        styleSet.highlight = DropChart.helper.ColorLuminance(color, 0.3);\n        styleSet.backgroundColor = DropChart.helper.convertHex(color, 20);\n        styleSet.borderColor = DropChart.helper.convertHex(color, 50);\n        styleSet.pointBackgroundColor = DropChart.helper.convertHex(color, 100);\n        styleSet.pointColor = \"#fff\";\n        styleSet.pointHighlightFill = \"#fff\";\n        styleSet.pointBorderColor = DropChart.helper.convertHex(color, 100);\n    }\n\n    return styleSet;\n}\n\nfunction getColor(i, colors) {\n    var result = \"\";\n    var arrColors = colors.split(\",\");\n    var len = arrColors.length;\n    if (len > 0) {\n        result = arrColors[i % len];\n    }\n\n    return result;\n}\n\nfunction addChartStyles(dataSets, colors) {\n    var result = [];\n    var dataset, styleSet;\n\n    for (var i = 0; i < dataSets.length; i++) {\n        dataset = dataSets[i];\n        styleSet = getStyleSet(i, colors);\n        jquery.extend(dataset, styleSet);\n        result.push(dataset);\n    }\n\n    return result;\n}\n\nDropChart.functions.addChart = function () {\n    if ((typeof idTable !== 'undefined' && idTable !== '') || table_function_data.selectionSize < 2) {\n        var $ = jquery;\n        var selection = DropChart.functions.validateChartData();\n\n        if (selection === false) {\n            bootbox.alert(wptmText.CHART_INVALID_DATA + '<img src=\"' + wptm_admin_asset + '/images/Create-chart.gif\" style=\"width: 100%;margin-top: 20px\"/>', wptmText.GOT_IT);\n            return;\n        }\n\n        $.ajax({\n            url: wptm_ajaxurl + \"task=chart.add&id_table=\" + idTable,\n            type: \"POST\",\n            dataType: \"json\",\n            data: {datas: JSON.stringify(selection)},\n            beforeSend: function () {\n                wptm_element.settingTable.find('.ajax_loading').addClass('loadding').removeClass('wptm_hiden');\n                wptm_element.primary_toolbars.find('.new_chart_menu').closest('li').addClass('menu_loading');\n            },\n            success: function (datas) {\n                wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n                if (datas.response === true) {\n                    var count = $('#list_chart').find('li.chart-menu').length;\n                    var data_chart = datas.datas;\n                    $('#list_chart').append('<li class=\"chart-menu\" data-id=\"' + data_chart.id + '\"><a>' + data_chart.title + '</a></li>');\n                    DropChart.datas[data_chart.id] = {\n                        config: DropChart.default,\n                        data: $.parseJSON(data_chart.datas),\n                        title: data_chart.title,\n                        type: \"Line\",\n                    };\n                    wptm_chart(true);\n                    tableFunction.showChartOrTable(true, $('#list_chart').find('.chart-menu').eq(count));\n                } else {\n                    bootbox.alert(datas.response, wptmText.Ok);\n                }\n            },\n            error: function (jqxhr, textStatus, error) {\n                wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n                bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n            }\n        });\n    } else {\n        bootbox.alert(wptmText.CHART_INVALID_DATA, wptmText.GOT_IT);\n    }\n}\n\nDropChart.functions.render = function (chart_id, re_render, save_chart) {\n    var $ = jquery;\n    DropChart.id_chart = chart_id;\n    var datas = DropChart.datas[chart_id];\n    DropChart.cells = datas.data;\n    DropChart.type = datas.type;\n\n    try {\n        DropChart.config = $.extend({}, DropChart.default, datas.config);\n    } catch (e) {\n        DropChart.config = $.extend({}, DropChart.default, $.parseJSON(datas.config));\n    }\n\n    if (datas.config === null) {\n        datas.config = $.extend({}, DropChart.default);\n    }\n\n    //destroy old chart version\n    if (DropChart.chart) {\n        DropChart.chart.clear();\n        DropChart.chart.destroy();\n    }\n\n    var chartData = {};\n\n    var dataSets = DropChart.functions.getDataSets2(DropChart.cells, DropChart.config.dataUsing);\n\n    var change_dataUsing = false;\n    if (typeof dataSets.data === 'undefined' || dataSets.data.length < 1) {\n        if (DropChart.config.dataUsing === 'column') {\n            DropChart.config.dataUsing = 'row';\n            datas.config.dataUsing = 'row';\n        } else {\n            DropChart.config.dataUsing = 'column';\n            datas.config.dataUsing = 'column';\n        }\n\n        dataSets = DropChart.functions.getDataSets2(DropChart.cells, DropChart.config.dataUsing);\n\n        // chartData.datasets = addChartStyles(dataSets[0], DropChart.config.colors);\n        change_dataUsing = true;\n    }\n\n    var chartData;\n    switch (DropChart.type) {\n        case 'PolarArea':\n        case 'Pie':\n        case 'Doughnut':\n            chartData = convertForPie(dataSets, DropChart.config.useFirstRowAsLabels, DropChart.config.pieColors, 'pieColors');\n            break;\n        case 'Bar':\n        case 'Radar':\n        case 'Line':\n        default:\n            chartData = convertForPie(dataSets, DropChart.config.useFirstRowAsLabels, DropChart.config.colors, 'colors');\n            break;\n    }\n    if (change_dataUsing) {\n        wptm_element.chartTabContent.find('.controls[name=\"dataUsing\"] span.wptm_notice').show();\n        setTimeout(function () {\n            wptm_element.chartTabContent.find('.controls[name=\"dataUsing\"] span.wptm_notice').hide();\n        }, 2000);\n    }\n\n    //hiden all canvas except chart_id\n    wptm_element.wptmContentChart.find('.canvas').addClass('wptm_hiden');\n    var $canvas = wptm_element.wptmContentChart.find('canvas.wptm_chart_' + chart_id);\n    if ($canvas.length < 1 || re_render) {\n        $canvas.remove();\n        $canvas = $('<canvas class=\"canvas wptm_chart_' + chart_id + '\" width=\"' + DropChart.config.width + '\" height=\"' + DropChart.config.height + '\"   ><canvas>')\n            .appendTo(wptm_element.wptmContentChart);\n    } else {\n        $canvas.width(DropChart.config.width);\n        $canvas.height(DropChart.config.height);\n    }\n    $canvas.removeClass('wptm_hiden');\n    var ctx = $canvas.get(0).getContext(\"2d\");\n\n    DropChart.labels = chartData.labels;\n    DropChart.datasets = chartData.datasets;\n    if (DropChart.datasets.length > 0) {\n        DropChart.config.tooltips = {\n            enabled: true, mode: 'single', callbacks: {\n                label: function (tooltipItems, data) {\n                    var label = '';\n\n                    if (data.useFirstRowAsLabels) {\n                        if (data.datasets.length > 1) {\n                            label = data.datasets[tooltipItems.datasetIndex].label || '';\n                        } else if (tooltipItems.label === '') {\n                            label = data.labels[tooltipItems.index] || '';\n                        }\n\n                        if (label) {\n                            label += ': ';\n                        }\n                    }\n\n                    // var dataCell = data.datasets[tooltipItems.datasetIndex].data[tooltipItems.index];\n                    // if (data.datasets[tooltipItems.datasetIndex].currency_symbol === 1) {\n                    //     label += tableFunction.formatSymbols(dataCell, Wptm.style.table.decimal_count, Wptm.style.table.thousand_symbol, Wptm.style.table.decimal_symbol, Wptm.style.table.symbol_position, Wptm.style.table.currency_symbol);\n                    // } else {\n                    //     label += tableFunction.formatSymbols(dataCell, Wptm.style.table.decimal_count, Wptm.style.table.thousand_symbol, Wptm.style.table.decimal_symbol, Wptm.style.table.symbol_position, '');\n                    // }\n                    if (typeof data.datasets[tooltipItems.datasetIndex].data_format[tooltipItems.index] !== 'undefined') {\n                        label += data.datasets[tooltipItems.datasetIndex].data_format[tooltipItems.index];\n                    } else {\n                        label += data.datasets[tooltipItems.datasetIndex].data[tooltipItems.index];\n                    }\n                    return label;\n                }\n            }\n        };\n    } else {\n        bootbox.alert(wptmText.CHART_INVALID_DATA, wptmText.GOT_IT);\n    }\n    try {\n        chartData.useFirstRowAsLabels = DropChart.config.useFirstRowAsLabels;\n        DropChart.config.scaleBeginAtZero = false;//fix the original value of the shaft\n        DropChart.config.responsive = false;//fix the original value of the shaft\n        switch (DropChart.type) {\n            case 'PolarArea':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'polarArea',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n\n            case 'Pie':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'pie',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n\n            case 'Doughnut':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'doughnut',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n\n            case 'Bar':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'bar',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n\n            case 'Radar':\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'radar',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n\n            case 'Line':\n            default:\n                DropChart.chart = new wptmChart(ctx, {\n                    type: 'line',\n                    data: chartData,\n                    options: DropChart.config\n                });\n                break;\n        }\n\n        DropChart.optionsChanged = false;\n        //update val of selector to chart option\n        if (!re_render) {\n            updateOption(datas);\n        } else {\n            DropChart.optionsChanged = true;\n        }\n        initChartObserver();\n        if (save_chart) {\n            DropChart.functions.save();\n        }\n    } catch (e) {}\n}\n\nDropChart.functions.save = function () {\n    if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n        return;\n    }\n\n    var $ = jQuery;\n    var jsonVar = {\n        jform: {\n            type: DropChart.type,\n            config: JSON.stringify(DropChart.config)\n        },\n        id: DropChart.id_chart\n    };\n\n    if (DropChart.changer === true) {\n        jsonVar.jform.datas = JSON.stringify(DropChart.cells);\n        DropChart.changer = false;\n    }\n    var $saving = $('.wptm_top_chart .saving');\n    $saving.html(wptmText.SAVING);\n    $saving.animate({'opacity': '1'}, 200);\n    $.ajax({\n        url: wptm_ajaxurl + \"task=chart.save\",\n        dataType: \"json\",\n        type: \"POST\",\n        data: jsonVar,\n        success: function (datas) {\n            if (datas.response === true) {\n                $saving.html(wptmText.ALL_CHANGES_SAVED).delay(500).animate({'opacity': '0'}, 200);\n            } else {\n                $saving.animate({'opacity': '0'}, 200);\n                bootbox.alert(datas.response, wptmText.Ok);\n            }\n        },\n        error: function (jqxhr, textStatus, error) {\n            $saving.animate({'opacity': '0'}, 200);\n            bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n        }\n    });\n}\n\nDropChart.functions.getDataSets = function (cells, dataUsing) {\n    DropChart.currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    DropChart.thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n    DropChart.decimal_symbol = typeof Wptm.style.table.decimal_symbol === 'undefined'\n        ? default_value.decimal_symbol\n        : Wptm.style.table.decimal_symbol;\n\n    var result = {};\n    var axisLabels = [];\n    var deleteLine = [];\n\n    if (!dataUsing) {\n        dataUsing = \"row\";\n    }\n    var cellsData = DropChart.helper.getRangeData(cells);\n\n    if (cellsData.length === 0) {\n        return false;\n    }\n    if (dataUsing !== \"row\") {//default get cell data by row then need to change\n        cellsData = DropChart.helper.transposeArr(cellsData);\n    }\n\n    result.deleteData = [];\n    result.data = [];\n    result.graphLabel = [];\n    result.axisLabels = [];\n    result.currency_symbol = [];\n\n    var checkCellsHaveNaN, countCellInLine, cellsData1, deleteData1, currency_symbol, lineData, getStrangeCharacters, j;\n    for (var i = 0; i < cellsData.length; i++) {\n        checkCellsHaveNaN = 0;\n        countCellInLine = cellsData[i].length;\n        cellsData1 = jquery.extend([], []);\n        deleteData1 = jquery.extend([], []);\n        currency_symbol = 0;\n\n        lineData = jquery.extend([], cellsData[i]);\n        // lineData.shift();\n        for (var ii = 0; ii < countCellInLine; ii++) {\n            getStrangeCharacters = DropChart.helper.getStrangeCharacters(cellsData[i][ii]);\n            checkCellsHaveNaN += getStrangeCharacters['NaN'];\n            cellsData1[ii] = getStrangeCharacters['value'];\n\n            if (getStrangeCharacters['delete'] === 1) {\n                deleteData1[ii] = 1;\n            }\n\n            if (typeof getStrangeCharacters['currency_symbol'] !== 'undefined' && getStrangeCharacters['currency_symbol'] === 1) {\n                currency_symbol++;\n            }\n        }\n\n        if (checkCellsHaveNaN === countCellInLine || (countCellInLine > 2 && checkCellsHaveNaN + 2 > countCellInLine)) {//line Have NaN\n            axisLabels.push(cellsData[i]);\n            deleteLine.push(i);\n        } else {//get this line, that have cell value\n            for (j in deleteData1) {\n                if (typeof result.deleteData[j] === 'undefined') {\n                    result.deleteData[j] = 0;\n                }\n                result.deleteData[j] += 1;\n            }\n            result.data.push(cellsData1);//array key 1, 2, 3,...|| in $cellsData1, may contain non-validated cells\n            result.graphLabel.push(cellsData[i][0]);//array key 1, 2, 3,...||$value[0] first value\n\n            if (currency_symbol > 1) {\n                result.currency_symbol.push(1);\n            } else {\n                result.currency_symbol.push(-1);\n            }\n        }\n    }\n\n    var numberLine = result.data.length;\n    if (numberLine > 0) {\n        var useFirstRowAsGraph = typeof DropChart.config.useFirstRowAsGraph !== 'undefined' ? DropChart.config.useFirstRowAsGraph : true;\n        //if line number > 1 then not get cell is graphLabel else < 1 then get it\n        if (numberLine > 1 && cellsData.length > 1 && !(cellsData.length === 2 && useFirstRowAsGraph !== true)) {//have > 1 line in chart\n            for (var i2 = 0; i2 < numberLine; i2++) {\n                result.data[i2].shift();\n            }\n            result.arrayShiftData = true;\n\n            if (typeof result.deleteData[0] !== 'undefined' && result.deleteData[j] !== 0) {\n                result.deleteData[0] = 0;\n            }\n        }\n\n        if (axisLabels.length > 0) {//useFirstRowAsGraph become useless\n            result.axisLabels = axisLabels[0];\n        } else {\n            if (numberLine > 0) {//axisLabels from $cellsData[0] || all line be passed validated\n                result.axisLabels = cellsData[0];\n                if (useFirstRowAsGraph !== true) {\n                    result.data.shift();\n                    result.currency_symbol.shift();\n                    result.graphLabel.shift();\n                }\n            }\n        }\n\n        if (typeof result.arrayShiftData !== 'undefined') {\n            result.axisLabels.shift();\n        }\n\n        for (var j2 in result.deleteData) {//not deleted yet cells not pass\n            if (numberLine !== result.deleteData[j2]) {\n                result.deleteData[j2] = 0;\n            }\n        }\n\n        for (var i3 = 0; i3 < result.data.length; i3++) {\n            result.data[i3] = DropChart.helper.convertToNumber(result.data[i3]);\n        }\n    }\n\n    return result;\n}\n\nDropChart.functions.getDataSets2 = function (cells, dataUsing) {\n    DropChart.currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    DropChart.thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n    DropChart.decimal_symbol = typeof Wptm.style.table.decimal_symbol === 'undefined'\n        ? default_value.decimal_symbol\n        : Wptm.style.table.decimal_symbol;\n\n\n    var result = {};\n    var axisLabels = [];\n    var deleteLine = [];\n\n    if (!dataUsing) {\n        dataUsing = \"row\";\n    }\n\n    result.deleteData = [];\n    result.data = [];\n    result.data2 = [];\n    result.data_raw = [];\n    result.data_raw1 = [];\n    result.graphLabel = [];\n    result.axisLabels = [];\n    result.currency_symbol = [];\n\n    if (dataUsing !== \"row\") {//default get cell data by row then need to change\n        cells = DropChart.helper.transposeArr(cells);\n    }\n\n    var cell_value, j, checkCellsHaveNaN, countCellInLine, cellsData1, cellsData2, deleteData1, currency_symbol, lineData, getStrangeCharacters;\n    for (var i = 0; i < cells.length; i++) {\n        checkCellsHaveNaN = 0;\n        countCellInLine = cells[i].length;\n        cellsData2 = jquery.extend([], []);\n        cellsData1 = jquery.extend([], []);\n        result.data_raw[i] = jquery.extend([], []);\n        result.data_raw1[i] = jquery.extend([], []);\n        deleteData1 = jquery.extend([], []);\n        currency_symbol = 0;\n        lineData = jquery.extend([], cells[i]);\n\n        for (var ii = 0; ii < countCellInLine; ii++) {\n            j =  cells[i][ii];\n            j = j.split(\":\");\n            cell_value = typeof Wptm.datas[parseInt(j[0])][parseInt(j[1])] !== 'undefined' && Wptm.datas[parseInt(j[0])][parseInt(j[1])] !== null ? Wptm.datas[parseInt(j[0])][parseInt(j[1])] : '';\n            cell_value = customRenderer.render(false, false, parseInt(j[0]), parseInt(j[1]), false, cell_value, 'cellProperties', true);\n            result.data_raw[i].push(cell_value[0]);\n            result.data_raw1[i].push(cell_value[1]);\n            cell_value = DropChart.helper.getStrangeCharacters2(cell_value, typeof cell_value[1] !== 'undefined');\n            //[0] value format, [1] float value, [2] Nan, [3] currency_symbol\n            checkCellsHaveNaN += cell_value[2];\n            cellsData2[ii] = cell_value[0];\n            cellsData1[ii] = cell_value[1];\n\n            if (cell_value[2] === 1) {\n                deleteData1[ii] = 1;\n            }\n\n            if (typeof cell_value[3] !== 'undefined' && cell_value[3] === 1) {\n                currency_symbol++;\n            }\n        }\n\n        if (checkCellsHaveNaN === countCellInLine || (countCellInLine > 2 && checkCellsHaveNaN + 2 > countCellInLine)) {//line Have NaN\n            axisLabels.push(cellsData2);\n            deleteLine.push(i);\n        } else {//get this line, that have cell value\n            for (j in deleteData1) {\n                if (typeof result.deleteData[j] === 'undefined') {\n                    result.deleteData[j] = 0;\n                }\n                result.deleteData[j] += 1;\n            }\n            result.data.push(cellsData1);//array key 1, 2, 3,...|| in $cellsData1, may contain non-validated cells\n            result.data2.push(cellsData2);//array key 1, 2, 3,...|| in $cellsData1, may contain non-validated cells\n            result.graphLabel.push(cellsData2[0]);//array key 1, 2, 3,...||$value[0] first value\n\n            if (currency_symbol > 1) {\n                result.currency_symbol.push(1);\n            } else {\n                result.currency_symbol.push(-1);\n            }\n        }\n    }\n\n    var numberLine = result.data.length;\n    if (numberLine > 0) {\n        var useFirstRowAsGraph = typeof DropChart.config.useFirstRowAsGraph !== 'undefined' ? DropChart.config.useFirstRowAsGraph : true;\n        //if line number > 1 then not get cell is graphLabel else < 1 then get it\n        if (numberLine > 1 && result.data_raw.length > 1 && !(result.data_raw.length === 2 && useFirstRowAsGraph !== true)) {//have > 1 line in chart\n            for (var i2 = 0; i2 < numberLine; i2++) {\n                result.data[i2].shift();\n                result.data2[i2].shift();\n            }\n            result.arrayShiftData = true;\n\n            if (typeof result.deleteData[0] !== 'undefined' && result.deleteData[j] !== 0) {\n                result.deleteData[0] = 0;\n            }\n        }\n\n        if (axisLabels.length > 0) {//useFirstRowAsGraph become useless\n            result.axisLabels = axisLabels[0];\n        } else {\n            if (numberLine > 0) {//axisLabels from $result.data_raw[0] || all line be passed validated\n                result.axisLabels = result.data_raw[0];\n                if (useFirstRowAsGraph !== true) {\n                    result.data.shift();\n                    result.data2.shift();\n                    result.currency_symbol.shift();\n                    result.graphLabel.shift();\n                }\n            }\n        }\n\n        if (typeof result.arrayShiftData !== 'undefined') {\n            result.axisLabels.shift();\n        }\n\n        for (var j2 in result.deleteData) {//not deleted yet cells not pass\n            if (numberLine !== result.deleteData[j2]) {\n                result.deleteData[j2] = 0;\n            }\n        }\n    }\n\n    return result;\n}\n\n//get valid chart data area\n// return: valid data , col indexes, row indexes\nDropChart.functions.getValidChartData = function (cellsData) {\n    var i, tempIndexes;\n    var results = [];\n    var resultIndexes = [];\n    var rowIndexes = [];\n    for (i = 0; i < cellsData[0].length; i++) {\n        resultIndexes.push(i);\n    }\n\n    for (i = 0; i < cellsData.length; i++) {\n        if (DropChart.helper.isValidRow(cellsData[i])) {\n            results.push(cellsData[i]);\n            rowIndexes.push(i);\n            tempIndexes = DropChart.helper.getValidIndexes(cellsData[i]);\n            resultIndexes = DropChart.helper.intersection(tempIndexes, resultIndexes);\n        }\n    }\n    var tempArr = [];\n\n    for (i = 0; i < results.length; i++) {\n        tempArr = [];\n        for (var j = 0; j < tempIndexes.length; j++) {\n            tempArr.push(results[i][tempIndexes[j]]);\n        }\n        results[i] = tempArr;\n    }\n    return [results, resultIndexes, rowIndexes];\n}\n\nDropChart.functions.checkValidRowData = function (array) {\n    return !array.some(function (value, index, array) {\n        return value !== array[0];\n    });\n}\n\nDropChart.functions.validateChartData = function () {\n    var selection = table_function_data.selection[0], rValid, cValid, emptyRow;\n    //no cell selected or only one cell\n    if (selection.length == 0 || selection[0] == selection[2] || selection[1] == selection[3]) {\n        return false;\n    }\n\n    var cellRange = new Array();\n    var Cells = Wptm.container.handsontable('getData', selection[0], selection[1], selection[2], selection[3]);\n    //Check row\n    rValid = DropChart.helper.hasNumbericRow(Cells);\n    var rCells;\n    if (!rValid) {\n        //check column\n        rCells = DropChart.helper.transposeArr(Cells);\n        cValid = DropChart.helper.hasNumbericRow(rCells);\n\n        if (!cValid) { //ignore first row and column\n            cValid = DropChart.helper.hasNumbericRowCol(rCells[0]);\n            if (!cValid) {\n                cValid = DropChart.helper.hasNumbericRowCol(rCells[1]);\n            }\n            var subCells = DropChart.helper.removeFirstRowColumn(rCells);\n            if (subCells.length <= 0) return false;\n        }\n    }\n\n    if (rValid || cValid) {\n        //read data\n        for (var r = 0; r < Cells.length; r++) {\n            if (!DropChart.functions.checkValidRowData(Cells[r])) {\n                cellRange[r] = new Array();\n                for (var c = 0; c < Cells[r].length; c++) {\n                    cellRange[r][c] = (selection[0] + r) + \":\" + (selection[1] + c);\n                }\n            }\n        }\n        var newCellRange = cellRange.filter(function (el) {\n            return el != null && el !== '';\n        });\n        return newCellRange;\n    } else {\n        return false;\n    }\n}\n\n//check val of cells to chart of table\nDropChart.functions.validateCharts = function (change) {\n    var result = true;\n    var $ = jQuery;\n    var editCell = change[0] + \":\" + change[1];\n\n    $.each(DropChart.datas, function (chart_id, chart) {\n        if (chart_id) {\n            var cells = chart.data;\n            if (DropChart.helper.inArrays(editCell, cells)) {\n                var cellsData = [];\n                for (var i = 0; i < cells.length; i++) {\n                    var rowData = [];\n                    for (var j = 0; j < cells[i].length; j++) {\n                        if (cells[i][j] != editCell) {\n                            rowData[j] = tableFunction.getCellData(cells[i][j]);\n                        } else {\n                            rowData[j] = change[3];//new value\n                        }\n                    }\n                    cellsData[i] = rowData;\n                }\n\n                if (!validateDataForChart(cellsData)) {\n                    result = false;\n                }\n            }\n        }\n    });\n\n    return result;\n}\n\nfunction validateDataForChart(Cells) {\n    var rValid, rCells, cValid, subCells, rsubCells;\n    //Check row\n    rValid = DropChart.helper.hasNumbericRow(Cells);\n    if (!rValid) {\n        //check column\n        rCells = DropChart.helper.transposeArr(Cells);\n        cValid = DropChart.helper.hasNumbericRow(rCells);\n        if (!cValid) { //ignore first row and column\n\n            subCells = DropChart.helper.removeFirstRowColumn(rCells);\n            if (subCells.length <= 0) return false;\n\n            rValid = DropChart.helper.hasNumbericRow(subCells);\n            if (!rValid) {\n                rsubCells = DropChart.helper.transposeArr(subCells);\n                cValid = DropChart.helper.hasNumbericRow(rsubCells);\n            }\n        }\n    }\n\n    return (rValid || cValid);\n}\n\nDropChart.helper = {}\n\nDropChart.helper.getStrangeCharacters2 = function (value) {\n    var value1, value0;\n    value0 = typeof value[1] !== 'undefined' ? value[1].toString().replaceAll(' ', '') : value[0].replaceAll(' ', '');\n    value1 = value0.replace(DropChart.currency_symbol, '');\n    value1 = value1.replace(DropChart.thousand_symbol, '');\n    value1 = value1.replace(DropChart.decimal_symbol, '.');\n    value[1] = value1.replace(/[^0-9|\\\\.|-]/g, '');//value\n\n    value[2] = 0;//nan\n    value[3] = 0;//currency_symbol\n    value1 = value1.replace(/[0-9|\\\\.|,|-| ]/g, '');\n\n    if (value1 !== '' || value[0] === '') {//have strange characters or is null\n        value[2] = 1;\n    }\n    if (value[0] !== '' && (value[0].includes(DropChart.currency_symbol) || arguments[1] === true)) {\n        value[3] = 1;\n    }\n\n    return value;\n}\n\nDropChart.helper.getStrangeCharacters = function (value) {\n    var data = [], value1;\n    value1 = value.replace(DropChart.currency_symbol, '');\n    value1 = value1.replace(DropChart.thousand_symbol, '.');\n    value1 = value1.replace(DropChart.decimal_symbol, '');\n    data['value'] = value1.replace(/[^0-9|\\\\.|-]/g, '');\n    data['NaN'] = 0;\n    data['delete'] = 0;\n    value1 = value1.replace(/[0-9|\\\\.|,|-| ]/g, '');\n    if (value1 !== '' || value === '') {//have strange characters or is null\n        data['NaN'] = 1;\n        data['delete'] = 1;\n    }\n    if (data['value'] !== '' && value !== '' && value.includes(DropChart.currency_symbol)) {\n        data['currency_symbol'] = 1;\n    }\n\n    return data;\n}\n\n//get index of valid number in the array\nDropChart.helper.getValidIndexes = function (arr) {\n    var currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    var thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n\n    // var thousand_re = new RegExp(thousand_symbol,\"g\");\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    var i, v, x1;\n    var result = [];\n\n    for (i = 0; i < arr.length; i++) {\n\n        v = arr[i] ? arr[i].toString() : \"\";\n        x1 = v.replace(currency_symbol, '');\n        x1 = x1.replace(thousand_re, '');\n        x1 = x1.replace(/[\\\\.|+|,| ]/g, '');\n        x1 = x1.replace(/-/g, '');\n        x1 = x1.replace(/[0-9]/g, '');\n        if (x1 === '') {\n            result.push(i);\n        }\n    }\n    return result;\n}\n\n//get intersection values of two array\nDropChart.helper.intersection = function (a, b) {\n    var rs = [];\n    for (var i = 0; i < a.length; i++) {\n        if (b.indexOf(a[i]) != -1) {\n            rs.push(a[i]);\n        }\n    }\n    return rs;\n};\n\n\nDropChart.helper.isNumbericArray = function (arr) {\n    var valid = true;\n    for (var c = 0; c < arr.length; c++) {\n        if (isNaN(arr[c])) {\n            valid = false;\n        }\n    }\n\n    return valid;\n};\n\nDropChart.helper.convertToNumber = function (arr) {\n    var result = [];\n    for (var c = 0; c < arr.length; c++) {\n        // if (!isNaN(arr[c])) {\n        if (typeof arr[c] === 'string') {\n            arr[c] = tableFunction.stringReplace(arr[c], false);\n        }\n        result.push(arr[c]);\n        // }\n    }\n    return result;\n};\n\nDropChart.helper.transposeArr = function (arr) {\n    if (typeof arr === \"undefined\" || arr.length === 0) {\n        return [];\n    }\n    return Object.keys(arr[0]).map(function (c) {\n        return arr.map(function (r) {\n            return r[c];\n        });\n    });\n}\nDropChart.helper.inArrays = function (c, cells) {\n    var result = false;\n    for (var r = 0; r < cells.length; r++) {\n        if (cells[r].indexOf(c) > -1) {\n            result = true;\n        }\n    }\n\n    return result;\n}\n\n\n// there is at least 2 number\nDropChart.helper.isValidRow = function (arr) {\n    var currency_symbol = typeof Wptm.style.table.currency_symbol === 'undefined'\n        ? default_value.currency_symbol\n        : Wptm.style.table.currency_symbol;\n    var thousand_symbol = typeof Wptm.style.table.thousand_symbol === 'undefined'\n        ? default_value.thousand_symbol\n        : Wptm.style.table.thousand_symbol;\n\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    var i, v, x1, count = 0;\n\n    for (i = 0; i < arr.length; i++) {\n        v = arr[i] ? arr[i].toString() : \"\";\n        if (v !== '') {\n            x1 = v.replace(currency_symbol, '');\n            x1 = x1.replace(thousand_re, '');\n            x1 = x1.replace(/[\\\\.|+|,| ]/g, '');\n            x1 = x1.replace(/-/g, '');\n            x1 = x1.replace(/[0-9]/g, '');\n            if (x1 === '') {\n                count++;\n            }\n        }\n    }\n    return (count > 1);\n}\n\nDropChart.helper.hasNumbericRow = function (Cells) {\n    var rValid = false;\n    if (typeof Cells === \"undefined\") {\n        return false;\n    }\n\n    for (var r = 0; r < Cells.length; r++) {\n        if (DropChart.helper.isValidRow(Cells[r])) {\n            rValid = true;\n            break;\n        }\n    }\n    return rValid;\n}\n\n// check val int cel in row\nDropChart.helper.hasNumbericRowCol = function (Cells) {\n    var rValid = true;\n    var rNaN = 0;\n    if (typeof Cells === \"undefined\") {\n        return false;\n    }\n    for (var r = 0; r < Cells.length; r++) {\n        var valid = true;\n        if (typeof (Cells[r]) === 'string' && isNaN(parseInt(tableFunction.stringReplace(Cells[r], false)))) {\n            valid = false;\n        }\n\n        if (!valid) {\n            rNaN++;\n        }\n    }\n\n    if (rNaN === Cells.length) {\n        rValid = false;\n    }\n    return rValid;\n}\n\nDropChart.helper.getRowData = function (row) {\n    var data = [];\n    for (var j = 0; j < row.length; j++) {\n        data[j] = tableFunction.getCellData(row[j]);\n    }\n\n    return data;\n}\n\nDropChart.helper.getRangeData = function (cells) {\n    var datas = [];\n    for (var i = 0; i < cells.length; i++) {\n        datas[i] = DropChart.helper.getRowData(cells[i]);\n    }\n\n    return datas;\n}\n\nDropChart.helper.getCellRangeLabel = function (cells) {\n    var data = [];\n    var firstCell = cells[0][0];\n    var lastRow = cells[cells.length - 1];\n    var lastCell = lastRow[lastRow.length - 1];\n\n    var pos = firstCell.split(\":\");\n    data[0] = parseInt(pos[0]);\n    data[1] = parseInt(pos[1]);\n\n    pos = lastCell.split(\":\");\n    data[2] = parseInt(pos[0]);\n    data[3] = parseInt(pos[1]);\n    return data;\n}\n\nDropChart.helper.canSwitchRowCol = function (cellsData) {\n    var result = -1;\n    var rValid = false;\n    var cValid = false;\n    if (DropChart.helper.hasNumbericRow(cellsData)) {\n        rValid = true;\n    }\n    var rCellsData = DropChart.helper.transposeArr(cellsData);\n    if (DropChart.helper.hasNumbericRow(rCellsData)) {\n        cValid = true;\n    }\n\n    if (rValid && cValid) {\n        result = 3;\n    } else if (rValid) {\n        result = 2;\n    } else if (cValid) {\n        result = 1;\n    } else {\n        // invalid data\n        result = -1;\n    }\n\n    return result;\n}\n\nDropChart.helper.removeFirstRowColumn = function (cells) {\n    cells.shift();\n    if (cells.length > 0) {\n        cells = DropChart.helper.transposeArr(cells);\n        cells.shift();\n    }\n\n    return cells;\n}\nDropChart.helper.getEmptyArray = function (len) {\n    var result = [];\n    for (var i = 0; i < len; i++) {\n        result[i] = \"    \";\n    }\n    return result;\n}\n\nDropChart.helper.convertHex = function (hex, opacity) {\n    hex = hex.replace('#', '');\n    var r = parseInt(hex.substring(0, 2), 16);\n    var g = parseInt(hex.substring(2, 4), 16);\n    var b = parseInt(hex.substring(4, 6), 16);\n\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + opacity / 100 + ')';\n}\n\nDropChart.helper.ColorLuminance = function (hex, lum) {\n\n    // validate hex string\n    hex = String(hex).replace(/[^0-9a-f]/gi, '');\n    if (hex.length < 6) {\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n    lum = lum || 0;\n\n    // convert to decimal and change luminosity\n    var rgb = \"#\", c, i;\n    for (i = 0; i < 3; i++) {\n        c = parseInt(hex.substr(i * 2, 2), 16);\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n        rgb += (\"00\" + c).substr(c.length);\n    }\n\n    return rgb;\n}\n\nexport default DropChart\n","import tableFunction from \"./_functions\";\n\n/*month text and aug calculator cell*/\nvar F_name = [\"january\", \"february\", \"march\", \"april\", \"may\", \"june\", \"july\", \"august\", \"september\", \"october\", \"november\", \"december\"];\nvar M_name = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sept\", \"oct\", \"nov\", \"dec\"];\nvar l_name = [\"sunday\", \"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\"];\nvar D_name = [\"sun\", \"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\"];\nvar regex2 = new RegExp('([a-zA-Z]+)([0-9]+)');\nvar regex3 = new RegExp('([a-zA-Z]+)([0-9]+)', 'g');\n/* List of supported formulas */\nvar regex = new RegExp('^=(DATE|DAY|DAYS|DAYS360|AND|OR|XOR|SUM|MULTIPLY|DIVIDE|COUNT|MIN|MAX|AVG|CONCAT|date|day|days|days360|and|or|xor|sum|multiply|divide|count|min|max|avg|concat)\\\\((.*?)\\\\)$');\nvar not_replace = ['DATE','DAY','DAYS','DAYS360','CONCAT'];\nvar Not_range_function = ['DATE','DAY','DAYS','DAYS360'];\n\nvar merge_style_val_cell = function (style_cols, style_rows, Wptm, row, col) {\n    var cellStyle = [];\n\n    if (tableFunction.checkObjPropertyNestedNotEmpty(style_cols, col, 1)) {\n        cellStyle[2] = jquery.extend([], style_cols[col][1]);\n    }\n    if (tableFunction.checkObjPropertyNestedNotEmpty(style_rows, row, 1)) {\n        cellStyle[2] = jquery.extend([], cellStyle[2], style_rows[row][1]);\n    }\n\n    if (tableFunction.checkObjPropertyNested(Wptm.style,'cells', row + \"!\" + col, 2)) {\n        if (Wptm.type === 'html' || row == 0) {\n            cellStyle[2] = jquery.extend({}, cellStyle[2],  Wptm.style.cells[row + \"!\" + col][2]);\n        }\n    }\n    return cellStyle;\n}\n\n/**\n * function render cell when handsontable render, call in handsontable.renderer\n *\n * @param instance\n * @param td             cell element\n * @param row            now number\n * @param col            col number\n * @param prop\n * @param value          cell value\n * @param cellProperties\n * @returns {*}\n */\nvar render = function (instance, td, row, col, prop, value, cellProperties) {\n    var onl_value_cell = false;\n    if (typeof Array.prototype.slice.call(arguments, 6)[1] !== \"undefined\") {\n        // onl_value_cell = true;\n        onl_value_cell = Array.prototype.slice.call(arguments, 6)[1];\n    }\n\n    var Wptm = window.Wptm;\n    var function_data = window.table_function_data;\n    var css = {};\n    var celltype = '', tooltip_content = false;\n    var first_cell_merged = false;\n\n    if (typeof (Wptm.style.cells) !== 'undefined') {\n        //Cells rendering\n        var cellStyle = [];\n\n        if (tableFunction.checkObjPropertyNestedNotEmpty( Wptm.style.cols, col, 1)) {\n            cellStyle[2] = jquery.extend([], Wptm.style.cols[col][1]);\n        }\n        if (tableFunction.checkObjPropertyNestedNotEmpty( Wptm.style.rows, row, 1)) {\n            cellStyle[2] = jquery.extend([], cellStyle[2], Wptm.style.rows[row][1]);\n        }\n\n        if (tableFunction.checkObjPropertyNested(Wptm.style,'cells', row + \"!\" + col, 2)) {\n            if (Wptm.type === 'html' || row == 0) {\n                cellStyle[2] = jquery.extend({}, cellStyle[2],  Wptm.style.cells[row + \"!\" + col][2]);\n            }\n        }\n\n        if (!onl_value_cell) {\n            if (typeof (cellStyle[2]) !== 'undefined') {\n                if (typeof cellStyle[2].AlternateColor !== 'undefined' || typeof function_data.allAlternate.default !== 'undefined') {\n                    var numberRow = 0;\n                    css[\"background-color\"] = '';\n                    if (typeof function_data.allAlternate.default !== 'undefined') {\n                        if (function_data.allAlternate.header === '') {\n                            numberRow = -1;\n                        }\n                        switch (row) {\n                            case 0:\n                                if (function_data.allAlternate.header === '') {\n                                    css[\"background-color\"] = function_data.allAlternate.even;\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.header;\n                                }\n                                break;\n                            case _.size(Wptm.style.rows) - 1:\n                                if (function_data.allAlternate.footer === '') {\n                                    if ((row - parseInt(0 + numberRow)) % 2) {\n                                        css[\"background-color\"] = function_data.allAlternate.even;\n                                    } else {\n                                        css[\"background-color\"] = function_data.allAlternate.old;\n                                    }\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.footer;\n                                }\n                                break;\n                            default:\n                                if ((row - parseInt(0 + numberRow)) % 2) {\n                                    css[\"background-color\"] = function_data.allAlternate.even;\n                                } else {\n                                    css[\"background-color\"] = function_data.allAlternate.old;\n                                }\n                                break;\n                        }\n                    } else {\n                        var value_cell_alternateColor = function_data.oldAlternate[cellStyle[2].AlternateColor];\n                        if (typeof value_cell_alternateColor === 'undefined') {\n                            if (typeof function_data.changeAlternate[cellStyle[2].AlternateColor] !== 'undefined' || function_data.changeAlternate.length < 1) {\n                                cellStyle[2].AlternateColor = function_data.changeAlternate[cellStyle[2].AlternateColor];\n                                value_cell_alternateColor = function_data.oldAlternate[cellStyle[2].AlternateColor];\n                            }\n                        }\n\n                        if (typeof value_cell_alternateColor !== 'undefined' && value_cell_alternateColor !== false && typeof value_cell_alternateColor.selection !== 'undefined') {\n                            if (value_cell_alternateColor.header === '') {\n                                numberRow = -1;\n                            }\n                            switch (row) {\n                                case parseInt(value_cell_alternateColor.selection[0]):\n                                    if (value_cell_alternateColor.header === '') {\n                                        css[\"background-color\"] = value_cell_alternateColor.even;\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.header;\n                                    }\n                                    break;\n                                case parseInt(value_cell_alternateColor.selection[2]):\n                                    if (value_cell_alternateColor.footer === '') {\n                                        if ((row - parseInt(value_cell_alternateColor.selection[0] + numberRow)) % 2) {\n                                            css[\"background-color\"] = value_cell_alternateColor.even;\n                                        } else {\n                                            css[\"background-color\"] = value_cell_alternateColor.old;\n                                        }\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.footer;\n                                    }\n                                    break;\n                                default:\n                                    if ((row - parseInt(value_cell_alternateColor.selection[0] + numberRow)) % 2) {\n                                        css[\"background-color\"] = value_cell_alternateColor.even;\n                                    } else {\n                                        css[\"background-color\"] = value_cell_alternateColor.old;\n                                    }\n                                    break;\n                            }\n                        } else {\n                            delete cellStyle[2].AlternateColor;\n                            if (typeof Wptm.style.cells[row + \"!\" + col][2] !== 'undefined' && typeof Wptm.style.cells[row + \"!\" + col][2].AlternateColor !== 'undefined') {\n                                delete Wptm.style.cells[row + \"!\" + col][2].AlternateColor;\n                            }\n                        }\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_type')) {\n                    celltype = cellStyle[2].cell_type;\n                } else if (typeof cellStyle[2].cell_type !== 'undefined') {\n                    delete cellStyle[2].cell_type;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_background_color')) {\n                    css[\"background-color\"] = cellStyle[2].cell_background_color;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_top')) {\n                    css[\"border-top\"] = cellStyle[2].cell_border_top;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_top_start')) {\n                    if (0 == row) {\n                        css[\"border-top\"] = cellStyle[2].cell_border_top_start;\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_right')) {\n                    css[\"border-right\"] = cellStyle[2].cell_border_right;\n                }\n\n                //check merge cell and border right\n                if (typeof table_function_data.start_merge_cell_col !== 'undefined' && typeof table_function_data.start_merge_cell_col[col] !== 'undefined') {\n                    window.jquery.each(table_function_data.start_merge_cell_col[col], function (index, value) {\n                        if (typeof value !== 'undefined') {\n                            var start_merge_cell_col = Wptm.mergeCellsSetting[value];\n                            if (start_merge_cell_col.rowspan + start_merge_cell_col.row > row && row >= start_merge_cell_col.row) {\n                                var end_style = merge_style_val_cell(Wptm.style.cols, Wptm.style.rows, Wptm, row, start_merge_cell_col.col + start_merge_cell_col.colspan - 1);\n                                // console.log(start_merge_cell_col, col, row);\n                                first_cell_merged = true;\n                                if (tableFunction.checkObjPropertyNestedNotEmpty(end_style, 2, 'cell_border_right')) {\n                                    css[\"border-right\"] = end_style[2].cell_border_right;\n                                }\n                            }\n                        }\n                    });\n                }\n\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_bottom')) {\n                    css[\"border-bottom\"] = cellStyle[2].cell_border_bottom;\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_bottom_end')) {\n                    if (_.size(Wptm.style.rows) - 1 == row) {\n                        css[\"border-bottom\"] = cellStyle[2].cell_border_bottom_end;\n                    }\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'cell_border_left')) {\n                    css[\"border-left\"] = cellStyle[2].cell_border_left;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_bold') && cellStyle[2].cell_font_bold === true) {\n                    css[\"font-weight\"] = \"bold\";\n                } else {\n                    delete css[\"font-weight\"];\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_italic') && cellStyle[2].cell_font_italic === true) {\n                    css[\"font-style\"] = \"italic\";\n                } else {\n                    delete css[\"font-style\"];\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_underline') && cellStyle[2].cell_font_underline === true) {\n                    css[\"text-decoration\"] = \"underline\";\n                } else {\n                    delete css[\"text-decoration\"];\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_text_align')) {\n                    css[\"text-align\"] = cellStyle[2].cell_text_align;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_vertical_align')) {\n                    css[\"vertical-align\"] = cellStyle[2].cell_vertical_align;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_family')) {\n                    css[\"font-family\"] = cellStyle[2].cell_font_family;\n                    //get list custom fonts used\n                    if (typeof wptm_listFont !== 'undefined' && wptm_listFont.length > 0\n                        && wptm_listFont.includes(cellStyle[2].cell_font_family)\n                        && !Wptm.style.table.fonts_used.includes(cellStyle[2].cell_font_family)) {\n                        Wptm.style.table.fonts_used.push(cellStyle[2].cell_font_family);\n                    }\n                    if (typeof wptm_listsLocalFont !== 'undefined' && wptm_listsLocalFont.length > 0\n                        && wptm_listsLocalFont.includes(cellStyle[2].cell_font_family)\n                        && !Wptm.style.table.fonts_local_used.includes(cellStyle[2].cell_font_family)) {\n                        Wptm.style.table.fonts_local_used.push(cellStyle[2].cell_font_family);\n                    }\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_size')) {\n                    css[\"font-size\"] = cellStyle[2].cell_font_size + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_font_color')) {\n                    css[\"color\"] = cellStyle[2].cell_font_color;\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_left')) {\n                    css[\"padding-left\"] = cellStyle[2].cell_padding_left + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_top')) {\n                    css[\"padding-top\"] = cellStyle[2].cell_padding_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_right')) {\n                    css[\"padding-right\"] = cellStyle[2].cell_padding_right + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_padding_bottom')) {\n                    css[\"padding-bottom\"] = cellStyle[2].cell_padding_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_left_top')) {\n                    css[\"border-top-left-radius\"] = cellStyle[2].cell_background_radius_left_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_right_top')) {\n                    css[\"border-top-right-radius\"] = cellStyle[2].cell_background_radius_right_top + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_right_bottom')) {\n                    css[\"border-bottom-right-radius\"] = cellStyle[2].cell_background_radius_right_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNested(cellStyle,2,'cell_background_radius_left_bottom')) {\n                    css[\"border-bottom-left-radius\"] = cellStyle[2].cell_background_radius_left_bottom + \"px\";\n                }\n                if (tableFunction.checkObjPropertyNestedNotEmpty(cellStyle,2,'tooltip_content')) {\n                    tooltip_content = cellStyle[2].tooltip_content !== '' ? true : false;\n                }\n            }\n\n            //render style for table\n            window.jquery(td).css(css);\n            if (Object.keys(css).length > 0) {\n                function_data.styleToRender += '.dtr' + row + '.dtc' + col + '{';\n                window.jquery.each(css, function (index, value) {\n                    function_data.styleToRender += index + ':' + value + ';';\n                });\n                function_data.styleToRender += '}';\n            }\n        }\n    }\n\n    if (!onl_value_cell) {\n        switch (celltype) {\n            case 'html':\n                var escaped = Handsontable.helper.stringify(value);\n                //escaped = strip_tags(escaped, '<div><span><img><em><b><a>'); //be sure you only allow certain HTML tags to avoid XSS threats (you should also remove unwanted HTML attributes)\n                td.innerHTML = escaped;\n                window.jquery(td).addClass('isHtmlCell');\n                break;\n            default:\n                window.jquery(td).removeClass('isHtmlCell');\n                Handsontable.renderers.TextRenderer.apply(this, arguments);\n                break;\n        }\n\n        if (tooltip_content) {\n            window.jquery(td).addClass('isTooltipContent');\n        } else {\n            window.jquery(td).removeClass('isTooltipContent');\n        }\n    }\n\n    /* Calculs rendering */\n    if (typeof Wptm.style.table.date_formats === 'undefined') {\n        Wptm.style.table.date_formats = window.default_value.date_formats;\n    }\n    var accounting_for_cells = {};\n    var createRegExpFormatForCell = {};\n    var currency_symbol = '';\n    var setFormat_for_cells = {};\n    var cell_has_format = 0;\n\n    //not has time format\n    [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], Wptm.style.table, function_data.string_currency_symbols, cell_has_format);\n\n    accounting_for_cells.date_formats = typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== false ? cellStyle[2].date_formats : Wptm.style.table.date_formats;\n\n    if (typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== '' && cellStyle[2].date_formats !== false) {\n        if (typeof cellStyle[2].date_formats_momentjs !== 'undefined' && cellStyle[2].date_formats_momentjs !== '' && cellStyle[2].date_formats_momentjs !== false) {\n            accounting_for_cells.date_formats_momentjs = cellStyle[2].date_formats_momentjs;\n        } else {\n            accounting_for_cells.date_formats_momentjs = tableFunction.momentjsFormat(accounting_for_cells.date_formats);\n        }\n    } else if (typeof accounting_for_cells.date_formats !== 'undefined') {\n        if (typeof function_data.date_formats_momentjs !== 'undefined' && function_data.date_formats_momentjs !== '') {\n            accounting_for_cells.date_formats_momentjs = function_data.date_formats_momentjs;\n        } else {\n            accounting_for_cells.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n        }\n    } else {\n        accounting_for_cells.date_formats_momentjs = '';\n    }\n\n    //accounting_for_cells.date_formats_momentjs from cell/table\n    if (typeof cellStyle[2].date_formats !== 'undefined' && cellStyle[2].date_formats !== false) {\n        createRegExpFormatForCell = tableFunction.createRegExpFormatForCell(false, accounting_for_cells.date_formats, createRegExpFormatForCell);\n    }\n\n    if (typeof (value) === 'string') {\n        var value_cell = value;\n        var valueNotFormat;\n        if (value[0] === '=') {\n            // console.log(row, col, accounting_for_cells);\n            value_cell = evaluateFormulas2(td, row, col, value, function_data, accounting_for_cells, createRegExpFormatForCell, setFormat_for_cells, cell_has_format, onl_value_cell);\n        } else {\n            if (currency_symbol !== '' && value.replace(currency_symbol, \"\") === '') {\n                value = value.replaceAll(accounting_for_cells.number.thousand, '');\n                value = value.replaceAll(accounting_for_cells.number.decimal, ',');\n                valueNotFormat = value;\n\n                if (cell_has_format === 1) {\n                    value_cell = accounting.formatNumber(value, accounting_for_cells.number);\n                }\n                if (cell_has_format > 1) {\n                    value_cell = accounting.formatMoney(value, accounting_for_cells.currency);\n                }\n\n                if (onl_value_cell) {\n                    valueNotFormat = accounting.formatMoney(value, \"\", accounting_for_cells.number.precision, typeof Wptm.style.table.thousand_symbol === 'undefined'\n                        ? default_value.thousand_symbol\n                        : Wptm.style.table.thousand_symbol, typeof Wptm.style.table.decimal_symbol === 'undefined'\n                        ? default_value.decimal_symbol\n                        : Wptm.style.table.decimal_symbol);\n                }\n\n                if (!onl_value_cell) {\n                    window.jquery(td).text(value_cell);\n                }\n            }\n\n            if (typeof createRegExpFormatForCell.date_format !== 'undefined'\n                && !isNaN(new Date(value).getDate()) && accounting_for_cells.date_formats !== '') {\n                value_cell = moment(value).format(cellStyle[2].date_formats_momentjs);\n                valueNotFormat = value;\n                if (!onl_value_cell) {\n                    window.jquery(td).text(value_cell);\n                }\n            }\n        }\n\n        if (celltype == 'html' && (cell_has_format >= 1 || typeof createRegExpFormatForCell.date_format !== 'undefined')) {\n            tableFunction.getFillArray([[row, col, row, col]], Wptm, {\n                date_formats: false,\n                date_formats_momentjs: false,\n                currency_symbol: false,\n                symbol_position: false,\n                decimal_symbol: false,\n                decimal_count: false,\n                thousand_symbol: false\n            }, 'style');\n            var text = window.jquery(td).text();\n            saveData.push({action: 'edit_cell', row: row, col: col, content: text});\n        }\n        if (onl_value_cell) {\n            return typeof value_cell === 'string' ? [value_cell, valueNotFormat] : value_cell;\n        }\n    }\n\n    if (!onl_value_cell) {\n        //add class for lock column of db table\n        if (typeof Wptm.style.table.lock_columns !== 'undefined' && Wptm.style.table.lock_columns[col] != 0) {\n            window.jquery(td).addClass('wptm_lock_column');\n        }\n\n        if (!wptm_administrator) {\n            var lock_cell_id = [], not_lock_cell = false;\n            if (typeof table_function_data.protect_columns !== 'undefined'\n                && typeof table_function_data.protect_columns[col] !== 'undefined') {\n                //protect columns\n                lock_cell_id.push(table_function_data.protect_columns[col]);\n            }\n            if (typeof table_function_data.protect_rows !== 'undefined'\n                && typeof table_function_data.protect_rows[row] !== 'undefined') {\n                //protect rows\n                lock_cell_id.push(table_function_data.protect_rows[row]);\n            }\n            if (typeof Wptm.style.cells[row + \"!\" + col][2].lock_cell !== 'undefined') {\n                lock_cell_id.push(Wptm.style.cells[row + \"!\" + col][2].lock_cell);\n            }\n            if (lock_cell_id.length > 0 && typeof lock_cell_id[0] !== 'undefined'\n                && typeof table_function_data.lock_ranger_cells_user !== 'undefined') {\n                for (var ij in lock_cell_id) {\n                    if (table_function_data.lock_ranger_cells_user[lock_cell_id[ij]]) {//allow edit\n                        not_lock_cell = true;\n                        break;\n                    }\n                }\n                if (!not_lock_cell) {\n                    window.jquery(td).addClass('wptm_lock_cells');\n                }\n            }\n        }\n\n        window.jquery(td).addClass('dtr' + row + ' dtc' + col);\n    }\n\n    return td;\n};\n\nfunction get_format_for_cell(cellStyle, cellStyle2, string_currency_symbols, cell_has_format) {\n    var accounting_for_cells = {};\n    var setFormat_for_cells = {};\n    var createRegExpFormatForCell = {};\n    var currency_symbol = '';\n\n    if ((typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false)\n        || (typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false)\n        || (typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== false)) {\n        setFormat_for_cells.thousand_symbol = typeof cellStyle.thousand_symbol !== 'undefined' && cellStyle.thousand_symbol !== false && cell_has_format !== 1 ? cellStyle.thousand_symbol : cellStyle2.thousand_symbol;\n        setFormat_for_cells.decimal_count = typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false && cell_has_format !== 1 ? cellStyle.decimal_count : cellStyle2.decimal_count;\n        setFormat_for_cells.decimal_symbol = typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false && cell_has_format !== 1 ? cellStyle.decimal_symbol : cellStyle2.decimal_symbol;\n\n        setFormat_for_cells.currency_symbol = typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== false && cell_has_format < 2 ? cellStyle.currency_symbol : cellStyle2.currency_symbol;\n        setFormat_for_cells.symbol_position = typeof cellStyle.symbol_position !== 'undefined' && cellStyle.symbol_position !== false && cell_has_format < 2 ? cellStyle.symbol_position : cellStyle2.symbol_position;\n\n        accounting_for_cells = tableFunction.setFormat_accounting_for_cells(setFormat_for_cells);\n        if (typeof setFormat_for_cells.currency_symbol === \"undefined\") {\n            setFormat_for_cells.currency_symbol = false;\n        }\n        createRegExpFormatForCell = tableFunction.createRegExpFormatForCell(setFormat_for_cells.currency_symbol, false, {});\n\n        if (typeof cellStyle.currency_symbol !== 'undefined' && cellStyle.currency_symbol !== '' && cellStyle.symbol_position !== false) {\n            cell_has_format += 2;\n        }\n        if (cell_has_format !== 1 && ((typeof cellStyle.decimal_count !== 'undefined' && cellStyle.decimal_count !== false) || (typeof cellStyle.decimal_symbol !== 'undefined' && cellStyle.decimal_symbol !== false))) {\n            cell_has_format += 1;\n        }\n\n        currency_symbol = new RegExp('[0-9| |\\.|\\,|\\\\-|' + (typeof createRegExpFormatForCell.string_currency_symbols !== 'undefined' ? createRegExpFormatForCell.string_currency_symbols : string_currency_symbols) + ']', \"g\");\n    }\n    return [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format];\n}\n\n// Evaluate formula in cell then set value to td\nfunction evaluateFormulas2 (td, row, col, value, function_data, accounting_for_cells, createRegExpFormatForCell, setFormat_for_cells, cell_has_format, onl_value_cell) {\n    var error = false;\n    var result = regex.exec(value);\n    var valueReturn = 'NaN';\n    var valueNotFormat = 'NaN';\n    var cellStyle;\n    var changeFormatCell = 0;\n    var save_change_format = false;\n\n    if (result !== null) {\n        var style_cell = window.Wptm.style.cells[row + '!' + col];\n        var calculation;\n        calculation = result[1];\n        var check_value_data = true;\n        var update_format_second = cell_has_format;\n        var update_date_formats_momentjs = accounting_for_cells.date_formats_momentjs;\n\n        var check_has_currency_symbol = false;\n        var cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : window.Wptm.style.table.decimal_symbol;\n        var date_format = typeof createRegExpFormatForCell.date_format !== 'undefined' ? createRegExpFormatForCell.date_format : function_data.date_format;\n\n        var currency_symbol = new RegExp('[0-9| |\\.|\\,|\\\\-|' + (typeof createRegExpFormatForCell.string_currency_symbols !== 'undefined' ? createRegExpFormatForCell.string_currency_symbols : function_data.string_currency_symbols) + ']', \"g\");\n        var cells = result[2].split(\";\");\n        var values = [];\n        //(A1:A2)(A1:A2;A3)(A1;A3)(A1;123)(A1;A2;A3:A4)(A1:A2;123)(123 > A1; A2) MIN|MAX|AVG|CONCAT\n        var ij = 0, i = 0;\n        // console.log(row, col, cell_has_format);\n        for (ij = 0; ij < cells.length; ij++) {\n            var rCells = [];\n            var datas = '';\n            var data = '';\n            var vals = cells[ij].split(\":\");\n            if (vals.length === 1 ) {//single cell\n                values[ij] = '';\n\n                var checkVal = vals[0].match(regex3);\n                if (checkVal !== null) {\n                    i = 0;\n                    for (i = 0; i < checkVal.length; i++) {\n                        //ex: B1 -> B, 1, B1\n                        rCells = regex2.exec(checkVal[i]);\n                        if (rCells !== null) {\n                            cellStyle = window.Wptm.style.cells[(rCells[2] - 1) + '!' + (tableFunction.convertAlpha(rCells[1].toUpperCase()) - 1)];\n                            // console.log(cellStyle);\n                            // console.log(row, col, update_format_second, cell_has_format, cellStyle, setFormat_for_cells);\n\n                            if (changeFormatCell < 1 && cell_has_format < 3\n                                && ((typeof cellStyle[2].decimal_count !== 'undefined' && cellStyle[2].decimal_count !== false)\n                                    || (typeof cellStyle[2].decimal_symbol !== 'undefined' && cellStyle[2].decimal_symbol !== false)\n                                    || (typeof cellStyle[2].currency_symbol !== 'undefined' && cellStyle[2].currency_symbol !== false))\n                            ) {\n                                changeFormatCell = 1;\n                                [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], setFormat_for_cells, function_data.string_currency_symbols, cell_has_format);\n                                if (typeof style_cell !== \"undefined\") {\n                                    if (update_format_second !== 1) {\n                                        if (style_cell[2].thousand_symbol_second !== (typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false)) {\n                                            style_cell[2].thousand_symbol_second = typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].decimal_count_second !== (typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false)) {\n                                            style_cell[2].decimal_count_second = typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].decimal_symbol_second !== (typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false)) {\n                                            style_cell[2].decimal_symbol_second = typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                    }\n                                    if (update_format_second !== 2) {\n                                        if (style_cell[2].currency_symbol_second !== (typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false)) {\n                                            style_cell[2].currency_symbol_second = typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false;\n                                            save_change_format = true;\n                                        }\n                                        if (style_cell[2].symbol_position_second !== (typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false)) {\n                                            style_cell[2].symbol_position_second = typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false;\n                                            save_change_format = true;\n                                        }\n                                    }\n                                }\n                                cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : setFormat_for_cells.decimal_symbol;\n                            }\n\n                            data = window.Wptm.container.handsontable('getDataAtCell', rCells[2] - 1, tableFunction.convertAlpha(rCells[1].toUpperCase()) - 1);\n\n                            if (data !== null && typeof data !== 'undefined') {\n                                check_has_currency_symbol = (data.indexOf(function_data.string_currency_symbols) > -1 || check_has_currency_symbol) ? true : false;\n                                if (!not_replace.includes(calculation.toUpperCase())) {//replace in some calculation\n                                    if (data.replace(currency_symbol, \"\") === '') {\n                                        data = accounting.unformat(data, window.Wptm.style.table.decimal_symbol);\n                                    } else {\n                                        data = '';\n                                    }\n                                }\n                                if (i === 0) {\n                                    datas = vals[0].replace(checkVal[i], data);\n                                } else {\n                                    datas = datas.replace(checkVal[i], data);\n                                }\n                            } else {\n                                datas = data = '';\n                            }\n                        } else {\n                            check_value_data = false;\n                        }\n                    }\n                } else {\n                    data = datas = vals[0];\n                }\n                if (datas !== null) {\n                    values[ij] = datas;\n                }\n            } else {\n                if (Not_range_function.includes(calculation.toUpperCase())) {//not set range in some calculation\n                    check_value_data = false;\n                }\n                rCells[0] = regex2.exec(vals[0]);\n                rCells[1] = regex2.exec(vals[1]);\n                if (rCells[0] !== null && rCells[1] !== null) {\n                    cellStyle = window.Wptm.style.cells[(rCells[0][2] - 1) + '!' + (tableFunction.convertAlpha(rCells[0][1]) - 1)];\n                    if (changeFormatCell < 1 && cell_has_format < 3 && typeof cellStyle !== 'undefined'\n                        && ((typeof cellStyle[2].decimal_count !== 'undefined' && cellStyle[2].decimal_count !== false)\n                            || (typeof cellStyle[2].decimal_symbol !== 'undefined' && cellStyle[2].decimal_symbol !== false)\n                            || (typeof cellStyle[2].currency_symbol !== 'undefined' && cellStyle[2].currency_symbol !== false))\n                    ) {\n                        changeFormatCell = 1;\n                        [accounting_for_cells, createRegExpFormatForCell, currency_symbol, setFormat_for_cells, cell_has_format] = get_format_for_cell(cellStyle[2], setFormat_for_cells, function_data.string_currency_symbols, cell_has_format);\n                        if (typeof style_cell !== \"undefined\") {\n                            if (update_format_second !== 1) {\n                                if (style_cell[2].thousand_symbol_second !== (typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false)) {\n                                    style_cell[2].thousand_symbol_second = typeof setFormat_for_cells.thousand_symbol !== 'undefined' ? setFormat_for_cells.thousand_symbol : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].decimal_count_second !== (typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false)) {\n                                    style_cell[2].decimal_count_second = typeof setFormat_for_cells.decimal_count !== 'undefined' ? setFormat_for_cells.decimal_count : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].decimal_symbol_second !== (typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false)) {\n                                    style_cell[2].decimal_symbol_second = typeof setFormat_for_cells.decimal_symbol !== 'undefined' ? setFormat_for_cells.decimal_symbol : false;\n                                    save_change_format = true;\n                                }\n                            }\n                            if (update_format_second !== 2) {\n                                if (style_cell[2].currency_symbol_second !== (typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false)) {\n                                    style_cell[2].currency_symbol_second = typeof setFormat_for_cells.currency_symbol !== 'undefined' ? setFormat_for_cells.currency_symbol : false;\n                                    save_change_format = true;\n                                }\n                                if (style_cell[2].symbol_position_second !== (typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false)) {\n                                    style_cell[2].symbol_position_second = typeof setFormat_for_cells.symbol_position !== 'undefined' ? setFormat_for_cells.symbol_position : false;\n                                    save_change_format = true;\n                                }\n                            }\n                        }\n                        cell_decimal_symbol = typeof accounting_for_cells.decimal !== 'undefined' ? accounting_for_cells.currency.decimal : window.Wptm.style.table.decimal_symbol;\n                    }\n\n                    values[ij] = [];\n                    rCells = window.Wptm.container.handsontable('getData', rCells[0][2] - 1, tableFunction.convertAlpha(rCells[0][1]) - 1, rCells[1][2] - 1, tableFunction.convertAlpha(rCells[1][1]) - 1);\n                    i = 0;\n                    for (i = 0; i < rCells.length; i++) {\n                        if (!not_replace.includes(calculation.toUpperCase())) {//replace in some calculation\n                            datas = [];\n                            for (var j = 0; j < rCells[i].length; j++) {\n                                check_has_currency_symbol = ((rCells[i][j] !== null && rCells[i][j].indexOf(window.Wptm.style.table.currency_symbol) > -1) || check_has_currency_symbol) ? true : false;\n                                if (rCells[i][j] === null) {\n                                    rCells[i][j] = '';\n                                }\n                                if (rCells[i][j].replace(currency_symbol, \"\") === '') {\n                                    datas[j] = accounting.unformat(rCells[i][j], window.Wptm.style.table.decimal_symbol);\n                                } else {\n                                    datas[j] = '';\n                                }\n                                // datas[j] = accounting.unformat(rCells[i][j], window.Wptm.style.table.decimal_symbol);\n                            }\n                        } else {\n                            datas = rCells[i];\n                        }\n                        if (datas === null) {\n                            values[ij][i] = '';\n                        } else {\n                            values[ij][i] = datas;\n                        }\n                    }\n                } else {\n                    if (tableFunction.convertDate(function_data.date_format, cells[ij].match(/[a-zA-Z0-9|+|-|\\\\]+/g), true) !== false) {\n                        values[ij] = cells[ij];\n                    } else {\n                        check_value_data = false;\n                    }\n                }\n            }\n        }\n\n        //remove format..._second\n        if (changeFormatCell < 1 && cell_has_format < 3 && typeof style_cell !== \"undefined\") {\n            if (typeof style_cell[2].thousand_symbol_second !== 'undefined' && style_cell[2].thousand_symbol_second !== false) {\n                style_cell[2].thousand_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].decimal_count_second !== 'undefined' && style_cell[2].decimal_count_second !== false) {\n                style_cell[2].decimal_count_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].decimal_symbol_second !== 'undefined' && style_cell[2].decimal_symbol_second !== false) {\n                style_cell[2].decimal_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].currency_symbol_second !== 'undefined' && style_cell[2].currency_symbol_second !== false) {\n                style_cell[2].currency_symbol_second = false;\n                save_change_format = true;\n            }\n            if (typeof style_cell[2].symbol_position_second !== 'undefined' && style_cell[2].symbol_position_second !== false) {\n                style_cell[2].symbol_position_second = false;\n                save_change_format = true;\n            }\n        }\n        if (save_change_format) {\n            saveData.push({action: 'style', selection: [[row, col, row, col]], style: style_cell[2]});\n        }\n        if (check_value_data === true) {\n            switch (calculation.toUpperCase()) {\n                case 'SUM':\n                    valueNotFormat = formulajs.SUM(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'MULTIPLY':\n                    valueNotFormat = 1;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        if (foo !== false) {\n                            var number = Number(foo);\n                            if (!isNaN(number)) {\n                                valueNotFormat = valueNotFormat * number;\n                            } else {\n                                check_value_data = false;\n                            }\n                        }\n                    });\n                    if (!check_value_data) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                    } else {\n                        if (check_has_currency_symbol || cell_has_format > 1) {\n                            valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                        } else {\n                            valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                        }\n                    }\n                    break;\n                case 'DIVIDE':\n                    valueNotFormat = '';\n                    values = merge_value_from_cells(values);\n\n                    if (values.length !== 2) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    values[1] = Number(values[1]);\n\n                    if (isNaN(values[1]) || values[1] == 0 ||  values[1] == '') {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    values[0] = Number(values[0]);\n\n                    if (isNaN(values[0])) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                        check_value_data = false;\n                        break;\n                    }\n\n                    valueNotFormat = values[0] / values[1];\n\n                    if (!check_value_data) {\n                        valueReturn = 'NaN';\n                        valueNotFormat = 'NaN';\n                    } else {\n                        if (check_has_currency_symbol || cell_has_format > 1) {\n                            valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                        } else {\n                            valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                        }\n                    }\n                    break;\n                case 'AND':\n                    valueReturn = 'true';\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn = valueReturn && parse_boolean_calculation(foo, cell_decimal_symbol);\n                    });\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'OR':\n                    valueReturn = 'true';\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn = valueReturn || parse_boolean_calculation(foo, cell_decimal_symbol);\n                    });\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'XOR':\n                    valueReturn = 0;\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn += Number(parse_boolean_calculation(foo, cell_decimal_symbol));\n                    });\n                    valueReturn = ((valueReturn % 2) === 1) ? 'true' : 'false';\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'COUNT':\n                    valueReturn = 0;\n                    var currency_symbol = new RegExp('[ |\\.|\\,|\\\\-|' + window.Wptm.style.table.currency_symbol + ']', \"g\");\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        if (foo !== false) {\n                            if (!isNaN(Number(foo)) && foo !== '') {\n                                valueReturn = valueReturn + 1;\n                            }\n                        }\n                    });\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'DATE':\n                    var data_value = '';\n                    if (values.length > 1) {\n                        data_value = values.join('/');\n                    } else {\n                        data_value = values[0];\n                    }\n\n                    if (typeof data_value !== 'undefined') {\n                        valueReturn = moment(data_value).formatWithJDF(accounting_for_cells.date_formats_momentjs);\n                    } else {\n                        valueReturn = 'NaN';\n                        check_value_data = false;\n                    }\n                    valueNotFormat = valueReturn;\n                    // if (values.length === 1) {\n                    //     values = values[0].match(/[a-zA-Z0-9|+|-|\\\\]+/g);\n                    // }\n                    // //convert values --> (string) date pursuant date_format not have timezone\n                    // var date_string = tableFunction.convertDate(function_data.date_format, values, false);\n                    // date_string = date_string !== false ? new Date(date_string) : check_value_data = false;\n                    //\n                    // //convert values --> (string) date pursuant date_format have timezone\n                    // var date_string_timezone = tableFunction.convertDate(function_data.date_format, values, true);\n                    // date_string_timezone = date_string_timezone !== false ? new Date(date_string_timezone) : check_value_data = false;\n                    // if (date_string_timezone && date_string_timezone.getDate() > 0 && check_value_data !== false) {\n                    //     var format_resultCalc = window.Wptm.style.table.date_formats.split(/[a-zA-Z|\\\\]+/g);\n                    //     var date = [];\n                    //\n                    //     date['month'] = date_string.getMonth();\n                    //     date['date'] = date_string.getDate();\n                    //     date['day'] = date_string.getDay();\n                    //     date['year'] = date_string.getUTCFullYear();\n                    //\n                    //     date['D'] = D_name[date['day']];\n                    //     date['l'] = l_name[date['day']];\n                    //     date['j'] = date['date'];\n                    //     date['d'] = (Number(date['date']) < 10) ? '0' + date['date'] : date['date'];\n                    //     date['F'] = F_name[date['month']];\n                    //     date['M'] = M_name[date['month']];\n                    //     date['n'] = Number(date['month']) + 1;\n                    //     date['m'] = (Number(date['month']) < 10) ? '0' + (Number(date['month']) + 1) : Number(date['month']) + 1;\n                    //     date['Y'] = date['year'];\n                    //     date['y'] = Number(date['year']) % 100;\n                    //\n                    //     valueReturn = format_resultCalc[0];\n                    //     window.jquery.each(function_data.date_format, function (i, v) {\n                    //         if (v.indexOf(\"\\\\\") !== -1 || window.jquery.inArray(v, [\"a\", \"A\", \"g\", \"G\", \"h\", \"H\", \"i\", \"s\", \"T\"]) !== -1) {\n                    //             date[v] = values[i];\n                    //         }\n                    //         valueReturn += date[v] + format_resultCalc[i + 1];\n                    //     });\n                    // } else {\n                    //     valueReturn = 'NaN';\n                    //     check_value_data = false;\n                    // }\n                    break;\n                case 'DAY':\n                    if (typeof values[0] !== 'undefined') {\n                        valueNotFormat = values[0];\n                        valueReturn = formulajs.DAY(values[0]);\n                    }\n                    break;\n                case 'DAYS':\n                    if (typeof values[0] !== 'undefined' && typeof values[1] !== 'undefined') {\n                        valueReturn = formulajs.DAYS(values[0], values[1]);\n                    }\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'DAYS360':\n                    valueReturn = 0;\n                    if (check_value_data !== false) {\n                        var month = [];\n                        var year = [];\n                        var days = [];\n                        var date1 = 0;\n                        values.map(function (foo) {\n                            if (foo !== false) {\n                                valueReturn++;\n                                var number = foo.match(/[a-zA-Z0-9|+|-|\\\\]+/g);\n                                var string_day = tableFunction.convertDate(function_data.date_format, number, true);\n                                if (string_day !== false) {\n                                    date1 = new Date(string_day);\n                                    if (!isNaN(date1.getTime())) {\n                                        days[valueReturn] = date1.getDate();\n                                        month[valueReturn] = date1.getMonth();\n                                        year[valueReturn] = date1.getFullYear();\n                                    }\n                                }\n                            }\n                        });\n                        if (year.length > 1) {\n                            if (year[2] < year[1]) {\n                                year[2] = year[1] + year[2];\n                                year[1] = year[2] - year[1];\n                                year[2] = year[2] - year[1];\n                                month[2] = month[1] + month[2];\n                                month[1] = month[2] - month[1];\n                                month[2] = month[2] - month[1];\n                                days[2] = days[1] + days[2];\n                                days[1] = days[2] - days[1];\n                                days[2] = days[2] - days[1];\n                                year[4] = -1;\n                            } else {\n                                year[4] = 1;\n                            }\n                            year[3] = 0;\n\n                            for (i = year[1]; i < year[2]; i++) {\n                                year[3] += 1;\n                            }\n                            days[1] = (days[1] === 31) ? 30 : days[1];\n                            days[2] = (days[2] === 31) ? 30 : days[2];\n                            valueReturn = year[4] * (((year[3] - 1) * 360) + ((13 - month[1]) * 30 - days[1]) + ((month[2] - 1) * 30 + days[2]));\n                            check_value_data = !isNaN(valueReturn);\n                        } else {\n                            valueReturn = 'NaN';\n                            check_value_data = false;\n                        }\n                    } else {\n                        valueReturn = 'NaN';\n                    }\n                    valueNotFormat = valueReturn;\n                    break;\n                case 'MIN':\n                    valueNotFormat = formulajs.MIN(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'MAX':\n                    valueNotFormat = formulajs.MAX(values);\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'AVG':\n                    values = merge_value_from_cells(values);\n                    valueNotFormat = formulajs.SUM(values) / values.length;\n                    if (check_has_currency_symbol || cell_has_format > 1) {\n                        valueReturn = accounting.formatMoney(valueNotFormat, accounting_for_cells.currency);\n                    } else {\n                        valueReturn = accounting.formatNumber(valueNotFormat, accounting_for_cells.number);\n                    }\n                    break;\n                case 'CONCAT':\n                    valueReturn = '';\n                    values = merge_value_from_cells(values);\n                    values.map(function (foo) {\n                        valueReturn = valueReturn + '' + foo;\n                    });\n                    valueNotFormat = valueReturn;\n                    break;\n            }\n        }\n    }\n\n    if (check_value_data === true) {\n        if (!onl_value_cell) {\n            window.jquery(td).text(valueReturn);\n        }\n    } else {\n        function_data.check_value_data = check_value_data;\n    }\n    return [valueReturn, valueNotFormat];\n}\n\nfunction merge_value_from_cells(values) {\n    var value = [];\n\n    values.map(function (foo) {\n        if (foo === null) {\n            foo = '';\n        }\n        if (foo !== false) {\n            if (typeof foo === 'object') {\n                value = value.concat(merge_value_from_cells(foo));\n            } else {\n                value = value.concat([foo]);\n            }\n        }\n    });\n\n    return value;\n}\n\nfunction parse_boolean_calculation(values, decimal_symbol) {\n    var math = values.match(/<=|>=|!=|>|<|=/g);\n    var value = true, value1, value2;\n    if (math !== null) {\n        value1 = values.split(math[0])[0];\n        value2 = values.split(math[0])[1];\n        value1 = accounting.unformat(value1, decimal_symbol);\n        value2 = accounting.unformat(value2, decimal_symbol);\n        switch (math[0]) {\n            case '<=':\n                value = Number(value1) <= Number(value2);\n                break;\n            case '>=':\n                value = Number(value1) >= Number(value2);\n                break;\n            case '=':\n                value = Number(value1) === Number(value2);\n                break;\n            case '!=':\n                value = Number(value1) !== Number(value2);\n                break;\n            case '<':\n                value = Number(value1) < Number(value2);\n                break;\n            case '>':\n                value = Number(value1) > Number(value2);\n                break;\n        }\n    } else {\n        value = values === 'true' ? true : false;\n    }\n    return value;\n}\n\nexport default {\n    render,\n    evaluateFormulas2,\n}\n","import alternating from \"./_alternating\"\nimport wptmPreview from \"./_wptm\";\nimport {initHandsontable} from \"./_initHandsontable\";\n\nvar F_name = [\"january\", \"february\", \"march\", \"april\", \"may\", \"june\", \"july\", \"august\", \"september\", \"october\", \"november\", \"december\"];\nvar M_name = [\"jan\", \"feb\", \"mar\", \"apr\", \"may\", \"jun\", \"jul\", \"aug\", \"sept\", \"oct\", \"nov\", \"dec\"];\nvar l_name = [\"sunday\", \"monday\", \"tuesday\", \"wednesday\", \"thursday\", \"friday\", \"saturday\"];\nvar D_name = [\"sun\", \"mon\", \"tue\", \"wed\", \"thu\", \"fri\", \"sat\"];\nvar regex = new RegExp('^=(DATE|DAY|DAYS|DAYS360|AND|OR|XOR|SUM|MULTIPLY|DIVIDE|COUNT|MIN|MAX|AVG|CONCAT|date|day|days|days360|and|or|xor|sum|multiply|divide|count|min|max|avg|concat)\\\\((.*?)\\\\)$');\n\n// set value for an html switch-button element from Style object\nfunction updateSwitchButtonFromStyleObject(styleObj, prop, that, defaultValue, callback) {\n    if (checkObjPropertyNested(styleObj, prop)) {\n        defaultValue = styleObj[prop];\n    }\n    that.val(defaultValue == 1 ? 'yes' : 'no').prop(\"checked\", defaultValue == 1);\n\n    if (typeof callback !== 'undefined') {\n        callback.call(that);\n    }\n}\n\n// set value for an html input element from cellStyle object\nfunction updateParamFromStyleObject(styleObj, prop, that, defaultValue, callback) {\n    if (checkObjPropertyNested(styleObj, prop)) {\n        that.val(styleObj[prop]);\n    } else {\n        that.val(defaultValue);\n    }\n    if (typeof callback !== 'undefined') {\n        callback.call(that);\n    }\n}\n\n// set value for an html input element from cellStyle object\nfunction updateParamFromStyleObjectSelectBox(styleObj, prop, that, defaultValue, callback, multiple_select) {\n    if (styleObj !== '') {\n        if (checkObjPropertyNested(styleObj, prop)) {\n            defaultValue = styleObj[prop];\n        }\n    }\n    that.data('value', defaultValue);\n\n    var text = '';\n    if (multiple_select) {\n        jquery.each(defaultValue.split('|'), function (i, v) {\n            if (text !== '') {\n                text += ',' + that.find('li[data-value=\"' + v + '\"]').text();\n            } else {\n                text += that.find('li[data-value=\"' + v + '\"]').text();\n            }\n        })\n    } else if (that.find('li[data-value=\"' + defaultValue + '\"]').length > 0) {\n        text += that.find('li[data-value=\"' + defaultValue + '\"]').text();\n    }\n    that.prev('.wptm_select_box_before').text(text === '' ? defaultValue : text).data('value', defaultValue);\n\n    if (typeof callback !== 'undefined' && callback !== null) {\n        callback.call(that);\n    }\n}\n\nfunction combineChangedCellIntoRow(extendData) {\n    if(changedData.length < 1) {\n        changedData = [{row: extendData.row, cell: [{col: extendData.col, content: extendData.content}]}];\n    } else {\n        var newRow = true;\n        for(var i = 0; i < changedData.length; i++) {\n            var rowData = changedData[i];\n            if(rowData.row === extendData.row) {\n                var newCell = true;\n                for(var j = 0; j < rowData.cell.length; j++) {\n                    var cellData = rowData.cell[j];\n                    if(cellData.col === extendData.col) {\n                        cellData.content = extendData.content;\n                        newCell = false;\n                        break;\n                    }\n                }\n                if(newCell) {\n                    rowData.cell.push({col: extendData.col, content: extendData.content});\n                }\n                newRow = false;\n                break;\n            }\n        }\n        if(newRow) {\n            changedData.push({row: extendData.row, cell: [{col: extendData.col, content: extendData.content}]});\n        }\n    }\n}\n\n// check for existence of nested object key\n// example: var test = {level1:{level2:{level3:'level3'}} };\n// checkObjPropertyNested(test, 'level1', 'level2', 'level3'); // true\nfunction checkObjPropertyNested(obj /*, level1, level2, ... levelN*/) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    for (var i = 0; i < args.length; i++) {\n        if (!obj || !obj.hasOwnProperty(args[i])) {\n            return false;\n        }\n        obj = obj[args[i]];\n    }\n    return true;\n}\n\n// check for existence of nested object key and check value not empty\n// example: var test = {level1:{level2:{level3:'level3'}} };\n// checkObjPropertyNestedNotEmpty(test, 'level1', 'level2', 'level3'); // true\nfunction checkObjPropertyNestedNotEmpty(obj /*, level1, level2, ... levelN*/) {\n    var args = Array.prototype.slice.call(arguments, 1);\n\n    for (var i = 0; i < args.length; i++) {\n        if (!obj || !obj.hasOwnProperty(args[i]) || !obj[args[i]]) {\n            return false;\n        }\n        obj = obj[args[i]];\n    }\n    return true;\n}\n\n/**\n * calculater height for table when change height row\n *\n * @param topElement\n * @returns {number}\n */\nfunction calculateTableHeight(topElement) {\n    var top = topElement.outerHeight() + 33, paddingBottom;\n    if (canInsert == 1) {\n        paddingBottom = 30; //px\n    } else {\n        paddingBottom = 10; //px\n    }\n\n    var windownHeight = jquery(window).height();\n    var height = windownHeight - top - paddingBottom;\n    return height;\n}\n//convert aphabel to number when get col number\nfunction convertStringToNumber (val) {\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\n\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\n        result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\n    }\n\n    return result;\n}\n\n/*print getSelect cell to element*/\nfunction getSelectedVal(dataSelect, selectRange) {\n    var valueRange = '';\n\n    if (dataSelect[1] > 25) {\n        valueRange += String.fromCharCode(97) + String.fromCharCode(97 + dataSelect[1] - 26);\n    } else {\n        if (dataSelect[1] !== false) {\n            valueRange += String.fromCharCode(97 + dataSelect[1]);\n        }\n    }\n    if (dataSelect[0] !== false) {\n        valueRange += dataSelect[0] + 1;\n    }\n\n    valueRange += ':';\n\n\n    if (dataSelect[3] > 25) {\n        valueRange += String.fromCharCode(97) + String.fromCharCode(97 + dataSelect[3] - 26);\n    } else {\n        if (dataSelect[3] !== false) {\n            valueRange += String.fromCharCode(97 + dataSelect[3]);\n        }\n    }\n    if (dataSelect[2] !== false) {\n        valueRange += dataSelect[2] + 1;\n    }\n    if (typeof selectRange !== 'undefined') {\n        selectRange.val(valueRange);\n    } else {\n        return valueRange;\n    }\n}\n\nfunction warning_edit_db_table (field, value) {\n    var edit = wptmText.warning_edit_db_table.replace('FIELD_JOOMUNITED', field).replace('FIELD_JOOMUNITED_VALUE', value);\n    bootbox.confirm(edit, wptmText.Cancel, wptmText.Ok, function(result){\n        if (result) {\n            saveData = saveData.concat(Wptm.saveDataDbTable);\n            wptm_element.mainTabContent.addClass('loading_ajax');\n            saveChanges(true);\n        } else {\n            Wptm.saveDataDbTable = [];\n        }\n    });\n}\n\n/*time out auto save*/\nvar autosaveNotification;\nvar getSaveAjax;\n\nfunction cleanHandsontable () {\n    wptm_element.primary_toolbars.find('#undo_cell').removeClass('active').addClass('no_active');\n    wptm_element.primary_toolbars.find('#redo_cell').removeClass('active').addClass('no_active');\n    setTimeout(function () {\n        jquery(Wptm.container).handsontable('getInstance').undoRedo.clear();\n    }, 500);\n}\n\n/*saving table*/\nfunction saveChanges(autosave, ajaxCallback) {\n    var $ = window.jquery;\n    Wptm.saveDataDbTable = [];\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return;\n    }\n    //check save calculate date\n    if (window.table_function_data.check_value_data === false) {\n        setTimeout(function () {\n            $('#saveErrorTable').animate({'top': '+=75px', 'opacity': '1'}, 500).delay(2000).animate({\n                'top': '-=75px',\n                'opacity': '0'\n            }, 1000);\n        }, 1000);\n        window.table_function_data.check_value_data = true;\n        return;\n    }\n\n    if ((typeof autosave == 'undefined' && !enable_autosave) || autosave === false) {\n        checkTimeOut = false;\n        return;\n    }\n    if (!checkTimeOut) {\n        clearTimeout(getSaveAjax);\n    }\n\n    checkTimeOut = false;\n\n    var delay_time = enable_autosave ? 5000 : 0;\n\n    if (autosave === true) {\n        delay_time = 100;\n    }\n\n    getSaveAjax = setTimeout(function () {\n        /*check have the change Alternate*/\n        if (_.size(window.table_function_data.checkChangeAlternate) > 0) {\n            window.Wptm.style.cells = $.extend({}, alternating.reAlternateColor());\n        }\n\n        var save_data;\n\n        if (window.Wptm.mergeCellsSetting.length > 0) {//update header option by merger cells\n            var i;\n            var maxHeader = window.Wptm.headerOption;\n            for (i = 0; i < window.Wptm.mergeCellsSetting.length; i++) {\n                var mergeSetting = window.Wptm.mergeCellsSetting[i];\n                maxHeader = (mergeSetting.row < maxHeader && mergeSetting.row + mergeSetting.rowspan > maxHeader) ? mergeSetting.row + mergeSetting.rowspan : maxHeader;\n            }\n\n            if (maxHeader > window.Wptm.headerOption) {\n                saveData.push({\n                    action: 'set_header_option',\n                    value: maxHeader\n                });\n                window.Wptm.headerOption = maxHeader;\n\n                if (Wptm.style.table.freeze_row > 0) {\n                    $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: maxHeader});\n                }\n            }\n        }\n        if (typeof table_function_data.colsSetType !== 'undefined') {\n            saveData.push({\n                action: 'set_columns_types',\n                value: table_function_data.colsSetType\n            });\n            delete table_function_data.colsSetType;\n        }\n\n        if (table_function_data.save_table_params.length > 0) {\n            save_data = JSON.stringify(table_function_data.save_table_params);\n        } else {\n            save_data = JSON.stringify(saveData);\n        }\n        var Wptm_hyperlink = {};\n        if (typeof Wptm.hyperlink !== 'undefined') {\n            Wptm_hyperlink = $.extend({}, {}, Wptm.hyperlink);\n            $.each(Wptm.hyperlink, function (i, v) {\n                Wptm_hyperlink[i] = {};\n                Wptm_hyperlink[i].hyperlink = v.hyperlink;\n                Wptm_hyperlink[i].text = typeof v.text !== 'undefined' ? v.text : '';\n                if (typeof v.text !== 'undefined' && v.text.indexOf('\\\"') > -1) {\n                    Wptm_hyperlink[i].text = v.text.replaceAll('\\\"', '\\\\\"');\n                }\n            })\n        } else {\n            Wptm_hyperlink = {};\n        }\n\n        var jsonVar = {\n            jform: {\n                datas: save_data,\n                style: JSON.stringify({'table': window.Wptm.style.table, 'cols': window.Wptm.style.cols, 'rows': window.Wptm.style.rows}),\n                css: window.Wptm.css,\n                params: (window.Wptm.type !== 'html') ? {\"mergeSetting\": JSON.stringify(window.Wptm.mergeCellsSetting), \"headerOption\": 1} : {\n                    \"mergeSetting\": JSON.stringify(window.Wptm.mergeCellsSetting),\n                    \"hyperlink\": JSON.stringify(Wptm_hyperlink),\n                    \"headerOption\": window.Wptm.headerOption\n                },\n                count: {'countRows': $(window.Wptm.container).handsontable('countRows'), 'countCols': $(window.Wptm.container).handsontable('countCols')}\n            },\n            id: window.Wptm.id\n        };\n\n        if (typeof window.Wptm.syn_hash !== 'undefined' && window.Wptm.syn_hash !== '') {\n            jsonVar.jform.syn_hash = window.Wptm.syn_hash;\n        }\n\n        window.Wptm.style = cleanStyle(window.Wptm.style, $(window.Wptm.container).handsontable('countRows'), $(window.Wptm.container).handsontable('countCols'));\n        window.table_function_data.old_slection = window.table_function_data.selection;\n        // return;\n        $.ajax({\n            url: wptm_ajaxurl + \"task=table.save\",\n            dataType: \"json\",\n            type: \"POST\",\n            data: jsonVar,\n            beforeSend: function () {\n                wptm_element.settingTable.find('.wptm_save_error').addClass('wptm_hiden');\n                wptm_element.settingTable.find('.wptm_saving').html('<span>' + wptmText.SAVING + '</span>');\n                wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                window.table_function_data.firstRender = false;\n            },\n            success: function (datas) {\n                if (datas.response === true) {\n                    wptm_element.settingTable.find('.wptm_save_error').addClass('wptm_hiden');\n                    wptm_element.settingTable.find('.wptm_saving').html('<span>' + wptmText.ALL_CHANGES_SAVED + '</span>');\n\n                    //empty data in saveData\n                    if (table_function_data.save_table_params.length > 0) {\n                        table_function_data.save_table_params = [];\n                    } else {\n                        saveData = [];\n                    }\n\n                    update_after_save(datas.datas);\n                    if (typeof ajaxCallback !== 'undefined' && ajaxCallback === 'render') {\n                        setTimeout(function () {\n                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                        }, 500);\n                    }\n\n                    setTimeout(function () {\n                        wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n                    }, 1500);\n                } else {\n                    bootbox.alert(datas.response, wptmText.Ok);\n                }\n                if (typeof ajaxCallback == 'function') {\n                    ajaxCallback(window.Wptm.id)\n                }\n                window.table_function_data.firstRender = true;\n            },\n            error: function (jqxhr, textStatus, error) {\n                bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n            }\n        });\n        checkTimeOut = true;\n    }, delay_time);\n}\n\n/**\n * convert cell data by column type\n *\n * @param position cell position\n * @param value    New value\n * @returns {string|boolean}\n */\nfunction cell_type_to_column (position, value) {\n    if ((Wptm.type !== 'mysql' && typeof Wptm.style.table.col_types[position[1]] !== 'undefined')\n        || (typeof Wptm.query_option !== 'undefined' && typeof Wptm.query_option.column_options !== 'undefined' && typeof Wptm.query_option.column_options[position[1]] !== 'undefined')) {\n        if (value === null) {\n            value = '';\n        }\n        var type_column;\n        if (Wptm.type === 'mysql' && typeof Wptm.query_option.column_options !== 'undefined' && typeof Wptm.query_option.column_options[position[1]] !== 'undefined') {\n            type_column = Wptm.query_option.column_options[position[1]].Type;\n        } else {\n            type_column = Wptm.style.table.col_types[position[1]];\n        }\n        var data = validate_type_cell(type_column, value);\n        return data;\n    }\n    return true;\n}\n\nfunction deleteRowDbTable (table, field, id_row) {\n    var url = wptm_ajaxurl + \"task=table.deleteRowDbTable\";\n    wptm_element.mainTabContent.addClass('loading_ajax');\n\n    jquery.ajax({\n        url: url,\n        data: {\n            id_table: Wptm.id,\n            value: id_row,\n            field: field,\n            table: table\n        },\n        type: 'POST',\n        success: function (datas) {\n            updateDataAndParamsTable();\n        },\n        error: function (jqxhr, textStatus, error) {\n            bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n        }\n    })\n}\n\nfunction createRowDbTable (dbtable, list_value) {\n    var url = wptm_ajaxurl + \"task=table.createRowDbTable\";\n    wptm_element.mainTabContent.addClass('loading_ajax');\n    jquery.ajax({\n        url: url,\n        data: {\n            id: Wptm.id,\n            data: list_value,\n            dbtable: dbtable\n        },\n        type: 'POST',\n        success: function (datas) {\n            updateDataAndParamsTable();\n        },\n        error: function (jqxhr, textStatus, error) {\n            bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n        }\n    })\n}\n\nfunction validate_type_cell (type_column, value) {\n    var date_string;\n    var length = value.length;\n\n    var result = regex.exec(value);\n\n    switch (type_column.toUpperCase()) {\n        case 'INT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -2147483648 && parseInt(value) > 2147483647) {\n                    return false;\n                }\n            }\n            break;\n        case 'SMALLINT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -32768 && parseInt(value) > 32767) {\n                    return false;\n                }\n            }\n            break;\n        case 'TINYINT':\n            if (value === '') {\n                value = '0';\n            }\n\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -128 && parseInt(value) > 127) {\n                    return false;\n                }\n            }\n            break;\n        case 'MEDIUMINT':\n            if (value === '') {\n                value = '0';\n            }\n            if (result === null) {\n                if (value.replace(/[ |0-9]+/g, '') !== '') {\n                    return false;\n                }\n                if (parseInt(value) < -8368608 && parseInt(value) > 8368607) {\n                    return false;\n                }\n            }\n            break;\n        case 'bigint unsigned':\n            if (value === '') {\n                value = '0';\n            }\n            if (value.replace(/[ |0-9]+/g, '') !== '') {\n                return false;\n            }\n            break;\n        case 'DECIMAL(16,4)':\n            if (value === '') {\n                value = '0';\n            }\n            if (value.replace(/[ |0-9|.]+/g, '') !== '') {\n                return false;\n            }\n            break;\n\n        case 'DATE':\n            if (value !== '') {\n                date_string = convertDate([\"Y\", \"m\", \"d\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00-00-0000') {\n                    return '0000-00-00';\n                }\n                date_string = new Date(date_string);\n                if (isNaN(date_string.getTime())) {\n                    return false;\n                }\n                return date_string.getUTCFullYear() + '-' + ((date_string.getMonth() < 10) ? '0' + (date_string.getMonth() + 1) : date_string.getMonth() + 1) + '-' + date_string.getDate();\n            } else {\n                return '0000-00-00';\n            }\n            break;\n        case 'DATETIME':\n            if (value !== '') {\n                date_string = convertDate([\"Y\", \"m\", \"d\", \"h\", \"i\", \"s\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00/00/0000 0:00:00 ') {\n                    return '0000-00-00 00:00:00';\n                }\n                date_string = new Date(date_string);\n                if (isNaN(date_string.getTime())) {\n                    return false;\n                }\n                return date_string.getUTCFullYear() + '-' + ((date_string.getMonth() < 10) ? '0' + (date_string.getMonth() + 1) : date_string.getMonth() + 1) + '-' + date_string.getDate() + ' ' + date_string.getHours() + ':' + date_string.getMinutes() + ':' + date_string.getSeconds();\n            } else {\n                return '0000-00-00 00:00:00';\n            }\n            break;\n        case 'TIME':\n            if (value !== '') {\n                date_string = convertDate([\"H\", \"m\", \"S\"], value.match(/[a-zA-Z0-9|+|-|\\\\]+/g), true);\n                if (date_string === false) {\n                    return false;\n                }\n                if (date_string === '00-00-00 ') {\n                    return '00:00:00';\n                }\n                date_string = new Date(date_string);\n                if (isNaN(date_string.getTime())) {\n                    return false;\n                }\n                return date_string.getHours() + ':' + date_string.getMinutes() + ':' + date_string.getSeconds();\n            } else {\n                return '00:00:00';\n            }\n            break;\n        case 'TIMESTAMP':\n            if (value !== '') {\n                if (isNaN(value) || parseInt(value) < 0) {\n                    return false;\n                }\n                date_string = (new Date(value)).getTime() > 0;\n\n                if (date_string === false) {\n                    return false;\n                }\n\n                return value;\n            }\n            break;\n\n        case 'VARCHAR':\n            if (length > 255) {\n                return false;\n            }\n            break;\n        case 'TEXT':\n            if (length > 65500) {\n                return false;\n            }\n            break;\n        case 'LONGTEXT':\n            if (length > 4294967294) {\n                return false;\n            }\n            break;\n        case 'MEDIUMTEXT':\n            if (length > 16777214) {\n                return false;\n            }\n            break;\n        case 'CHAR':\n            if (length > 255) {\n                return false;\n            }\n            break;\n        case 'FLOAT':\n            if (value === '') {\n                value = '0';\n            }\n            if (result === null) {\n                if (isNaN(parseFloat(value))) {\n                    return false;\n                }\n            }\n            break;\n        default:\n            return value;\n            break;\n    }\n    return value;\n}\n\nfunction updateDataAndParamsTable() {\n    var url = wptm_ajaxurl + \"view=table&format=json&id=\" + Wptm.id;\n    var $ = jquery;\n    $.ajax({\n        url: url,\n        type: \"POST\",\n        data: {},\n        dataType: \"json\",\n    }).done(function (data) {\n        if (data.datas === '' || data.datas === false) {\n            delete Wptm.datas;\n            Wptm.datas = [\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n            ];\n        } else {\n            data.datas = JSON.stringify(data.datas);\n            try {\n                Wptm.datas = JSON.parse(data.datas);\n            } catch (err) {\n                Wptm.datas = [\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n                ];\n            }\n        }\n\n        Wptm.style = $.parseJSON(data.style);\n        if (data.params === \"\" || data.params === null || data.params.length == 0) {\n            Wptm.mergeCellsSetting = [];\n            Wptm.headerOption = 1;\n        } else {\n            if (typeof (data.params) == 'string') {\n                data.params = $.parseJSON(data.params);\n            }\n\n            if (typeof data.params.headerOption !== 'undefined') {\n                Wptm.headerOption = parseInt(data.params.headerOption);\n            } else {\n                Wptm.headerOption = 1;\n            }\n            if (Wptm.headerOption > 0 && (typeof Wptm.style.table.header_data === 'undefined' || Wptm.style.table.header_data.length < Wptm.headerOption)) {\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n            window.jquery(window.Wptm.container).data('handsontable').loadData(Wptm.datas);\n        }\n        wptm_element.mainTabContent.removeClass('loading_ajax');\n    })\n    return false;\n}\n\n/**\n * Update some value in Wptm after saving ajax\n * @param datas\n */\nfunction update_after_save(datas) {\n    if (typeof datas.type !== 'undefined') {\n        jquery.each(datas.type, function (i, v) {\n            switch (i) {\n                case \"reload_table\":\n                    updateDataAndParamsTable();\n                    break;\n                case \"set_columns_types\":\n                    var selected = [];\n\n                    jquery.each(window.table_function_data.old_slection, function (i, v) {\n                        if (typeof Wptm.headerOption !== 'undefined') {\n                            if (v[0] < parseInt(Wptm.headerOption)) {\n                                v[0] = parseInt(Wptm.headerOption);\n                            }\n                        }\n                        selected[i] = v;\n                    });\n\n                    change_value_cells(selected, v, 'col%key');\n                    break;\n                case \"update_params\":\n                    var params = jquery.parseJSON(v);\n                    if (typeof params.headerOption !== 'undefined') {\n                        Wptm.headerOption = parseInt(params.headerOption);\n                    } else {\n                        Wptm.headerOption = 1;\n                    }\n                    try {\n                        Wptm.mergeCellsSetting = jquery.parseJSON(params.mergeSetting);\n                        if (Wptm.mergeCellsSetting == null) {\n                            Wptm.mergeCellsSetting = [];\n                        }\n                    } catch (e) {\n                        Wptm.mergeCellsSetting = [];\n                    }\n\n                    //not update header_data, it was updated\n                    if (typeof params.header_data !== 'undefined') {\n                        var old_header_data = Wptm.style.table.header_data;\n                        delete params.header_data;\n                    }\n                    params.hyperlink = params.hyperlink.replaceAll('\\\\\\\\\\\\\"', '\\\\\"');\n                    Wptm.hyperlink = jquery.parseJSON(params.hyperlink);\n                    window.Wptm.style.table = jquery.extend({}, params);\n                    window.Wptm.style.table.header_data = old_header_data;\n                    break;\n            }\n        });\n\n        if (typeof table_function_data.fetch_data !== 'undefined') {\n            wptmPreview.fetchSpreadsheet(table_function_data.fetch_data);\n        }\n    }\n}\n\n/**\n * change cells value when add function in toolbar\n *\n * @param selection\n * @param values\n * @param keyColum\n */\nfunction change_value_cells(selection, values, keyColum) {\n    table_function_data.data_argument = [];\n    var i, j, jj, value;\n    if (selection === null) {\n        selection = table_function_data.selection;\n    }\n\n    var cellProperties;\n\n    for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n        for (i = selection[jj][0]; i <= selection[jj][2]; i++) {\n            for (j = selection[jj][1]; j <= selection[jj][3]; j++) {\n                cellProperties = check_cell_readOnly(i, j, true);\n                if (typeof cellProperties.readOnly == \"undefined\" || cellProperties.readOnly !== true) {\n                    if (Array.isArray(values)) {\n                        value = values[i][keyColum.replace('%key', j)];\n                        table_function_data.data_argument.push([i, j, value, 'wptm_change_value_after_set_columns_types']);\n                    } else {\n                        value = values;\n                        table_function_data.data_argument.push([i, j, value]);\n                    }\n                    Wptm.datas[i][j] = value;\n                }\n            }\n        }\n    }\n\n    if (table_function_data.changeTheme) {\n        wptmPreview.updatepreview(Wptm.id);\n    }\n    if (table_function_data.data_argument.length < 5) {//if cells number < 5 then setDataAtCell() is more performance\n        window.jquery(window.Wptm.container).data('handsontable').setDataAtCell(table_function_data.data_argument, 'setDataAtCell');\n    } else {\n        window.jquery(window.Wptm.container).data('handsontable').loadData(Wptm.datas);\n    }\n}\n\n//function in table DB\nfunction loadTableContructor() {\n    var $ = window.jquery;\n    var id_table = $('li.wptmtable.active').data('id-table');\n    var table_type = $('li.wptmtable.active').data('table-type');\n    var $mainTable = $(\"#mainTable\");\n    $mainTable.find(\".tabDataSource\").hide();\n    $mainTable.find(\".groupTable\" + id_table).show();\n    if (table_type == 'mysql') {\n        if ($(\"#tabDataSource_\" + id_table).length == 0) {\n            var firstTab = $mainTable.find('li').get(0);\n            $(firstTab).after('<li><a data-toggle=\"tab\" id=\"tabDataSource_' + id_table + '\" class=\"tabDataSource groupTable' + id_table + '\" href=\"#dataSource_' + id_table + '\">Data Source</a></li>');\n            $('#mainTabContent.tab-content').append('<div class=\"db_table tab-pane\" id=\"dataSource_' + id_table + '\">' +\n                '<div class=\"dataSourceContainer\" style=\"padding-top:10px\" ></div></div>');\n\n            $.ajax({\n                url: wptm_ajaxurl + \"view=dbtable&id_table=\" + id_table,\n                type: \"GET\"\n            }).done(function (data) {\n                $(\"#dataSource_\" + id_table).html(data);\n            });\n        }\n    }\n    //do nothing\n}\n\n// Build column selection for default sort parameter\nfunction default_sortable(tableData) {\n    var $ = window.jquery;\n    if (tableData && typeof tableData[0] !== 'undefined') {\n        var $jform_default_sortable = $('#content_popup_hide').find('.select_columns');\n        var $jform_reponsive_table = $('#content_popup_hide').find('#responsive_table table tbody');\n        var $jform_column_type_table = $('#content_popup_hide').find('#column_type_table table tbody');\n        $jform_default_sortable.contents('li').remove();\n        $jform_reponsive_table.html('');\n        $jform_column_type_table.html('');\n        var html = '';\n        var html2 = '';\n        var column_type_html = '';\n        var ii = 0;\n\n        var responsive_priority = '';\n        for (var number = 0; number < (window.Wptm.max_Col > 12 ? window.Wptm.max_Col : 12); number++) {\n            responsive_priority += '<li data-value=\"' + number + '\">' + number + '</li>\\n';\n        }\n\n        $.each(tableData[0], function (i, e) {\n            var table_headers = jQuery(Wptm.container).handsontable('getColHeader');\n            var header = table_headers[i];\n            html += '<li data-value=\"' + ii + '\">' + header + '</li>';\n\n            html2 += '<tr data-col=\"' + ii + '\">';\n            html2 += '<td><label>' + header + '</label></td>';\n            html2 += '<td><span class=\"responsive_priority popup_select mb-0 wptm_select_box_before\"></span><ul class=\"wptm_select_box\">\\n'\n                + responsive_priority +\n                '</ul></td>';\n            html2 += '</tr>';\n\n            column_type_html += '<tr data-col=\"' + ii + '\">';\n            column_type_html += '<td><label>' + header + '</label></td>';\n            column_type_html += '<td><span class=\"column_type popup_select mb-0 wptm_select_box_before\"></span><ul class=\"wptm_select_box\">\\n' +\n                '                        <li data-value=\"varchar\">'+wptmContext.column_type_varchar+'</li>\\n' +\n                '                        <li data-value=\"int\">'+wptmContext.column_type_int+'</li>\\n' +\n                '                        <li data-value=\"float\">'+wptmContext.column_type_float+'</li>\\n' +\n                '                        <li data-value=\"date\">'+wptmContext.column_type_date+'</li>\\n' +\n                '                        <li data-value=\"datetime\">'+wptmContext.column_type_datetime+'</li>\\n' +\n                '                        <li data-value=\"text\">'+wptmContext.column_type_text+'</li>\\n' +\n                '                    </ul></td>';\n            column_type_html += '</tr>';\n            ii++;\n        });\n        $(html).appendTo($jform_default_sortable);\n        $jform_default_sortable.trigger(\"liszt:updated\");\n        $(html2).appendTo($jform_reponsive_table);\n        $jform_reponsive_table.trigger(\"liszt:updated\");\n        $(column_type_html).appendTo($jform_column_type_table);\n        $jform_column_type_table.trigger(\"liszt:updated\");\n    }\n}\n\n/*render data table, cells, rows, cols*/\nfunction cleanStyle(style, nbRows, nbCols) {\n    for (var col in style.cols) {\n        if (!style.cols[col] || style.cols[col][0] >= nbCols) {\n            delete style.cols[col];\n        }\n    }\n    for (var row in style.rows) {\n        if (!style.rows[row] || style.rows[row][0] >= nbRows) {\n            delete style.rows[row];\n        }\n    }\n    for (var cell in style.cells) {\n        if (style.cells[cell][0] >= nbRows || style.cells[cell][1] >= nbCols) {\n            delete style.cells[cell];\n        }\n    }\n    var propertiesPos, cells;\n    for (var obj in style) {\n        if (obj == 'table') {\n            continue;\n        }\n        for (cells in style[obj]) {\n            propertiesPos = style[obj][cells].length - 1;\n            for (var property in style[obj][cells][propertiesPos]) {\n                if (style[obj][cells][propertiesPos][property] === null) {\n                    delete style[obj][cells][propertiesPos][property];\n                }\n            }\n        }\n    }\n    return style;\n}\n\n/*change text table name, chart name*/\nfunction setText($name_edit, press_enter_selector, obj) {\n    unbindall();\n    /*select rename table*/\n    var oldTitle = $name_edit.text();\n    var wptm_name_edit = document.querySelector('.rename.wptm_name_edit');\n    $name_edit.attr('contentEditable', true).focus();\n\n    $name_edit.not('.editable').bind('click.mm', hstop);  //let's click on the editable object\n    jquery(press_enter_selector).bind('keydown.mm', enterKey); //let's press enter to validate new title'\n    jquery('*').not('.wptm_name_edit').bind('click.mm', houtside);\n\n    // $name_edit.addClass('editable');\n    if (obj.selected) {\n        $name_edit.trigger('click.mm');\n    }\n\n    function unbindall(reselectCell) {\n        $name_edit.not('.editable').unbind('click.mm', hstop);  //let's click on the editable object\n        jquery(press_enter_selector).unbind('keydown.mm', enterKey); //let's press enter to validate new title'\n        jquery('*').not('.wptm_name_edit').unbind('click.mm', houtside);\n        $name_edit.attr('contentEditable', false);\n\n        if (reselectCell && typeof table_function_data.selection[0][1] !== 'undefined') {//reselect cell after enter/esc name table\n            var selection = window.jquery(window.Wptm.container).handsontable('getSelected');\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        }\n    }\n\n    //Validation\n    function hstop(e) {\n        event.stopPropagation();\n        $name_edit.addClass('editable');\n        if (wptm_name_edit !== null) {\n            wptm_name_edit.focus();\n        }\n        return false;\n    }\n\n    function enterKey(e) {\n        e.stopImmediatePropagation();\n        if (e.which == 13) {\n            e.preventDefault();\n            $name_edit.removeClass('editable');\n            updateTitle($name_edit.text(), jquery);\n            unbindall(true);\n        }\n        if (e.which == 27) {\n            e.preventDefault();\n            $name_edit.text(oldTitle);\n            $name_edit.removeClass('editable');\n            unbindall(true);\n        }\n        $name_edit.removeClass('rename');\n    }\n\n    function houtside(e) {\n        if ($name_edit.hasClass('editable') && !$name_edit.hasClass('rename')) {\n            $name_edit.removeClass('editable');\n            updateTitle($name_edit.text(), jquery);\n            unbindall(true);\n            $name_edit.removeClass('rename');\n        }\n        return false;\n    }\n\n    function updateTitle(title, $) {\n        if (!(Wptm.can.edit || (Wptm.can.editown && data.author === Wptm.author))) {\n            return false;\n        }\n\n        if (oldTitle === title) {\n            return false;\n        }\n\n        if (title.trim() !== '' && typeof obj.url !== 'undefined') {\n            obj.url += title;\n            $.ajax({\n                url: obj.url,\n                type: \"POST\",\n                data: {},\n                dataType: \"json\",\n                beforeSend: function () {\n                    wptm_element.settingTable.find('.wptm_saving div').removeClass('wptm_hiden');\n                },\n                success: function (datas) {\n                    if (datas.response === true) {\n                        $name_edit.text(title);\n                        if ($('#pwrapper').hasClass('wptm_hiden')) {\n                            $('#list_chart').find('.chart-menu.active a').text(title);\n                        } else {\n                            $('#list_chart').find('.current_table a').text(title);\n                        }\n                        if (typeof obj.action !== 'undefined') {\n                            obj.action(title);\n                        }\n                        wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                        setTimeout(function () {\n                            wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n\n                            localStorage.setItem('wptm_change_table_name', JSON.stringify({'id': Wptm.id,'title': title, 'modified_time': datas.datas.modified_time}));\n                        }, 1500);\n                    } else {\n                        $name_edit.text(oldTitle);\n                        bootbox.alert(datas.response, wptmText.Ok);\n                    }\n                },\n                error: function (jqxhr, textStatus, error) {\n                    $name_edit.text(oldTitle);\n                    bootbox.alert(textStatus, wptmText.Ok);\n                }\n            });\n        } else {\n            $name_edit.text(oldTitle);\n            return false;\n        }\n        $name_edit.css('white-space', 'normal');\n        setTimeout(function () {\n            $name_edit.css('white-space', '');\n        }, 200);\n    }\n};\n\n//https://gist.github.com/ncr/399624\njQuery.fn.single_double_click = function (single_click_callback, double_click_callback, timeout) {\n    return this.each(function () {\n        var clicks = 0, self = this;\n        jQuery(this).click(function (event) {\n            clicks++;\n            if (clicks == 1) {\n                setTimeout(function () {\n                    if (clicks == 1) {\n                        single_click_callback.call(self, event);\n                    } else {\n                        double_click_callback.call(self, event);\n                    }\n                    clicks = 0;\n                }, timeout || 300);\n            }\n        });\n    });\n}\n//add, change style for column, rows, cells\nfunction getFillArray(selection, Wptm, value) {\n    var i, ij, ik;\n    if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n        for (i = 0; i < table_function_data.selectionSize; i++) {\n            for (ik = selection[i][1]; ik <= selection[i][3]; ik++) {\n                Wptm.style.cols = fillArray(Wptm.style.cols, value, ik);\n            }\n        }\n    } else {\n        for (i = 0; i < table_function_data.selectionSize; i++) {\n            for (ij = selection[i][0]; ij <= selection[i][2]; ij++) {\n                for (ik = selection[i][1]; ik <= selection[i][3]; ik++) {\n                    Wptm.style.cells = fillArray(Wptm.style.cells, value, ij, ik);\n                }\n            }\n        }\n    }\n\n    var action = Array.prototype.slice.call(arguments, 3);\n\n    var save_data = false;\n    if (action.length === 0) {\n        action = 'style';\n    } else {\n        if (action.length > 1) {\n            save_data = action[1];\n        }\n        if (action.length > 2) {\n            action[2].call();\n        }\n        action = action[0];\n    }\n\n    if (saveData.length > 0) {\n        var old_saveData = saveData[saveData.length - 1];\n        var checkRangeStyleExists = false;\n        if (action === old_saveData.action) {\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                if (old_saveData.selection[i][0] == selection[i][0] &&\n                    old_saveData.selection[i][1] == selection[i][1] &&\n                    old_saveData.selection[i][2] == selection[i][2] &&\n                    old_saveData.selection[i][3] == selection[i][3]) {\n                    checkRangeStyleExists = true;\n                }\n            }\n        }\n\n        if (checkRangeStyleExists) {\n            old_saveData.style = window.jquery.extend(old_saveData.style, value);\n        } else {\n            if (droptablesCheckSize(value) > 0) {\n                saveData.push({action: action, selection: selection, style: value});\n                if (save_data) {\n                    saveChanges(true);\n                }\n            }\n        }\n    } else {\n        if (droptablesCheckSize(value) > 0) {\n            saveData.push({action: action, selection: selection, style: value});\n            if (save_data) {\n                saveChanges(true);\n            }\n        }\n    }\n}\n\nfunction droptablesCheckSize (obj) {\n    var size = 0,\n        key;\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n    return size;\n};\n\nfunction removeValueInArray(array, parameters, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (val1) !== 'undefined') {\n            if (typeof (array[val1]) !== 'undefined') {\n                if (typeof array[val1][1][parameters] !== 'undefined') {\n                    delete array[val1][1][parameters];\n                }\n            } else {\n                array[val1] = [val1, {}];\n            }\n        } else {\n            delete array[parameters];\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            if (typeof array[val1 + \"!\" + val2][2][parameters] !== 'undefined') {\n                delete array[val1 + \"!\" + val2][2][parameters];\n            }\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n        }\n    }\n    return array;\n}\n\n//update new value for array\nfunction fillArray(array, val, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (val1) !== 'undefined') {\n            if (typeof (array[val1]) !== 'undefined') {\n                array[val1][1] = window.jquery.extend(array[val1][1], val);\n            } else {\n                array[val1] = [val1, {}];\n                array[val1][1] = val;\n            }\n        } else {\n            array = window.jquery.extend(array, val);\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            array[val1 + \"!\" + val2][2] = window.jquery.extend(array[val1 + \"!\" + val2][2], val);\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n            array[val1 + \"!\" + val2][2] = val;\n        }\n    }\n    return array;\n}\n\nfunction toggleArray(array, val, val1, val2) {\n    if (typeof (val2) === 'undefined') {\n        if (typeof (array[val1]) !== 'undefined') {\n            if (typeof (val) === 'object') {\n                for (var key in val) {\n                    if (typeof (array[val1][1][key] !== 'undefined')) {\n                        array[val1][1][key] = !array[val1][1][key];\n                    } else {\n                        array[val1][1][key] = val[key];\n                    }\n                }\n            } else {\n                array[val1][1] = jQuery.extend(array[val1][1], val);\n            }\n        } else {\n            array[val1] = [val1, {}];\n            array[val1][1] = val;\n        }\n    } else {\n        if (typeof (array[val1 + \"!\" + val2]) !== 'undefined') {\n            if (typeof (val) === 'object') {\n                for (var key in val) {\n                    if (typeof (array[val1 + \"!\" + val2][2][key] !== 'undefined')) {\n                        array[val1 + \"!\" + val2][2][key] = !array[val1 + \"!\" + val2][2][key];\n                    } else {\n                        array[val1 + \"!\" + val2][2][key] = val[key];\n                    }\n                }\n            } else {\n                array[val1 + \"!\" + val2][2] = jQuery.extend(array[val1 + \"!\" + val2][2], val);\n            }\n        } else {\n            array[val1 + \"!\" + val2] = [val1, val2, {}];\n            array[val1 + \"!\" + val2][2] = val;\n        }\n    }\n\n    return array;\n}\n\n//Code from http://stackoverflow.com/questions/9905533/convert-excel-column-alphabet-e-g-aa-to-number-e-g-25\nvar convertAlpha = function (val) {\n    var base = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', i, j, result = 0;\n\n    for (i = 0, j = val.length - 1; i < val.length; i += 1, j -= 1) {\n        result += Math.pow(base.length, j) * (base.indexOf(val[i]) + 1);\n    }\n\n    return result;\n};\n\nfunction wptm_clone(v) {\n    return JSON.parse(JSON.stringify(v));\n}\n\n//convert value of calculation by format selected\nfunction formatSymbols(resultCalc, decimal_count, thousand_symbols, decimal_symbols, symbol_position, value_unit) {\n    decimal_count = parseInt(decimal_count);\n    if (typeof resultCalc === 'undefined') {\n        return;\n    }\n    var negative = resultCalc < 0 ? \"-\" : \"\",\n        i = parseInt(resultCalc = Math.abs(+resultCalc || 0).toFixed(decimal_count), 10) + \"\",\n        j = (j = i.length) > 3 ? j % 3 : 0;\n\n    resultCalc = (j ? i.substr(0, j) + thousand_symbols : \"\") + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousand_symbols) + (decimal_count ? decimal_symbols + Math.abs(resultCalc - i).toFixed(decimal_count).slice(2) : \"\");\n\n    resultCalc = Number(symbol_position) === 0\n        ? ((negative === \"-\") ? negative + value_unit : value_unit) + resultCalc\n        : negative + resultCalc + ' ' + value_unit;\n\n    return resultCalc;\n};\n\n// Convert date in date_format to the format: m/d/Y /a/t g:i A\n// example: number -> array(2016,03,26)\nfunction convertDate(date_format, number, timezone) {\n    var date_array = [];\n    number = (!!number) ? number : [];\n    if (date_format.length !== number.length) {\n        return false;\n    }\n    if (typeof timezone === 'undefined') {\n        timezone = true;\n    }\n    for (var n = 0; n < date_format.length; n++) {\n        number[n] = (!!number[n]) ? number[n] : '';\n        if (date_format[n] === 'd' || date_format[n] === 'j') {\n            date_array[2] = (number[n] !== '') ? number[n] : '';\n        } else if (date_format[n] === 'S' || date_format[n] === 'jS' || date_format[n] === 'dS') {\n            date_array[2] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n] === 'm' || date_format[n] === 'n') {\n            date_array[1] = number[n];\n        } else if (date_format[n] === 'F') {\n            date_array[1] = F_name.indexOf(number[n].toLowerCase()) + 1;\n        } else if (date_format[n] === 'M') {\n            date_array[1] = M_name.indexOf(number[n].toLowerCase()) + 1;\n        } else if (date_format[n].toLowerCase() === 'y') {\n            date_array[3] = number[n];\n        } else if (date_format[n].toLowerCase() === 'g' || date_format[n].toLowerCase() === 'h') {\n            date_array[4] = Number(number[n]);\n        } else if (date_format[n].toLowerCase() === 'ga' || date_format[n].toLowerCase() === 'ha') {\n            date_array[4] = number[n].match(/[0-9]+/g);\n            date_array[4] = (number[n].toLowerCase().match(/[a-z]+/g) === 'am') ? date_array[4] : date_array[4] + 12;\n        } else if (date_format[n].toLowerCase() === 'a') {\n            date_array[7] = number[n];\n        } else if (date_format[n].toLowerCase() === 'i' || date_format[n].toLowerCase() === 'ia') {\n            date_array[5] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n].toLowerCase() === 's' || date_format[n].toLowerCase() === 'sa') {\n            date_array[6] = number[n].match(/[0-9]+/g);\n        } else if (date_format[n] === 'T') {\n            date_array[8] = number[n];\n        } else if (date_format[n] === 'r') {\n            if (M_name.indexOf(number[2].toLowerCase()) + 1 > 0) {\n                date_array[1] = M_name.indexOf(number[2].toLowerCase()) + 1;\n            } else {\n                date_array[1] = F_name.indexOf(number[2].toLowerCase()) + 1;\n            }\n            return date_array[1] + '/' + number[1] + '/' + number[3] + ' ' + number[4] + ':' + number[5] + ':' + number[6] + ' ' + number[7];\n        }\n    }\n    date_array[4] = (!!date_array[4]) ? date_array[4] : 0;\n    date_array[5] = (!!date_array[5]) ? date_array[5] : '00';\n    date_array[6] = (!!date_array[6]) ? date_array[6] : '00';\n    date_array[7] = (!!date_array[7]) ? ' ' + date_array[7] : '';\n    date_array[8] = (!!date_array[8]) ? ' ' + date_array[8] : '';\n    date_array[8] = (timezone === true) ? ' ' + date_array[8] : '';\n\n    if (date_array[7] !== 'undefined' && date_array[7] !== '' && date_array[4] > 12) {\n        date_array[4] = date_array[4] - 12;\n    }\n    if (date_array[1] === 0 || date_array[2] > 31 || date_array[1] > 12) {\n        return false;\n    }\n    return date_array[1] + '/' + date_array[2] + '/' + date_array[3] + ' ' + date_array[4] + ':' + date_array[5] + ':' + date_array[6] + date_array[7] + date_array[8];\n}\n//create string_currency_symbols, replace_unit, text_replace_unit, date_format RegExp string\nfunction createRegExpFormat(table_function_data, currency_symbol, date_formats) {\n    if (currency_symbol !== false) {\n        table_function_data.string_currency_symbols = currency_symbol.replace(/ /g, \"\");\n        // create string reg currency symbols\n        table_function_data.replace_unit = new RegExp('[' + table_function_data.string_currency_symbols.replace(/,/g, \"|\") + ']', \"g\");\n\n        // create string reg have not currency symbols\n        table_function_data.text_replace_unit = '[^a-zA-Z|' + table_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']';\n        table_function_data.text_replace_unit = new RegExp(table_function_data.text_replace_unit, \"g\");\n        table_function_data.text_replace_unit_function = new RegExp('[^ |' + table_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']', \"g\");\n    }\n    if (date_formats !== false) {\n        table_function_data.date_format = date_formats.match(/[a-zA-Z|\\\\]+/g);\n    }\n    return table_function_data;\n}\n\n// check column is int\nfunction replaceCell($, cellsData, currency_symbol) {\n    var data1 = [];\n    var i = 0;\n    var data2 = -1;\n    var v1 = '';\n    currency_symbol = new RegExp('[0-9|\\.|\\,|\\\\-|' + currency_symbol + ']', \"g\");\n\n    $.each(cellsData, function (k, v) {\n        v = v.toString();\n        v1 = v.replace(currency_symbol, '');\n        if (v1 === '') {\n            data1[i] = k;\n            i++;\n        } else if (v !== '') {\n            data2 = k;\n        }\n    });\n    var data = [];\n    data[1] = '';\n    data[0] = data1;\n    if (data2 !== -1) {\n        data[1] = data2;\n    }\n    return data;\n}\n//get size of cell selected when open change height, row popup\nfunction getSizeCells($, Wptm, cells) {\n    if (Wptm.type === 'mysql') {\n        updateParamFromStyleObject(Wptm.style.rows[0][1], 'height', $('#cell_row_height'), '30');\n    } else {\n        if (checkObjPropertyNested(Wptm.style.rows, cells[0], 1, 'height')) {\n            $('#cell_row_height').val(Wptm.style.rows[cells[0]][1].height);\n        }\n    }\n\n    if (checkObjPropertyNested(Wptm.style.cols, cells[1], 1, 'width')) {\n        $('#cell_col_width').val(Wptm.style.cols[cells[1]][1].width);\n    }\n    if (checkObjPropertyNested(Wptm.style.table, 'allRowHeight')) {\n        $('#all_cell_row_height').val(Wptm.style.table.allRowHeight);\n    }\n}\n\nfunction pullDims(Wptm, $) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var cols = [];\n    var rows = [];\n    var row, lengthRows, lengthCols, col;\n\n    // get count of Wptm.style.rows\n    if (typeof Wptm.style.rows.length !== 'undefined') {\n        lengthRows = Wptm.style.rows.length;\n    } else {\n        lengthRows = Object.keys(Wptm.style.rows).length;\n    }\n\n    for (row = 0; row < lengthRows; row++) {\n        if (checkObjPropertyNested(Wptm.style.rows[row], 1, 'height')) {\n            rows[row] = Wptm.style.rows[row][1].height;\n        } else if (Wptm.type === 'mysql' && typeof Wptm.style.table.allRowHeight !== 'undefined' && Wptm.style.table.allRowHeight !== '') {\n            rows[row] = Wptm.style.table.allRowHeight;\n        } else {\n            rows[row] = null;\n        }\n    }\n    // get count of Wptm.style.cols\n\n    if (typeof Wptm.style.cols.length !== 'undefined') {\n        lengthCols = Wptm.style.cols.length;\n    } else {\n        lengthCols = Object.keys(Wptm.style.cols).length;\n    }\n\n    for (col = 0; col < lengthCols; col++) {\n        if (checkObjPropertyNested(Wptm.style.cols[col], 1, 'width')) {\n            cols[col] = Wptm.style.cols[col][1].width;\n        } else {\n            cols[col] = null;\n        }\n    }\n    Wptm.updateSettings.manualColumnResize = $.extend([], cols);\n    Wptm.updateSettings.rowHeights = $.extend([], rows);\n\n    if (typeof args[1] === 'undefined' || args[1] === true) {\n        delete Wptm.updateSettings.manualColumnResize;\n        delete Wptm.updateSettings.manualRowResize;\n\n        Wptm.container.handsontable('updateSettings', {'manualColumnResize': cols});\n        Wptm.container.handsontable('updateSettings', {'manualRowResize': rows});\n    }\n}\n//add row height, col width for Wptm.style\nfunction pushDims($, Wptm) {\n    //get value height rows\n    var rows = $(Wptm.container).handsontable('countRows');\n    var i = 0;\n    var value = 0;\n    for (i = 0; i < rows; i++) {\n        value = $(Wptm.container).handsontable('getRowHeight', i);\n        if (Wptm.type === 'html') {\n            if (!value || value === 0) {\n                if (typeof (Wptm.style.rows[i]) !== 'undefined' && typeof (Wptm.style.rows[i][1].height) !== 'undefined') {\n                    value = parseInt(Wptm.style.rows[i][1].height);\n                }\n                if (value === null) {\n                    value = 22;\n                }\n            }\n        } else { //type mysql\n            if (checkObjPropertyNestedNotEmpty(Wptm.style.rows[i], 1, 'height')) { //Row height is set\n                value = parseInt(Wptm.style.rows[i][1].height);\n            } else {\n                value = null; //if aviation height is set then height === null\n            }\n        }\n\n        Wptm.style.rows = fillArray(Wptm.style.rows, {height: parseInt(value)}, i);\n        value = 0;\n    }\n    //get value width columns\n    var cols = $(Wptm.container).handsontable('countCols');\n    Wptm.max_Col = cols;\n    Wptm.max_row = rows;\n\n    Wptm.style.table.width = 0;\n    var valueCols = 0;\n    for (i = 0; i < cols; i++) {\n        valueCols = $('#tableContainer').handsontable('getColWidth', i);\n        if (!valueCols || valueCols === 0) {\n            if (typeof (Wptm.style.cols[i]) !== 'undefined' && Wptm.style.cols[i] !== null && (typeof (Wptm.style.cols[i][1].width) !== 'undefined')) {\n                valueCols = parseInt(Wptm.style.cols[i][1].width);\n            } else {\n                valueCols = null;\n            }\n        }\n        if (!valueCols || valueCols === 0) {\n            valueCols = 100;\n        }\n\n        Wptm.style.cols = fillArray(Wptm.style.cols, {width: parseInt(valueCols)}, i);\n\n        Wptm.style.table.width += parseInt(valueCols);\n        valueCols = 0;\n    }\n}\n//add res priority of columns to set resposive priority popup\nfunction responsive_col(Wptm) {\n    var col = this.val();\n    if (typeof (Wptm.style.cols) !== 'undefined' && typeof (Wptm.style.cols[col]) !== 'undefined' && typeof (Wptm.style.cols[col][1]) !== 'undefined' && typeof (Wptm.style.cols[col][1].res_priority) !== 'undefined') {\n        var res_priority = Wptm.style.cols[col][1].res_priority;\n\n        this.siblings('#responsive_priority').val(res_priority);\n    } else {\n\n        this.siblings('#responsive_priority').val(0);\n    }\n    this.siblings('#responsive_priority').trigger('liszt:updated');\n}\n\nfunction loading(e) {\n    e.addClass('dploadingcontainer');\n    e.append('<div class=\"dploading\"></div>');\n}\n\nfunction rloading(e) {\n    e.removeClass('dploadingcontainer');\n    e.find('div.dploading').remove();\n}\n//add custom css for element\nfunction parseCss($) {\n    var parser = new (less.Parser);\n    var content = '#mainTabContent .handsontable .ht_master .wtHider .wtSpreader .htCore tbody {' + $('#jform_css').val() + '}';\n    content += '.reset {background-color: rgb(238, 238, 238);border-bottom-color: rgb(204, 204, 204);border-bottom-style: solid;border-bottom-width: 1px;border-collapse: collapse;border-left-color: rgb(204, 204, 204);border-left-style: solid;border-left-width: 1px;border-right-color: rgb(204, 204, 204);border-right-style: solid;border-right-width: 1px;border-top-color: rgb(204, 204, 204);border-top-style: solid;border-top-width: 1px;box-sizing: content-box;color: rgb(34, 34, 34);display: table-cell;empty-cells: show;font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;font-size: 13px;font-weight: normal;line-height: 21px;outline-width: 0px;overflow-x: hidden;overflow-y: hidden;padding-bottom: 0px;padding-left: 4px;padding-right: 4px;padding-top: 0px;text-align: center;vertical-align: top;white-space: nowrap;position: relative;}';\n    content += '#mainTabContent .handsontable .ht_master .wtHider .wtSpreader .htCore tbody tr th {.reset() !important;}'\n    parser.parse(content, function (err, tree) {\n        if (err) {\n            //Here we can throw the erro to the user\n            return false;\n        } else {\n            Wptm.css = $('#jform_css').val();\n            if ($('#headCss').length === 0) {\n                $('head').append('<style id=\"headCss\"></style>');\n            }\n            $('#headCss').text(tree.toCSS());\n            return true;\n        }\n    });\n}\n\nfunction getCellData(cellPos) {\n    var pos = cellPos.split(\":\");\n    var value = Wptm.container.handsontable('getDataAtCell', parseInt(pos[0]), parseInt(pos[1]));\n\n    return value;\n}\n//replace string by decimal_symbol value and thousand_symbol value in calculation cell\nfunction stringReplace(arr, unit) {\n    var thousand_symbol = (!Wptm.style.table.thousand_symbol) ? default_value.thousand_symbol : Wptm.style.table.thousand_symbol;\n    var decimal_symbol = (!Wptm.style.table.decimal_symbol) ? default_value.decimal_symbol : Wptm.style.table.decimal_symbol;\n    if (typeof arr === 'number') {\n        return arr;\n    }\n    var thousand_re = new RegExp('[' + thousand_symbol + ']', \"g\");\n    // var thousand_re = new RegExp(thousand_symbol,\"g\");\n    if (typeof arr !== 'undefined' && arr !== '' && arr !== null) {\n        if (unit === true) {\n            if (typeof arr !== 'string') {\n                arr = arr.toString();\n            }\n            arr = arr.replace(table_function_data.text_replace_unit, \"\");\n        } else {\n            arr = arr.replace(table_function_data.replace_unit, \"\");\n            arr = arr.replace(thousand_re, \"\");\n            // arr = (thousand_symbol === ',') ? arr.replace(/,/g, \"\") : (thousand_symbol === '.' ? arr.replace(/\\./g, \"\") : arr);\n            arr = (decimal_symbol === ',') ? arr.replace(/,/g, \".\") : arr;\n        }\n    } else {\n        arr = '';\n    }\n    return arr;\n}\n//Toggle between the charts and the table\nfunction showChartOrTable(showChart, $chart) {\n    if (showChart) {//show chart\n        jquery('#wptm_chart').removeClass('wptm_hiden');\n        jquery('#pwrapper').addClass('wptm_hiden');\n        $chart.trigger('click');\n        jquery('#list_chart').find('.current_table').unbind('click').on('click', showChartOrTable.bind(this, false));\n    } else {//show table\n        if (jquery('#inserttable').length > 0) {\n            Wptm.chart_active = 0;\n            if (!jquery('#inserttable').hasClass('not_change_type')) {\n                jquery('#inserttable').data('type', 'table').attr('data-type', 'table').text(insert_table);\n            }\n            jquery('#inserttable').removeClass(\"no_click\");\n        }\n        jquery('#wptm_chart').addClass('wptm_hiden');\n        jquery('#pwrapper').removeClass('wptm_hiden');\n        Wptm.container.handsontable('render');\n    }\n    jquery('#over_loadding_open_chart').hide();\n    wptm_element.primary_toolbars.find('.menu_loading').closest('li').removeClass('menu_loading');\n    wptm_element.settingTable.find('.ajax_loading').removeClass('loadding').addClass('wptm_hiden');\n}\n\nfunction ripple_button(that) {\n    that.find(\".wptm_ripple\").click(function (e) {\n        // Remove any old one\n        jquery(\".ripple\").remove();\n\n        // Setup\n        var posX = jquery(this).offset().left,\n            posY = jquery(this).offset().top,\n            buttonWidth = jquery(this).width(),\n            buttonHeight = jquery(this).height();\n\n        // Add the element\n        jquery(this).prepend(\"<span class='ripple'></span>\");\n\n        // Make it round!\n        if (buttonWidth >= buttonHeight) {\n            buttonHeight = buttonWidth;\n        } else {\n            buttonWidth = buttonHeight;\n        }\n\n        // Get the center of the element\n        var x = e.pageX - posX - buttonWidth / 2;\n        var y = e.pageY - posY - buttonHeight / 2;\n\n        // Add the ripples CSS and start the animation\n        jquery(\".ripple\").css({\n            width: buttonWidth,\n            height: buttonHeight,\n            top: y + 'px',\n            left: x + 'px'\n        }).addClass(\"rippleEffect\");\n    });\n}\n\nfunction isSameArray(array1, array2) {\n    return array1.length === array2.length && array1.every(function (element, index) {\n        return element === array2[index];\n    });\n}\n//mer rows, columns style to cells style\nfunction mergeCollsRowsstyleToCells() {\n    var style = jquery.extend({}, window.Wptm.style);\n    jquery.each(style.cols, function (col, cValue) {\n        jquery.each(style.rows, function (row, rValue) {\n            var styleCell = {};\n            if (typeof (window.Wptm.style.cells[row + '!' + col]) === 'undefined') {\n                window.Wptm.style.cells[row + '!' + col] = [row, col, {}];\n            }\n            if (typeof (style.rows[row]) !== 'undefined' && style.rows[row] !== null && Object.keys(style.rows[row][1]).length !== 0) {\n                styleCell =  jquery.extend({}, styleCell, rValue[1]);\n            }\n            if (typeof (style.cols[col]) !== 'undefined' && style.cols[col] !== null && Object.keys(style.cols[col][1]).length !== 0) {\n                styleCell =  jquery.extend({}, styleCell, cValue[1]);\n            }\n            window.Wptm.style.cells[row + '!' + col][2] = jquery.extend({}, styleCell, window.Wptm.style.cells[row + '!' + col][2]);\n        });\n    });\n}\n\nfunction setFormat_accounting() {\n    var data = {};\n    data.thousand_symbol = Wptm.style.table.thousand_symbol;\n    data.symbol_position = Wptm.style.table.symbol_position;\n    data.decimal_symbol = Wptm.style.table.decimal_symbol;\n    data.decimal_count = Wptm.style.table.decimal_count;\n    data.currency_symbol = Wptm.style.table.currency_symbol;\n\n    accounting.settings = {\n        currency: {\n            symbol : data.currency_symbol,   // default currency symbol is '$'\n            format: data.symbol_position == 1 ? \"%v %s\" : \"%s %v\", // controls output: %s = symbol, %v = value/number (can be object: see below)\n            decimal : data.decimal_symbol,  // decimal point separator\n            thousand: data.thousand_symbol,  // thousands separator\n            precision : data.decimal_count   // decimal places\n        },\n        number: {\n            decimal : data.decimal_symbol,  // decimal point separator\n            thousand: data.thousand_symbol,  // thousands separator\n            precision : data.decimal_count   // decimal places\n        }\n    };\n}\n\nfunction updateStyleAutofill (start_rangess, new_range, direction) {\n    var respectively = [], data_respectively;\n    var maxRange = [start_rangess[2] - start_rangess[0] + 1, start_rangess[3] - start_rangess[1] + 1];\n\n    for (var i = new_range[0]; i <= new_range[2]; i++) {//rows\n        for (var j = new_range[1]; j <= new_range[3]; j++) {//cols\n            respectively[0] = i - new_range[0] > maxRange[0]\n                ? ((i - new_range[0]) % maxRange[0]) + start_rangess[0]\n                : i - new_range[0] + start_rangess[0];\n            respectively[1] = j - new_range[1] > maxRange[1]\n                ? ((j - new_range[1]) % maxRange[1]) + start_rangess[1]\n                : j - new_range[1] + start_rangess[1];\n            //update cell hyperlink\n            if (typeof Wptm.hyperlink[i + '!' + j] !== 'undefined') {\n                delete Wptm.hyperlink[i + '!' + j];\n            }\n            if (typeof Wptm.hyperlink[respectively[0] + '!' + respectively[1]] !== 'undefined') {\n                data_respectively = Wptm.hyperlink[respectively[0] + '!' + respectively[1]];\n                Wptm.hyperlink[i + '!' + j] = {};\n                Wptm.hyperlink[i + '!' + j].hyperlink = data_respectively.hyperlink;\n                Wptm.hyperlink[i + '!' + j].text = data_respectively.text;\n            }\n\n            //update cell type and col type\n            var selection = {'0': [i,j,i,j]};\n            if (typeof Wptm.style.cells[i + '!' + j] !== 'undefined'\n                && Wptm.style.cells[i + '!' + j][2].cell_type === 'html') {\n                Wptm.style.cells[i + '!' + j][2].cell_type = null;\n                saveData.push({action: 'set_cells_type', selection: selection, style: {cell_type: null}});\n            } else if (typeof Wptm.style.cells[i + '!' + j] === 'undefined' || typeof Wptm.style.cells[i + '!' + j][2] === 'undefined') {\n                Wptm.style.cells[i + '!' + j] = [i, j, {}];\n            }\n\n            if (typeof Wptm.style.cells[respectively[0] + '!' + respectively[1]] !== 'undefined'\n                && Wptm.style.cells[respectively[0] + '!' + respectively[1]][2].cell_type === 'html') {\n                Wptm.style.cells[i + '!' + j][2].cell_type = 'html';\n                saveData.push({action: 'set_cells_type', selection: selection, style: {cell_type: 'html'}});\n\n                if (typeof Wptm.style.table.col_types !== 'undefined'\n                    && Wptm.style.table.col_types[j] !== 'text') {\n                    Wptm.style.table.col_types[j] = 'text';\n                    if (typeof table_function_data.colsSetType === 'undefined') {\n                        table_function_data.colsSetType = {};\n                    }\n                    table_function_data.colsSetType[j] = 'text';\n                }\n            }\n        }\n    }\n}\n\nfunction setPositionForHtmlCellEditor () {\n    var tdOffset = jquery(window.Wptm.container).find('.isHtmlCell.dtr' + table_function_data.selection[0][0] + '.dtc' + table_function_data.selection[0][1]).offset();\n    var offsetTable = wptm_element.tableContainer.offset();\n    var heightTable = wptm_element.tableContainer.outerHeight() + offsetTable.top;\n    var widthTable = wptm_element.tableContainer.outerWidth() + offsetTable.left;\n\n    var wptm_edit_html_cell_width =  wptm_element.wptm_edit_html_cell.outerWidth();\n    var wptm_edit_html_cell_height =  wptm_element.wptm_edit_html_cell.outerHeight();\n\n    if (wptm_edit_html_cell_width + tdOffset.left > widthTable) {\n        tdOffset.left = widthTable - wptm_edit_html_cell_width - 30;\n    }\n    if (350 + tdOffset.top > heightTable) {\n        tdOffset.top = heightTable - 350;\n    }\n\n    return tdOffset;\n}\n\nfunction hashFnv32a () {\n    return Math.random().toString(36).substr(2) + Math.random().toString(36).substr(2);\n}\n\nfunction copy_text (that, default_value) {\n    var copyText = jquery(that).parent().find('.wptm_copy_text_content');\n    var textArea = document.createElement(\"textarea\");\n    if (copyText.text() === '') {\n        textArea.value = default_value;\n    } else {\n        textArea.value = copyText.text();\n    }\n    document.body.appendChild(textArea);\n    textArea.select();\n    document.execCommand(\"Copy\");\n    textArea.remove();\n}\n\nfunction getLinkSync (link, type, warningDisplay) {\n    var data = {};\n    switch (type) {\n        case 'excel':\n            if (link.indexOf(\"docs.google.com/spreadsheet\") !== -1 && warningDisplay) {\n                bootbox.alert(wptmText.error_link_import_sync, wptmText.GOT_IT);\n                Wptm.style.table.excel_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.excel_auto_sync != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.excel_spreadsheet_style != '1' ? 0 : 1;\n            data.url = encodeURI(link);\n\n            break;\n        case 'onedrive':\n            if (link.indexOf(\"sharepoint\") === -1 && link.indexOf(\"onedrive.live.com\") === -1 && warningDisplay) {\n                bootbox.alert(wptmText.error_link_import_sync, wptmText.GOT_IT);\n                Wptm.style.table.onedrive_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.auto_sync_onedrive != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.onedrive_style != '1' ? 0 : 1;\n\n            if (link.indexOf(\"onedrive.live.com\") !== -1 && link.indexOf(\"download?\") === -1) {\n                if (link.indexOf(\"<iframe\") !== -1) {\n                    link = link.match(/src=\"(.*?)\"/)[1];\n                }\n                link = link.replace(\"embed?\", \"download?\");\n            } else if (link.indexOf(\"sharepoint\") !== -1 && link.indexOf(\"download=\") === -1) {\n                link += '&download=1';\n            }\n            data.url = link;\n\n            break;\n        case 'spreadsheet':\n            var end_link = link.split('?');\n            var end_link0 = end_link[0].slice(-7);\n            if (link.indexOf(\"docs.google.com/spreadsheet\") === -1 && end_link0.match(/html|csv|pdf|xlsx/gi) === null && (typeof end_link[1] !== \"undefined\" && end_link[1].match(/sharing|html|csv|pdf|xlsx/gi) === null) && warningDisplay) {\n                bootbox.alert(wptmText.error_link_google_sync, wptmText.GOT_IT);\n                Wptm.style.table.spreadsheet_url = '';\n                return false;\n            }\n            data.auto_sync = Wptm.style.table.auto_sync != '1' ? 0 : 1;\n            data.spreadsheet_style = Wptm.style.table.spreadsheet_style != '1' ? 0 : 1;\n            data.url = encodeURI(link);\n            break;\n    }\n\n    return data;\n}\n\n//convert droptables's dateformat to momentjs's dateformat\nfunction momentjsFormat(value) {\n    value = value.replaceAll(\"M\", \"MMM\");\n    value = value.replaceAll(\"F\", \"MMMM\");\n    value = value.replaceAll(\"m\", \"MM\");\n    value = value.replaceAll(\"n\", \"M\");\n\n    value = value.replaceAll(\"D\", \"ddd\");\n    value = value.replaceAll(\"j\", \"D\");\n    value = value.replaceAll(\"d\", \"DD\");\n    value = value.replaceAll(\"S\", \"Do\");\n    value = value.replaceAll(\"l\", \"dddd\");\n\n    value = value.replaceAll(\"y\", \"YY\");\n\n    value = value.replaceAll(\"h\", \"hh\");\n    value = value.replaceAll(\"g\", \"h\");\n    value = value.replaceAll(\"H\", \"HH\");\n    value = value.replaceAll(\"G\", \"H\");\n\n    value = value.replaceAll(\"i\", \"mm\");\n    value = value.replaceAll(\"s\", \"ss\");\n    value = value.replaceAll(\"T\", \"z\");\n    return value;\n}\n\nfunction checkCellsOptionsValidate(selection, parametor, value) {\n    var i, j;\n    if (typeof arguments[3] !== 'undefined') {\n        j = arguments[3];\n        for (i = 0; i < j.length; i++) {\n            if (typeof j[i][parametor] !== 'undefined' && j[i][parametor] == value) {\n                return true;\n            }\n        }\n    } else if (selection.length > 0) {\n        for (i = selection[0][0]; i <= selection[0][2]; i++) {\n            for (j = selection[0][1]; j <= selection[0][3]; j++) {\n                if (typeof Wptm.style.cells[i + '!' + j] !== 'undefined' && typeof Wptm.style.cells[i + '!' + j][2] !== 'undefined'){\n                    if (typeof Wptm.style.cells[i + '!' + j][2][parametor] !== 'undefined' && Wptm.style.cells[i + '!' + j][2][parametor] == value) {\n                        return true;\n                    }\n                }\n            }\n        }\n    }\n    return false;\n}\n\nfunction setFormat_accounting_for_cells(setFormat_accounting_for_cells_raw) {\n    return {\n        currency: {\n            symbol : setFormat_accounting_for_cells_raw.currency_symbol,   // default currency symbol is '$'\n            format: setFormat_accounting_for_cells_raw.symbol_position == 1 ? \"%v%s\" : \"%s%v\", // controls output: %s = symbol, %v = value/number (can be object: see below)\n            decimal : setFormat_accounting_for_cells_raw.decimal_symbol,  // decimal point separator\n            thousand: setFormat_accounting_for_cells_raw.thousand_symbol,  // thousands separator\n            precision : typeof setFormat_accounting_for_cells_raw.decimal_count !== 'undefined' ? setFormat_accounting_for_cells_raw.decimal_count : 0   // decimal places\n        },\n        number: {\n            decimal : setFormat_accounting_for_cells_raw.decimal_symbol,  // decimal point separator\n            thousand: setFormat_accounting_for_cells_raw.thousand_symbol,  // thousands separator\n            precision : typeof setFormat_accounting_for_cells_raw.decimal_count !== 'undefined' ? setFormat_accounting_for_cells_raw.decimal_count : 0   // decimal places\n        }\n    };\n}\n\n//create string_currency_symbols, replace_unit, text_replace_unit, date_format RegExp string\nfunction createRegExpFormatForCell(currency_symbol, date_formats, cell_function_data) {\n    if (currency_symbol !== false) {\n        cell_function_data.string_currency_symbols = currency_symbol.replace(/ /g, \"\");\n        // create string reg currency symbols\n        cell_function_data.replace_unit = new RegExp('[' + cell_function_data.string_currency_symbols.replace(/,/g, \"|\") + ']', \"g\");\n\n        // create string reg have not currency symbols\n        cell_function_data.text_replace_unit = '[^a-zA-Z|' + cell_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']';\n        cell_function_data.text_replace_unit = new RegExp(cell_function_data.text_replace_unit, \"g\");\n        cell_function_data.text_replace_unit_function = new RegExp('[^ |' + cell_function_data.string_currency_symbols.replace(/,/g, \"|^\") + ']', \"g\");\n    }\n    if (date_formats !== false) {\n        cell_function_data.date_format = date_formats.match(/[a-zA-Z|\\\\]+/g);\n    }\n    return cell_function_data;\n}\n\nfunction status_notic (status, text) {\n    var $ = window.jquery;\n    var status_e = $('#savedInfoTable');\n    if (status === 1) {\n        status_e = $('#savedInfoTable');\n    } else {\n        status_e = $('#saveErrorTable');\n    }\n\n    var args = Array.prototype.slice.call(arguments, 1);\n    if (typeof args[1] !== \"undefined\") {\n        status_e = args[1];\n    }\n\n    status_e.html(text);\n    var position = window.jquery('#setting-cells').offset();\n    setTimeout(function () {\n        status_e.animate({'opacity': '0.8', 'top': position.top - 35}, 500).delay(2000).animate({'opacity': '0', 'top': '-45px'}, 1000);\n    }, 1000);\n}\n\nfunction check_cell_readOnly_mysql(row, col, cellProperties) {\n    if (row < 1) {\n        cellProperties.readOnly = false;\n        if (typeof Wptm.style.table.lock_columns !== 'undefined' && Wptm.style.table.lock_columns[col] != 0) {\n            cellProperties.readOnly = true;\n        }\n    }\n    if (Wptm.table_editing != '1' && row >= 1) {\n        cellProperties.readOnly = true;\n    }\n    return cellProperties;\n}\n\nfunction check_cell_readOnly(row, col, prop) {\n    var cellProperties = {};\n\n    if (window.Wptm.type === 'mysql') {\n        cellProperties = check_cell_readOnly_mysql(row, col, cellProperties);\n    }\n\n    if (!wptm_administrator) {\n        var lock_cell_id = [], not_lock_cell = false;\n        if (typeof table_function_data.protect_columns !== 'undefined'\n            && typeof table_function_data.protect_columns[col] !== 'undefined') {\n            //protect columns\n            lock_cell_id.push(table_function_data.protect_columns[col]);\n        }\n        if (typeof table_function_data.protect_rows !== 'undefined'\n            && typeof table_function_data.protect_rows[col] !== 'undefined') {\n            //protect rows\n            lock_cell_id.push(table_function_data.protect_rows[row]);\n        }\n        if (typeof Wptm.style.cells[row + \"!\" + col][2].lock_cell !== 'undefined') {\n            lock_cell_id.push(Wptm.style.cells[row + \"!\" + col][2].lock_cell);\n        }\n        if (lock_cell_id.length > 0 && typeof lock_cell_id[0] !== 'undefined'\n            && typeof table_function_data.lock_ranger_cells_user !== 'undefined') {\n            for (var ij in lock_cell_id) {\n                if (table_function_data.lock_ranger_cells_user[lock_cell_id[ij]]) {//allow edit\n                    not_lock_cell = true;\n                    break;\n                }\n            }\n            if (!not_lock_cell) {\n                cellProperties.readOnly = true;\n            }\n        }\n    }\n\n    return cellProperties;\n}\n\nfunction create_ranger_cells_lock (Wptm, table_function_data, update_rangers) {\n    var lock_ranger_cells_user;\n    // table_function_data.ranger_cells_lock_top = '';\n    // table_function_data.ranger_cells_lock_left = '';\n    // table_function_data.ranger_cells_lock_right = '';\n    // table_function_data.ranger_cells_lock_bottom = '';\n    table_function_data.lock_ranger_cells_user = [];\n    table_function_data.protect_columns = [];\n    table_function_data.protect_rows = [];\n    // table_function_data.render_first_cell_protect_has_icon = [];\n\n    if (typeof Wptm.style.table.lock_ranger_cells_user == 'undefined') {\n        Wptm.style.table.lock_ranger_cells_user = [];\n    }\n\n    var ij, enable_lock, value;\n    if (typeof Wptm.style.table.lock_ranger_cells === 'undefined' || Wptm.style.table.lock_ranger_cells.length < 1) {\n        return false;\n    }\n\n    if (update_rangers !== null) {\n        var current_rangers = [];\n        var current_ranger_cells_user = [];\n    }\n\n    var i;\n\n    for (i = 0; i < Wptm.style.table.lock_ranger_cells.length; i++) {\n        // table_function_data.render_first_cell_protect_has_icon[i] = true;\n        enable_lock = false;\n        table_function_data.lock_ranger_cells_user[i] = false;\n        if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n            lock_ranger_cells_user = Wptm.style.table.lock_ranger_cells_user[i].split('|');\n            if (lock_ranger_cells_user.indexOf(wptm_userRoles) !== -1) {//ok edit\n                table_function_data.lock_ranger_cells_user[i] = true;\n            } else if (!wptm_administrator) {\n                enable_lock = true;\n            }\n        }\n\n        value = Wptm.style.table.lock_ranger_cells[i].replace(/[ ]+/g, \"\").toUpperCase();\n        var arrayRange = value.split(\":\");\n\n        var check_value = 0;\n        if (arrayRange[0].replace(/[ |A-Za-z]+/g, \"\") === '') {\n            check_value = 1;//value A:B\n        } else if (arrayRange[0].replace(/[ |1-9]+/g, \"\") === '') {\n            check_value = 2;//value 8:9\n        }\n\n        var selection = [];\n        if (check_value === 0) {\n            if (typeof arrayRange[1] == 'undefined') {\n                arrayRange[1] = arrayRange[0];\n            }\n            selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[1]) - 1);\n            selection.push(convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n            selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[1]) - 1);\n            selection.push(convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'create_row') {\n                    if (selection[0] >= update_rangers.index) {//rows >= index\n                        if (selection[2] >= update_rangers.amount + update_rangers.index) {//index + amount <= after_col\n                            selection[2] = selection[2] + update_rangers.amount;\n                            selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                        } else {//index + amount > after_col\n                            selection[2] = selection[2] + update_rangers.amount;\n                        }\n                    } else if (selection[0] < update_rangers.index && selection[2] >= update_rangers.index) {//row < index < after_row\n                        selection[2] = selection[2] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_row') {\n                    if (selection[0] >= update_rangers.index) {//rows >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[2]) {//remove all index + amount >= after_rows\n                            continue;\n                        }\n                        if ((update_rangers.amount + update_rangers.index) >= selection[0]\n                            && (update_rangers.amount + update_rangers.index) < selection[2]) {//index <= rows <= index + amount < after_rows\n                            selection[0] = update_rangers.index;\n                            selection[2] = selection[2] - update_rangers.amount;\n                        } else {//index + amount < rows\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[2] = selection[2] - update_rangers.amount;\n                        }\n                    } else if (selection[0] < update_rangers.index && selection[2] >= update_rangers.index) {//rows < index < after_rows\n                        selection[2] = update_rangers.amount + update_rangers.index >= selection[2] ? (update_rangers.index - 1) : (selection[2] - update_rangers.amount);\n                    }\n                }\n                if (update_rangers.type === 'add_col') {\n                    if (selection[1] > update_rangers.index) {//col >= index\n                        if (selection[3] >= update_rangers.amount + update_rangers.index) {//index + amount <= after_col\n                            selection[3] = selection[3] + update_rangers.amount;\n                            selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? selection[1] : (selection[1] + update_rangers.amount);\n                        } else {//index + amount > after_col\n                            selection[3] = selection[3] + update_rangers.amount;\n                        }\n                    } else if (selection[1] < update_rangers.index && selection[3] >= update_rangers.index) {//row < index < after_row\n                        selection[3] = selection[3] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_col') {\n                    if (selection[1] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[3]) {//remove all index + amount >= after_col\n                            continue;\n                        }\n                        if ((update_rangers.amount + update_rangers.index) >= selection[1]\n                            && (update_rangers.amount + update_rangers.index) < selection[3]) {//index <= col <= index + amount < after_col\n                            selection[1] = update_rangers.index;\n                            selection[3] = selection[3] - update_rangers.amount;\n                        } else {//index + amount < col\n                            selection[1] = selection[1] - update_rangers.amount;\n                            selection[3] = selection[3] - update_rangers.amount;\n                        }\n                    } else if (selection[1] < update_rangers.index && selection[3] >= update_rangers.index) {//col < index < after_col\n                        selection[3] = update_rangers.amount + update_rangers.index >= selection[3] ? (update_rangers.index - 1) : (selection[3] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal(selection));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[2]; ij++) {//row\n                for (var ij2 = selection[1]; ij2 <= selection[3]; ij2++) {\n                    if (typeof Wptm.style.cells[ij + '!' + ij2] !== 'undefined') {\n                        Wptm.style.cells[ij + '!' + ij2][2] = window.jquery.extend(Wptm.style.cells[ij + '!' + ij2][2], {lock_cell: i});\n                    }\n                }\n            }\n        } else if (check_value === 1) {//columns\n            selection.push(convertStringToNumber(arrayRange[0].split(/[ |1-9]+/g)[0]) - 1);\n            selection.push(convertStringToNumber(arrayRange[1].split(/[ |1-9]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'add_col') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        selection[1] = selection[1] + update_rangers.amount;\n                        selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//row < index < after_row\n                        selection[1] = selection[1] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_col') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[1]) {//remove all\n                            continue;\n                        }\n                        if (update_rangers.amount + update_rangers.index < selection[0]) {\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[1] = selection[1] - update_rangers.amount;\n                        } else {\n                            selection[0] = update_rangers.index;\n                            selection[1] = selection[1] - update_rangers.amount - update_rangers.index;\n                        }\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//col < index < after_col\n                        selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? (update_rangers.index - 1) : (selection[1] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal([false, selection[0], false, selection[1]]));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[1]; ij++) {\n                table_function_data.protect_columns[ij] = i;\n            }\n        } else {//rows\n            selection.push(parseInt(arrayRange[0].split(/[ |A-Za-z]+/g)[0]) - 1);\n            selection.push(parseInt(arrayRange[1].split(/[ |A-Za-z]+/g)[0]) - 1);\n\n            if (update_rangers !== null) {\n                if (update_rangers.type === 'create_row') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        selection[1] = selection[1] + update_rangers.amount;\n                        selection[0] = update_rangers.amount + update_rangers.index >= selection[0] ? selection[0] : (selection[0] + update_rangers.amount);\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//row < index < after_row\n                        selection[1] = selection[1] + update_rangers.amount;\n                    }\n                }\n                if (update_rangers.type === 'delete_row') {\n                    if (selection[0] >= update_rangers.index) {//col >= index\n                        if (update_rangers.amount + update_rangers.index >= selection[1]) {//remove all\n                            continue;\n                        }\n                        if (update_rangers.amount + update_rangers.index < selection[0]) {\n                            selection[0] = selection[0] - update_rangers.amount;\n                            selection[1] = selection[1] - update_rangers.amount;\n                        } else {\n                            selection[0] = update_rangers.index;\n                            selection[1] = selection[1] - update_rangers.amount - update_rangers.index;\n                        }\n                    }\n                    if (selection[0] < update_rangers.index && selection[1] >= update_rangers.index) {//col < index < after_col\n                        selection[1] = update_rangers.amount + update_rangers.index >= selection[1] ? (update_rangers.index - 1) : (selection[1] - update_rangers.amount);\n                    }\n                }\n\n                current_rangers.push(getSelectedVal([selection[0], false, selection[1], false]));\n                if (typeof Wptm.style.table.lock_ranger_cells_user[i] !== 'undefined') {\n                    current_ranger_cells_user.push(Wptm.style.table.lock_ranger_cells_user[i]);\n                }\n            }\n\n            for (ij = selection[0]; ij <= selection[1]; ij++) {\n                table_function_data.protect_rows[ij] = i;\n            }\n        }\n    };\n\n    if (update_rangers !== null) {\n        Wptm.style.table.lock_ranger_cells = jquery.extend([], current_rangers);\n        Wptm.style.table.lock_ranger_cells_user = jquery.extend([], current_ranger_cells_user);\n        // render_css_lock(Wptm, table_function_data);\n    }\n}\n\nfunction render_css_lock(Wptm, table_function_data) {\n    var column_i;\n    var css_lock_columns = '';\n    var $wptm_add_css_lock_columns = document.getElementById('wptm_add_css_lock_columns');\n\n    // if (typeof table_function_data.ranger_cells_lock_top !== 'undefined' && table_function_data.ranger_cells_lock_top !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_top + '{border-top: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_bottom !== 'undefined' && table_function_data.ranger_cells_lock_bottom !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_bottom + '{border-bottom: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_left !== 'undefined' && table_function_data.ranger_cells_lock_left !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_left + '{border-left: 1px solid #4b89ff !important;}'\n    // }\n    // if (typeof table_function_data.ranger_cells_lock_right !== 'undefined' && table_function_data.ranger_cells_lock_right !== '') {\n    //     css_lock_columns += table_function_data.ranger_cells_lock_right + '{border-right: 1px solid #4b89ff !important;}'\n    // }\n\n    if (typeof Wptm.style.table.lock_columns !== 'undefined') {\n        for (column_i in Wptm.style.table.lock_columns) {\n            if (Wptm.style.table.lock_columns[column_i] != 0) {\n                column_i = parseInt(column_i);\n                css_lock_columns += ' .handsontable table thead th:nth-child(' + (column_i + 2) + ') {position: relative;} ';\n                css_lock_columns += ' .handsontable table thead th:nth-child(' + (column_i + 2) + '):after {content: \"lock\";} ';\n            }\n        }\n    }\n\n\n    setTimeout(function () {\n        if (css_lock_columns !== '') {\n            $wptm_add_css_lock_columns.innerHTML = css_lock_columns;\n            $wptm_add_css_lock_columns.cssText = css_lock_columns;\n        }\n    }, 100);\n}\n\nfunction check_collide_two_range(selection1, selection2) {\n    if ((Math.abs(selection1[0] - selection2[0]) < Math.abs(selection1[2] - selection1[0] + selection2[2] - selection2[0]) / 2)\n        && (Math.abs(selection1[1] - selection2[1]) < Math.abs(selection1[3] - selection1[1] + selection2[3] - selection2[1]) / 2)\n    ) {\n        return true;\n    }\n    return false;\n}\n\nexport default {\n    setText,\n    updateSwitchButtonFromStyleObject,\n    updateParamFromStyleObject,\n    updateParamFromStyleObjectSelectBox,\n    checkObjPropertyNested,\n    calculateTableHeight,\n    convertStringToNumber,\n    getSelectedVal,\n    checkObjPropertyNestedNotEmpty,\n    autosaveNotification,\n    cleanHandsontable,\n    warning_edit_db_table,\n    saveChanges,\n    cell_type_to_column,\n    deleteRowDbTable,\n    createRowDbTable,\n    validate_type_cell,\n    change_value_cells,\n    default_sortable,\n    convertAlpha,\n    convertDate,\n    formatSymbols,\n    getSizeCells,\n    pullDims,\n    pushDims,\n    getFillArray,\n    fillArray,\n    removeValueInArray,\n    responsive_col,\n    createRegExpFormat,\n    replaceCell,\n    loading,\n    rloading,\n    wptm_clone,\n    parseCss,\n    getCellData,\n    stringReplace,\n    showChartOrTable,\n    ripple_button,\n    combineChangedCellIntoRow,\n    isSameArray,\n    mergeCollsRowsstyleToCells,\n    setFormat_accounting,\n    updateStyleAutofill,\n    setPositionForHtmlCellEditor,\n    hashFnv32a,\n    copy_text,\n    getLinkSync,\n    momentjsFormat,\n    setFormat_accounting_for_cells,\n    createRegExpFormatForCell,\n    checkCellsOptionsValidate,\n    status_notic,\n    check_cell_readOnly,\n    create_ranger_cells_lock,\n    check_collide_two_range,\n    render_css_lock\n}","//setTimeout change height table by rows height\nimport tableFunction from \"./_functions\";\nimport selectOption from \"./_toolbarOptions\";\nimport customRenderer from \"./_customRenderer\";\nimport DropChart from \"./_chart\";\n\n/**\n * Call handsontable lib\n *\n * @param datas Wptm.datas\n */\nfunction initHandsontable(datas) {\n    var checkScroll = false;\n    var autoScroll;\n    window.Wptm.container = window.wptm_element.tableContainer;\n    var modifyRow = null;\n    var totalRows = datas.length;\n\n    window.Wptm.container.handsontable({\n        data: datas,\n        startRows: 5,\n        startCols: 5,\n        editor: window.CustomEditor,\n        search: true,\n        renderAllRows: false,\n        fillHandle: ((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html') ? {\n            autoInsertRow:false,\n        } : false,\n        modifyAutofillRange: function (startArea, entireArea) {//entireArea is start ranger\n            var directionFill = -1;//-1 is not fill, 0 is top, 1 is bottom, 2 is left, 3 is right\n            var new_range = [startArea[0], startArea[1], startArea[2], startArea[3]];\n\n            if (startArea[0] !== entireArea[0]) {\n                directionFill = 0;\n                new_range[2] = entireArea[0] - 1;\n            } else if (startArea[2] !== entireArea[2]) {\n                directionFill = 1;\n                new_range[0] = entireArea[2] + 1;\n            } else if (startArea[1] !== entireArea[1]) {\n                directionFill = 2;\n                new_range[3] = entireArea[1] - 1;\n            } else if (startArea[3] !== entireArea[3]) {\n                directionFill = 3;\n                new_range[1] = entireArea[3] + 1;\n            }\n\n            if (directionFill > -1) {\n                //update cell type, hyperlink\n                tableFunction.updateStyleAutofill(entireArea, new_range, directionFill);\n            }\n        },\n        copyPaste: true,\n        beforePaste: (data, coords) => {\n        },\n        beforeCopy: (data, coords) => {\n        },\n        afterCopy: function (data, coords) {\n        },\n        afterPaste: function (data, coords) {\n        },\n        colHeaders: true,\n        rowHeaders: true,\n        autoRowSize: false,\n        autoColSize: false,\n        renderer: customRenderer.render,\n        height: tableFunction.calculateTableHeight(window.jquery('#wptm-toolbars')),\n        afterInit: function () {\n            DropChart.functions.loadCharts();\n            Wptm.container.handsontable(\"selectCell\", 0, 0, 0, 0);\n            window.table_function_data.firstRender = true;\n\n            tableFunction.render_css_lock(Wptm, table_function_data);\n        },\n        beforeRender: function (isForced) {\n            Wptm.style.table.fonts_used = window.jquery.extend([], []);\n            Wptm.style.table.fonts_local_used = window.jquery.extend([], []);\n            window.table_function_data.styleToRender = '';\n        },\n        beforeChange: function (changes, source) {\n            if (source === 'auto_convert_data') {\n                return;\n            }\n\n            for (var i = changes.length - 1; i >= 0; i--) {\n                if (jquery('#list_chart').find('.chart-menu').length > 0) {//check chart exist\n                    if (!DropChart.functions.validateCharts(changes[i])) {\n                        bootbox.alert(wptmText.CHANGE_INVALID_CHART_DATA, wptmText.Ok);\n                        return false;\n                    }\n                }\n            }\n        },\n        afterRender: function (isForced) {\n            var parser = new (less.Parser);\n            var Wptm = window.Wptm;\n            var $ = window.jquery;\n\n            window.table_function_data.content = '#mainTabContent .handsontable .ht_master .htCore {' + window.table_function_data.styleToRender + '}';\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_row) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_top .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_col) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_left .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n            if (Wptm.style.table.responsive_type == 'scroll' && Wptm.style.table.freeze_row && Wptm.style.table.freeze_col) {\n                window.table_function_data.content += ' #mainTabContent .handsontable .ht_clone_corner .htCore {' + window.table_function_data.styleToRender + '}';\n            }\n\n            parser.parse(window.table_function_data.content, function (err, tree) {\n                if (err) {\n                    //Here we can throw the erro to the user\n                    return false;\n                } else {\n                    Wptm.css = $('#jform_css').val();\n                    if ($('#headMainCss').length === 0) {\n                        $('head').append('<style id=\"headMainCss\"></style>');\n                    }\n                    $('#headMainCss').text(tree.toCSS());\n                    return true;\n                }\n            });\n            if ($('#content_popup_hide').find('select.select_columns option').length < 1) {\n                // Build column selection for default sort parameter\n                tableFunction.default_sortable(window.Wptm.datas);\n            }\n            //set Wptm.style.rows , Wptm.style.cols value\n            tableFunction.pushDims($, Wptm);\n\n            if (table_function_data.needSaveAfterRender === true) {\n                tableFunction.saveChanges();\n                table_function_data.needSaveAfterRender = false;\n            }\n        },\n        afterChange: function (change, source) {//play when change content cell\n            if (typeof table_function_data.data_argument !== 'undefined' && source === 'loadData') {\n                source = 'edit';\n                change = jquery.extend([], table_function_data.data_argument);\n            }\n            //fix handsontable merge cells remove data of cells\n            if ((source === 'MergeCells' || source === 'populateFromArray')&& typeof change.length !== 'undefined') {\n                for (i = 0; i < change.length; i++) {\n                    if (change[i][2] !== null && change[i][3] === null) {\n                        Wptm.datas[change[i][0]][change[i][1]] = change[i][2];\n                    }\n                }\n            }\n\n            if (source === 'populateFromArray' && change.length > 0 && change[0][2] === change[0][3]) {\n                tableFunction.cleanHandsontable();\n            }\n\n            if (source === 'loadData' || source === 'populateFromArray' || !(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n                return; //don't save this change\n            }\n            var action = ['CopyPaste.paste', 'edit', 'UndoRedo.undo', 'UndoRedo.redo', 'Autofill.fill', 'setDataAtCell'];\n\n            //validate data cells when mergeCells\n            if (change) {\n                // console.log(change, source, Wptm.datas[change[i][0]][change[i][1]]);\n                var i;\n                var notSaveData;\n                var editHeader = false;\n                var mysql_column_edit, mysql_column_key;\n                for (i = 0; i < change.length; i++) {\n                    if (action.includes(source)) {\n                        notSaveData = true;\n                        if (typeof change[i][3] === 'undefined' || change[i][3] === 'wptm_change_value_after_set_columns_types') {\n                            change[i][3] = change[i][2];//loadData when edit cells > 5ommit\n                            notSaveData = false;\n                        }\n                        if (change[i][3] === change[i][4]) {\n                            notSaveData = false;\n                        }\n\n                        if (typeof Wptm.headerOption == 'undefined' || change[i][0] >= Wptm.headerOption) {//check cell in table header\n                            if (typeof change[i][3] !== 'undefined' && change[i][3] !== null) {\n                                var value = tableFunction.cell_type_to_column(change[i], change[i][3]);\n                                var value_change;\n                                if (value === false) {\n                                    wptm_element.mainTabContent.find('td.dtr' + change[i][0] + '.dtc' + change[i][1]).addClass('invalid_data');\n                                    bootbox.alert(wptmText.CHANGE_INVALID_CELL_DATA, wptmText.Ok);\n                                    return;\n                                } else {\n                                    wptm_element.mainTabContent.find('td.dtr' + change[i][0] + '.dtc' + change[i][1]).removeClass('invalid_data');\n                                    if (value !== true) {\n                                        if (notSaveData) {\n                                            if (Wptm.type !== 'mysql') {\n                                                saveData.push({action: 'edit_cell', row: change[i][0], col: change[i][1], content: value});\n                                            } else if ( Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[change[i][1]] !== \"undefined\") {\n                                                if (change[i][2] !== value) {\n                                                    mysql_column_edit = Wptm.query_option.column_options[change[i][1]].table + '.' + Wptm.query_option.column_options[change[i][1]].Field;\n                                                    mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                                    value_change = Wptm.datas[change[i][0]][table_function_data.keyPosition];\n                                                    Wptm.saveDataDbTable.push({\n                                                        action: 'edit_cell_mysql',\n                                                        row: change[i][0],\n                                                        col: change[i][1],\n                                                        content: value,\n                                                        id: Wptm.datas[change[i][0]][table_function_data.keyPosition],\n                                                        column: mysql_column_edit,\n                                                        column_key: mysql_column_key\n                                                    });\n                                                }\n                                            }\n                                            if (Wptm.headerOption > 0 && change[i][0] < Wptm.headerOption) {\n                                                Wptm.style.table.header_data[change[i][0]][change[i][1]] = value;\n                                            }\n                                        }\n                                        if (value !== change[i][3]) {//has convert cell value\n                                            window.Wptm.container.handsontable('setDataAtCell', change[i][0], change[i][1], value, 'auto_convert_data');\n                                        }\n                                    } else {\n                                        if (notSaveData) {\n                                            if (Wptm.type !== 'mysql') {\n                                                saveData.push({action: 'edit_cell', row: change[i][0], col: change[i][1], content: change[i][3]});\n                                            } else if ( Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[change[i][1]] !== \"undefined\")  {\n                                                if (change[i][2] !== change[i][3]) {\n                                                    mysql_column_edit = Wptm.query_option.column_options[change[i][1]].table + '.' + Wptm.query_option.column_options[change[i][1]].Field;\n                                                    mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                                    value_change = Wptm.datas[change[i][0]][table_function_data.keyPosition];\n                                                    Wptm.saveDataDbTable.push({\n                                                        action: 'edit_cell_mysql',\n                                                        row: change[i][0],\n                                                        col: change[i][1],\n                                                        content: change[i][3],\n                                                        id: Wptm.datas[change[i][0]][table_function_data.keyPosition],\n                                                        column: mysql_column_edit,\n                                                        column_key: mysql_column_key\n                                                    });\n                                                }\n                                            }\n                                            if (Wptm.headerOption > 0 && change[i][0] < Wptm.headerOption) {\n                                                Wptm.style.table.header_data[change[i][0]][change[i][1]] = change[i][3];\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        } else {\n                            editHeader = true;\n                            if (notSaveData) {\n                                if (Wptm.type === 'mysql' && Wptm.query_option.column_options !== null && typeof Wptm.query_option.column_options[change[i][1]] !== \"undefined\") {\n                                    if (change[i][2] !== change[i][3]) {\n                                        mysql_column_edit = Wptm.query_option.column_options[change[i][1]].table + '.' + Wptm.query_option.column_options[change[i][1]].Field;\n                                        mysql_column_key = Wptm.query_option.column_options[table_function_data.keyPosition].table + '.' + Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                        value_change = Wptm.datas[change[i][0]][table_function_data.keyPosition];\n                                        Wptm.saveDataDbTable.push({\n                                            action: 'edit_cell_mysql',\n                                            row: change[i][0],\n                                            col: change[i][1],\n                                            content: change[i][3],\n                                            id: Wptm.datas[change[i][0]][table_function_data.keyPosition],\n                                            column: mysql_column_edit,\n                                            column_key: mysql_column_key\n                                        });\n                                    }\n                                } else {\n                                    saveData.push({action: 'edit_cell', row: change[i][0], col: change[i][1], content: change[i][3]});\n                                }\n                                if (Wptm.headerOption > 0 && change[i][0] < Wptm.headerOption) {\n                                    Wptm.style.table.header_data[change[i][0]][change[i][1]] = change[i][3];\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            // clearTimeout(tableFunction.autosaveNotification);\n\n            //change[0][2] & change[0][3] === undefined when edit html cell\n            if (action.includes(source) && typeof change[0] !== 'undefined' && !(typeof change[0][2] === 'undefined' && typeof change[0][3] === 'undefined')) {\n                table_function_data.needSaveAfterRender = (change[0][2] !== change[0][3] || source ==='setDataAtCell') ? true : false;\n            }\n\n            if (change && Wptm.type === 'mysql' && notSaveData && Wptm.saveDataDbTable.length > 0) {//mysql table edited\n                if (typeof value !== 'undefined' || editHeader) {\n                    saveData = saveData.concat(Wptm.saveDataDbTable);\n                    wptm_element.mainTabContent.addClass('loading_ajax');\n                    Wptm.saveDataDbTable = [];\n                    tableFunction.saveChanges(true);\n                }\n                table_function_data.needSaveAfterRender = false;\n            }\n\n            //update merge cells when autofill\n            if ('Autofill.fill' === source) {\n                tableFunction.cleanHandsontable();\n                updateMergeCells(true);\n            } else {\n                setTimeout(function () {\n                    if (jquery(Wptm.container).handsontable('getInstance').undoRedo.isUndoAvailable()) {\n                        wptm_element.primary_toolbars.find('#undo_cell').addClass('active').removeClass('no_active');\n                    } else {\n                        wptm_element.primary_toolbars.find('#undo_cell').removeClass('active').addClass('no_active');\n                    }\n                    if (jquery(Wptm.container).handsontable('getInstance').undoRedo.isRedoAvailable()) {\n                        wptm_element.primary_toolbars.find('#redo_cell').addClass('active').removeClass('no_active');\n                    } else {\n                        wptm_element.primary_toolbars.find('#redo_cell').removeClass('active').addClass('no_active');\n                    }\n                }, 100);\n            }\n\n            if (table_function_data.needSaveAfterRender === true) {\n                tableFunction.saveChanges();\n                table_function_data.needSaveAfterRender = false;\n            }\n        },\n        afterCreateRow: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            var above = selector[0] === index ? true : false;//check above/below\n\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[0] >= index) {//rows >= index\n                        newCells[parseInt(cells[0] + amount) + '!' + cells[1]]\n                            = [cells[0] + amount, cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[0] < index) {//rows < index\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[0] <= selector[2] && selector[0] <= cells[0]) {//new rows copy style of selector\n                        newCells[parseInt(cells[0] - selector[0] + index) + '!' + cells[1]]\n                            = [parseInt(cells[0] - selector[0] + index), cells[1], $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (above) {//above\n                            if (alternateColorValue[i].selection[0] >= index + amount) { // alternateColorValue > new rows\n                                alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] + amount;\n                                alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                            }\n                            if (alternateColorValue[i].selection[0] < index + amount && alternateColorValue[i].selection[2] >= index) {\n                                alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                            }\n                        } else {//below\n                            if (alternateColorValue[i].selection[0] >= index) { // alternateColorValue > new rows\n                                alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] + amount;\n                                alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                            }\n                            if (alternateColorValue[i].selection[0] < index && alternateColorValue[i].selection[2] >= selector[0]) {\n                                alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] + amount;\n                            }\n                        }\n                    }\n                }\n            }\n\n            if (typeof (Wptm.style.rows) !== 'undefined') {\n                // index, amount\n                var new_data = $.extend({}, Wptm.style.rows);\n                var jj;\n                if (selector[0] === index) {//left\n                    for (jj = index; jj < _.size(Wptm.style.rows); jj++) {\n                        new_data[jj + amount] = [jj + amount, {}];\n                        new_data[jj + amount][1] = $.extend({}, Wptm.style.rows[jj][1]);\n                    }\n                } else {\n                    for (jj = index; jj < _.size(Wptm.style.rows) + amount; jj++) {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, Wptm.style.rows[jj - amount][1]);\n                    }\n                }\n\n                Wptm.style.rows = $.extend({}, new_data);\n            }\n\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n            saveData.push({action: 'create_row', index: index, amount: amount, above: above});\n\n            // update merged row index and get tableFunction.saveChanges();\n            updateMergeCells(window.table_function_data.firstRender);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'create_row', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterRemoveRow: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[0] > index + amount - 1) {\n                        newCells[parseInt(cells[0] - amount) + '!' + cells[1]]\n                            = [cells[0] - amount, cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[0] < index) {\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (alternateColorValue[i].selection[2] >= index && alternateColorValue[i].selection[2] <= (index + amount - 1)) {\n                            alternateColorValue[i].selection[2] = index - 1;//selection[2] in selector\n                        }\n                        if (alternateColorValue[i].selection[2] >= index + amount) {\n                            alternateColorValue[i].selection[2] = alternateColorValue[i].selection[2] - amount;//selection[2] > selector\n                        }\n                        if (alternateColorValue[i].selection[0] >= index && alternateColorValue[i].selection[0] < (index + amount)) {\n                            alternateColorValue[i].selection[0] = index;//selection[0] in selector\n                        }\n                        if (alternateColorValue[i].selection[0] >= index + amount) {\n                            alternateColorValue[i].selection[0] = alternateColorValue[i].selection[0] - amount;//selection[0] > selector\n                        }\n                        if (alternateColorValue[i].selection[0] > alternateColorValue[i].selection[2]) {//alternateColor in selector\n                            delete alternateColorValue[i];\n                        }\n                    }\n                }\n            }\n\n            if (typeof (Wptm.style.rows) !== 'undefined') {\n                // index, amount\n                var new_data = $.extend({}, Wptm.style.rows);\n                var jj;\n                for (jj = index; jj < _.size(Wptm.style.rows); jj++) {\n                    if (typeof (Wptm.style.rows[jj + amount]) !== 'undefined') {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, Wptm.style.rows[jj][1]);\n                    } else {\n                        delete new_data[jj];\n                    }\n                }\n                Wptm.style.rows = $.extend({}, new_data);\n            }\n\n            //remove col in header table\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            saveData.push({action: 'del_row', index: index, amount: amount, old_rows: $(window.Wptm.container).handsontable('countRows') + amount});\n            // update merged row index and get tableFunction.saveChanges();\n            updateMergeCells(window.table_function_data.firstRender);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'delete_row', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterCreateCol: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            var left = selector[1] === index ? true : false;//check insert left/right\n\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[1] >= index) {//cols >= index\n                        newCells[cells[0] + '!' + parseInt(cells[1] + amount)]\n                            = [cells[0], cells[1] + amount, $.extend({}, cells[2])];\n                    }\n                    if (cells[1] < index) {//cols < index\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                    if (cells[1] <= selector[3] && selector[1] <= cells[1]) {//new cols copy style of selector\n                        newCells[cells[0] + '!' + parseInt(cells[1] - selector[1] + index)]\n                            = [cells[0], parseInt(cells[1] - selector[1] + index), $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (left) {//insert left\n                            if (alternateColorValue[i].selection[1] >= index) { // alternateColorValue > new rows\n                                alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] + amount;\n                                alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                            }\n                            if (alternateColorValue[i].selection[1] < index && alternateColorValue[i].selection[3] >= index) {\n                                alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                            }\n                        } else {//insert right\n                            if (alternateColorValue[i].selection[1] >= index) { // alternateColorValue > new rows\n                                alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] + amount;\n                                alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                            }\n                            if (alternateColorValue[i].selection[1] < index && alternateColorValue[i].selection[3] >= index) {\n                                alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] + amount;\n                            }\n                        }\n                    }\n                }\n            }\n\n            if (typeof (Wptm.style.cols) !== 'undefined') {\n                // index, amount\n                var new_data = $.extend({}, Wptm.style.cols);\n                var jj;\n                if (selector[1] === index) {//left\n                    for (jj = index; jj < _.size(Wptm.style.cols); jj++) {\n                        new_data[jj + amount] = [jj + amount, {}];\n                        new_data[jj + amount][1] = $.extend({}, Wptm.style.cols[jj][1]);\n                    }\n                } else {\n                    for (jj = index; jj < _.size(Wptm.style.cols) + amount; jj++) {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, Wptm.style.cols[jj - amount][1]);\n                    }\n                }\n\n                Wptm.style.cols = $.extend({}, new_data);\n            }\n\n            for (var i = index; i <= (index + amount - 1) ; i++) {\n                Wptm.style.table.col_types.splice(i, 0, 'varchar');\n            }\n\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            // Build column selection for default sort parameter\n            tableFunction.default_sortable(window.Wptm.datas);\n\n            window.jquery(window.Wptm.container).handsontable('render');\n            saveData.push({action: 'create_col', index: index, amount: amount, left: left});\n\n            // update merged row index and get tableFunction.saveChanges();\n            updateMergeCells(window.table_function_data.firstRender);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'add_col', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterRemoveCol: function (index, amount) {\n            var selector = table_function_data.selection[table_function_data.selectionSize - 1];\n            var $ = jquery;\n            var Wptm = window.Wptm;\n            if (typeof (Wptm.style.cells) !== 'undefined') {\n                var newCells = {};\n                var cell, i, cells;\n\n                for (cell in Wptm.style.cells) {\n                    cells = Wptm.style.cells[cell];\n                    if (cells[1] > index + amount - 1) {\n                        newCells[cells[0] + '!' + parseInt(cells[1] - amount)]\n                            = [cells[0], cells[1] - amount, $.extend({}, cells[2])];\n                    }\n                    if (cells[1] < index) {\n                        newCells[cell]\n                            = [cells[0], cells[1], $.extend({}, cells[2])];\n                    }\n                }\n                Wptm.style.cells = $.extend({}, newCells);\n\n                if (typeof Wptm.style.table.alternateColorValue !== 'undefined') {//update Wptm.style.table.alternateColorValue by index, amount\n                    var alternateColorValue = Wptm.style.table.alternateColorValue;\n                    for (i in alternateColorValue) {\n                        if (alternateColorValue[i].selection[3] >= index && alternateColorValue[i].selection[3] <= (index + amount - 1)) {\n                            alternateColorValue[i].selection[3] = index - 1;//selection[3] in selector\n                        }\n                        if (alternateColorValue[i].selection[3] >= index + amount) {\n                            alternateColorValue[i].selection[3] = alternateColorValue[i].selection[3] - amount;//selection[3] > selector\n                        }\n                        if (alternateColorValue[i].selection[1] >= index && alternateColorValue[i].selection[1] < (index + amount)) {\n                            alternateColorValue[i].selection[1] = index;//selection[0] in selector\n                        }\n                        if (alternateColorValue[i].selection[1] >= index + amount) {\n                            alternateColorValue[i].selection[1] = alternateColorValue[i].selection[1] - amount;//selection[0] > selector\n                        }\n                        if (alternateColorValue[i].selection[1] > alternateColorValue[i].selection[3]) {//alternateColor in selector\n                            delete alternateColorValue[i];\n                        }\n                    }\n                }\n            }\n\n            if (typeof (Wptm.style.cols) !== 'undefined') {\n                // index, amount\n                var new_data = $.extend({}, Wptm.style.cols);\n                var jj;\n                for (jj = index; jj < _.size(Wptm.style.cols); jj++) {\n                    if (typeof (Wptm.style.cols[jj + amount]) !== 'undefined' && Wptm.style.cols[jj + amount] !== null) {\n                        new_data[jj] = [jj, {}];\n                        new_data[jj][1] = $.extend({}, Wptm.style.cols[jj][1]);\n                    } else {\n                        delete new_data[jj];\n                    }\n                }\n                Wptm.style.cols = $.extend({}, new_data);\n            }\n\n            for (var i = (index + amount - 1); i >= index ; i--) {\n                Wptm.style.table.col_types.splice(i, 1);\n            }\n\n            //remove col in header table\n            if (parseInt(Wptm.headerOption) > 0) {\n                delete Wptm.style.table.header_data;\n                Wptm.style.table.header_data = [];\n                for (var j = 0; j < Wptm.headerOption; j++) {\n                    Wptm.style.table.header_data[j] = Wptm.datas[j];\n                }\n            }\n\n            // Build column selection for default sort parameter\n            tableFunction.default_sortable(window.Wptm.datas);\n            jquery(Wptm.container).data('handsontable').render();\n            saveData.push({action: 'del_col', index: index, amount: amount, old_columns: $(window.Wptm.container).handsontable('countCols') + amount});\n\n            updateMergeCells(window.table_function_data.firstRender);\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'delete_col', index: index, amount: amount});\n\n            tableFunction.cleanHandsontable();\n        },\n        afterColumnResize: function (col, width) {\n            tableFunction.saveChanges();\n        },\n        beforeRowResize: function (currentRow, newSize, isDoubleClick) {\n            if (modifyRow !== null) {//currentRow is current size row\n                Wptm.style.rows[modifyRow][1].height = newSize;\n            }\n        },\n        modifyRow: function (row) {\n            modifyRow = row;\n        },\n        afterRowResize: function (row1, height) {\n            Wptm.style.rows[row1][1].height = height;\n\n            tableFunction.saveChanges();\n        },\n        afterSelection: function (r, c, r2, c2, preventScrolling, selectionLayerLevel) {\n            if (table_function_data.checkCellValueChange !== false && typeof table_function_data.cellValueChange !== 'undefined') {\n                tableFunction.change_value_cells(table_function_data.checkCellValueChange, wptm_element.cellValue.val());\n            }\n            selectOption.loadSelection(window.jquery, window.Wptm, [r, c, r2, c2]);\n            Wptm.max_Col = Wptm.datas[0].length;\n            Wptm.max_row = Wptm.datas.length;\n            if (typeof Wptm.datas[Wptm.max_row - 1] !== 'undefined') {\n                var max_col_2 = Wptm.datas[Wptm.max_row - 1].length;\n                Wptm.max_Col = Wptm.max_Col < max_col_2 ? max_col_2 : Wptm.max_Col;\n            }\n            if (r * r2 == 0 && (r2 + r) == (Wptm.max_row - 1)) {\n                Wptm.newSelect = 'col';\n            } else if (c * c2 == 0 && (c2 + c) == Wptm.max_Col - 1) {\n                Wptm.newSelect = 'row';\n            } else {\n                delete Wptm.newSelect;\n            }\n        },\n        afterScrollHorizontally: function () {\n            //change position of Editors when ScrollHorizontally\n            checkScroll = true;\n            clearTimeout(autoScroll);\n            autoScroll = setTimeout(function () {\n                checkScroll = afterScrollEditors(checkScroll);\n            }, 200);\n        },\n        afterScrollVertically: function () {\n            //change position of Editors when ScrollHorizontally\n            checkScroll = true;\n            clearTimeout(autoScroll);\n            autoScroll = setTimeout(function () {\n                checkScroll = afterScrollEditors(checkScroll);\n            }, 200);\n        },\n        afterMergeCells: function (cellRange, mergeParent, auto) {\n            updateMergeCells(window.table_function_data.firstRender);\n            // if (window.table_function_data.firstRender) {\n            //     tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'mergeCells'});\n            // }\n        },\n        afterUnmergeCells: function (cellRange, auto) {\n            updateMergeCells(window.table_function_data.firstRender);\n            // if (window.table_function_data.firstRender) {\n            //     tableFunction.create_ranger_cells_lock(Wptm, table_function_data, {type: 'mergeCells'});\n            // }\n        },\n        colWidths: function (index) {\n            if (tableFunction.checkObjPropertyNested(window.Wptm.style, 'cols', index, 1, 'width')) {\n                return window.Wptm.style.cols[index][1].width;\n            } else if (typeof window.Wptm.style.cols === 'object' && (typeof window.Wptm.style.cols[index] === 'undefined' || typeof window.Wptm.style.cols[index][1].width === 'undefined')) {\n                return 100;\n            }\n        },\n        rowHeights: function (index) {\n            if (tableFunction.checkObjPropertyNestedNotEmpty(window.Wptm.style, 'rows', index, 1, 'height')) {\n                return window.Wptm.style.rows[index][1].height;\n            } else {\n                // Table rows is large than 1000, set default row height to 30\n                if (totalRows >= 1000) {\n                    return 30;\n                }\n                var h;\n                if (typeof Wptm.style.table.allRowHeight !== 'undefined' && Wptm.style.table.allRowHeight !== '') {\n                    h = Wptm.style.table.allRowHeight;\n                } else {\n                    h = window.Wptm.container.find('.ht_master .htCore tbody tr').eq(index).height();\n                }\n                return h;\n            }\n        },\n        fixedRowsTop: (window.Wptm.style.table.responsive_type == 'scroll' && parseInt(window.Wptm.style.table.freeze_row) > 0) ? window.Wptm.headerOption : 0,\n        fixedColumnsLeft: (window.Wptm.style.table.responsive_type == 'scroll') ? parseInt(window.Wptm.style.table.freeze_col) : 0,\n        manualColumnResize: (window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)),\n        manualRowResize: (window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)),\n        outsideClickDeselects: false,\n        columnSorting: false,\n        undo: true,\n        mergeCells: window.Wptm.mergeCellsSetting,\n        readOnly: ((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html') ? false : (Wptm.table_editing != \"1\" ? true : false),\n        // readOnly: false,\n        selectionMode: table_function_data.mysqlEdit ? 'single' : 'range',\n        columns: typeof table_function_data.columns !== 'undefined' ? table_function_data.columns : undefined,\n        // columns: undefined,\n        beforeKeyDown: function (e) {\n            var evtobj = window.event? event : e;\n\n            if (evtobj.keyCode == 90 && (evtobj.ctrlKey || evtobj.metaKey)) {//undo\n                if (!evtobj.shiftKey) {\n                    if (!window.jquery(Wptm.container).handsontable('getInstance').undoRedo.isUndoAvailable()) {\n                        tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n                    }\n                }\n                if (evtobj.shiftKey) {\n                    if (!window.jquery(Wptm.container).handsontable('getInstance').undoRedo.isRedoAvailable()) {\n                        tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n                    }\n                }\n            }\n        },\n        // readOnlyCellClassName: 'wptm_lock_column', //ncc error conflict header, conflict html cell\n        cells: function(row, col, prop) {\n            return tableFunction.check_cell_readOnly(row, col, prop);\n        },\n        contextMenu: (((window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author)) && window.Wptm.type === 'html')\n            ? {\n                items: {\n                    \"cut\": {\n                        name: wptmContext.cut,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"copy\": {\n                        name: wptmContext.copy,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        },\n                    },\n                    // \"paste\": {\n                    //     key: 'paste',\n                    //     name: 'Paste',\n                    //     disabled: function() {\n                    //         return clipboardCache.length === 0;\n                    //     },\n                    //     callback: function() {\n                    //         var plugin = this.getPlugin('copyPaste');\n                    //\n                    //         this.listen();\n                    //         plugin.paste(clipboardCache);\n                    //     }\n                    // },\n                    \"remove\": {\n                        name: wptmContext.remove,\n                        key: 'remove',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"remove:remove_row\",\n                                    name: wptmContext.remove_rows,\n                                    callback: function (key, selection, clickEvent) {\n                                        var selection = table_function_data.selection;\n                                        var i;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection[i][2] != null || selection[i][0] != selection[i][2]) {\n                                                window.Wptm.container.handsontable('alter', 'remove_row', selection[i][0], selection[i][2] - selection[i][0] + 1);\n                                            } else {\n                                                window.Wptm.container.handsontable('alter', 'remove_row', selection[i][0]);\n                                            }\n                                        }\n                                    },\n                                },\n                                {\n                                    key: \"remove:remove_col\",\n                                    name: wptmContext.remove_cols,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection;\n                                        var i;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection[i][3] != null || selection[i][1] != selection[i][3]) {\n                                                window.Wptm.container.handsontable('alter', 'remove_col', selection[i][1], selection[i][3] - selection[i][1] + 1);\n                                            } else {\n                                                window.Wptm.container.handsontable('alter', 'remove_col', selection[i][1]);\n                                            }\n                                        }\n                                    },\n                                },\n                                {\n                                    key: \"remove:remove_cell_format\",\n                                    name: wptmContext.remove_cell_format,\n                                    callback: function (key, selection, clickEvent) {\n                                        tableFunction.getFillArray(table_function_data.selection, Wptm, {\n                                            date_formats: false,\n                                            date_formats_momentjs: false,\n                                            currency_symbol: false,\n                                            symbol_position: false,\n                                            decimal_symbol: false,\n                                            decimal_count: false,\n                                            thousand_symbol: false\n                                        }, 'style', true, function () {\n                                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                                        });\n                                    },\n                                    hidden: function () {//hiden when has html cell\n                                        if (table_function_data.selectionSize > 0) {\n                                            if (!tableFunction.checkCellsOptionsValidate(table_function_data.selection, 'cell_type', 'html')) {\n                                                return false;\n                                            }\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"remove:remove_alternating_color\",\n                                    // name: function () {\n                                    //     return (table_function_data.selectionSize > 2\n                                    //         || (table_function_data.selectionSize < 2 && (table_function_data.selection[0][2] > table_function_data.selection[0][0] + 1) || (table_function_data.selection[0][3] > table_function_data.selection[0][1] + 1)))\n                                    //         ? wptmContext.remove_alternating_color_cells\n                                    //         : wptmContext.remove_alternating_color;\n                                    // },\n                                    name: wptmContext.remove_alternating_color,\n                                    callback: function (key, selection, clickEvent) {\n                                        var i, ij, ik, alternateColorCell, selection_cell = null;\n                                        for (i = 0; i < table_function_data.selectionSize; i++) {\n                                            if (selection_cell !== null) {\n                                                break;\n                                            }\n                                            for (ij = table_function_data.selection[i][0]; ij <= table_function_data.selection[i][2]; ij++) {\n                                                if (selection_cell !== null) {\n                                                    break;\n                                                }\n                                                for (ik = table_function_data.selection[i][1]; ik <= table_function_data.selection[i][3]; ik++) {\n                                                    if (typeof Wptm.style.cells[ij + \"!\" + ik] !== 'undefined' && typeof Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor !== 'undefined') {\n                                                        alternateColorCell = parseInt(Wptm.style.cells[ij + \"!\" + ik][2].AlternateColor);\n                                                        if (typeof Wptm.style.table.alternateColorValue[alternateColorCell] !== 'undefined' && typeof Wptm.style.table.alternateColorValue[alternateColorCell].selection !== 'undefined') {\n                                                            selection_cell = Wptm.style.table.alternateColorValue[alternateColorCell].selection;\n                                                            Wptm.container.handsontable(\"selectCell\", selection_cell[0], selection_cell[1], selection_cell[2], selection_cell[3]);\n                                                            break;\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        if (selection_cell !== null) {\n                                            bootbox.confirm(wptmText.warning_remove_alternating_color, wptmText.Cancel, wptmText.Ok, function (result) {\n                                                if (result) {\n                                                    table_function_data.oldAlternate[alternateColorCell] = false;\n                                                    Wptm.style.table.alternateColorValue[alternateColorCell] = false;\n                                                    setTimeout(function () {\n                                                        saveData.push({action: 'deleteStyle', selection: table_function_data.selection, style: 'AlternateColor'});\n                                                        window.jquery('#wptm_popup').find('.colose_popup').trigger('click');\n                                                        tableFunction.saveChanges(true, 'render');\n                                                    }, 100);\n                                                } else {\n                                                    window.jquery('#wptm_popup').find('.colose_popup').trigger('click');\n                                                }\n                                                ;\n                                            });\n                                        }\n                                    },\n                                    hidden: function () {//hiden when has html cell\n                                        if (table_function_data.selectionSize > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                }],\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"---------\": {},\n                    \"rows_size\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                var selectSize = table_function_data.selection[table_function_data.selectionSize - 1];\n                                if (Wptm.newSelect === 'row') {\n                                    if (selectSize[0] !== selectSize[2]) {\n                                        return '<span>' + wptmContext.define + 's ' + (selectSize[0] + 1) + '-' + (selectSize[2] + 1) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.define + '</span>';\n                                } else {\n                                    if (selectSize[1] !== selectSize[3]) {\n                                        return '<span>' + wptmContext.define + 's ' + String.fromCharCode(65 + selectSize[1]) + '-' + String.fromCharCode(65 + selectSize[3]) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.defineColumn + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_row\"]').trigger('click');\n                            } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_column\"]').trigger('click');\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"insert\": {\n                        name: wptmContext.insert,\n                        key: 'insert',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"insert:row_above\",\n                                    name: wptmContext.insert_above,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[2] != null || selection[0] != selection[2]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[0], selection[2] - selection[0] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[0]);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_Col > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:row_below\",\n                                    name: wptmContext.insert_below,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[2] != null || selection[0] != selection[2]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[2] + 1, selection[2] - selection[0] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_row', selection[2] + 1);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_Col > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:col_left\",\n                                    name: wptmContext.insert_left,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[3] != null || selection[1] != selection[3]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[1], selection[3] - selection[1] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[1]);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_row > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                },\n                                {\n                                    key: \"insert:col_right\",\n                                    name: wptmContext.insert_right,\n                                    callback: function (key, options) {\n                                        var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                                        if (selection[3] != null || selection[1] != selection[3]) {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[3] + 1, selection[3] - selection[1] + 1);\n                                        } else {\n                                            window.Wptm.container.handsontable('alter', 'insert_col', selection[3] + 1);\n                                        }\n                                    },\n                                    hidden: function () {\n                                        if (Wptm.max_row > 0) {\n                                            return false;\n                                        }\n                                        return true;\n                                    }\n                                }],\n                        }\n                    },\n                    \"undo\": {\n                        name: wptmContext.undo,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"redo\": {\n                        name: wptmContext.redo,\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"protect_range\": {\n                        name: function () {\n                            // if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                            //     var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                            //     var ij;\n                            //     table_function_data.protect_columns_check = false;\n                            //     if (typeof Wptm.style.table.protect_columns !== 'undefined') {\n                            //         for (ij = selection[1]; ij <= selection[3]; ij++) {\n                            //             if (Wptm.style.table.protect_columns[ij] != 1) {\n                            //                 table_function_data.protect_columns_check = false;\n                            //                 return '<span>' + wptmContext.protect_columns + '</span>';\n                            //             }\n                            //         }\n                            //         table_function_data.protect_columns_check = true;\n                            //         return '<span class=\"selected\">' + wptmContext.protect_columns + '</span>';\n                            //     } else {\n                            //         Wptm.style.table.protect_columns = [];\n                            //         for (ij = 0; ij < Wptm.max_Col; ij++) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         }\n                            //         return '<span>' + wptmContext.protect_columns + '</span>';\n                            //     }\n                            // }\n                            return '<span>' + wptmContext.protect_range + '</span>';\n                        },\n                        callback: function (key, selections, clickEvent) {\n                            // if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                            //     var ij;\n                            //     if (typeof Wptm.style.table.protect_columns == 'undefined') {\n                            //         Wptm.style.table.protect_columns = [];\n                            //         for (ij = 0; ij < Wptm.max_Col; ij++) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         }\n                            //     }\n                            //\n                            //     var selection = table_function_data.selection[table_function_data.selectionSize - 1];\n                            //     for (ij = selection[1]; ij <= selection[3]; ij++) {\n                            //         if (typeof table_function_data.protect_columns_check !== 'undefined'\n                            //             && table_function_data.protect_columns_check) {\n                            //             Wptm.style.table.protect_columns[ij] = '0';\n                            //         } else {\n                            //             Wptm.style.table.protect_columns[ij] = '1';\n                            //         }\n                            //     }\n                            // } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"lock_ranger_cells\"]').trigger('click');\n                            // }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (wptm_administrator == 1) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"mergeCells\": {\n                        // name: wptmContext.merge,\n                    },\n                    \"Add tooltip\": {\n                        name: wptmContext.tooltip,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.editToolTip.trigger('click');\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1\n                                || (table_function_data.selection[0][2] - table_function_data.selection[0][0] > 0\n                                    || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0)) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    },\n                    \"Column type\": {\n                        name: wptmContext.column_type,\n                        key: 'column_type',\n                        submenu: {\n                            items: [\n                                {\n                                    key: \"column_type:varchar\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && (table_function_data.type_column_selected === 'varchar' || table_function_data.type_column_selected.toLowerCase() === 'varchar(255)')) {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_varchar + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_varchar + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'varchar';\n                                                        Wptm.style.table.col_types[i] = 'varchar';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:int\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'int') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_int + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_int + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'int';\n                                                        Wptm.style.table.col_types[i] = 'int';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n                                    },\n                                },\n                                {\n                                    key: \"column_type:float\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'float') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_float + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_float + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'float';\n                                                        Wptm.style.table.col_types[i] = 'float';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n\n                                    },\n                                },\n                                {\n                                    key: \"column_type:date\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'date') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_date + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_date + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'date';\n                                                        Wptm.style.table.col_types[i] = 'date';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n\n                                    },\n                                },\n                                {\n                                    key: \"column_type:datetime\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'datetime') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_datetime + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_datetime + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'datetime';\n                                                        Wptm.style.table.col_types[i] = 'datetime';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n\n                                    },\n                                },\n                                {\n                                    key: \"column_type:text\",\n                                    name: function () {\n                                        if (typeof table_function_data.type_column_selected !== 'undefined' && table_function_data.type_column_selected === 'text') {\n                                            return '<span class=\"selected\">' + wptmContext.column_type_text + '</span>';\n                                        } else {\n                                            return '<span>' + wptmContext.column_type_text + '</span>';\n                                        }\n                                    },\n                                    callback: function (key, options) {\n                                        bootbox.confirm(wptmText.ALERT_CHANGE_COLUMN_TYPE, wptmText.Cancel, wptmText.Ok, function (result) {\n                                            if (result === true) {\n                                                var cols_selected = [];\n                                                var i, jj;\n                                                for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                                                    for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                                                        cols_selected[i] = 'text';\n                                                        Wptm.style.table.col_types[i] = 'text';\n                                                    }\n                                                }\n\n                                                // saveData.push({action: 'set_column_type', cols: unique_cols_selected, type: 'varchar'});\n                                                saveData.push({\n                                                    action: 'set_columns_types',\n                                                    value: cols_selected\n                                                });\n                                                tableFunction.cleanHandsontable();\n                                                tableFunction.saveChanges(true);\n                                            }\n                                        });\n\n                                    },\n                                },\n                            ]\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1 || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    },\n                    \"hide_column\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]] !== null\n                                    && typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                    return '<span class=\"selected\">' + wptmContext.hide_column + '</span>';\n                                } else {\n                                    return '<span>' + wptmContext.hide_column + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined' && Wptm.style.cols[selection[0][1]] !== null) {\n                                    if (typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined' && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 0}, selection[0][1]);\n                                    } else {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 1}, selection[0][1]);\n                                    }\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"col\" || selection[0][3] - selection[0][1] >= 1) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    }\n                }\n            }\n            : {\n                items: {\n                    \"hide_column\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined' && Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]] !== null\n                                    && typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined'\n                                    && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                    return '<span class=\"selected\">' + wptmContext.hide_column + '</span>';\n                                } else {\n                                    return '<span>' + wptmContext.hide_column + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'col') {\n                                var selection = table_function_data.selection;\n                                if (typeof Wptm.style.cols[selection[0][1]] !== 'undefined' && Wptm.style.cols[selection[0][1]] !== null) {\n                                    if (typeof Wptm.style.cols[selection[0][1]][1].hide_column !== 'undefined' && Wptm.style.cols[selection[0][1]][1].hide_column == 1) {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 0}, selection[0][1]);\n                                    } else {\n                                        Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {hide_column: 1}, selection[0][1]);\n                                    }\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"col\" || selection[0][3] - selection[0][1] >= 1) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"remove_alternating_color\": {\n                        name: wptmContext.remove_alternating_color,\n                        callback: function (key, selection, clickEvent) {\n                            tableFunction.fillArray(table_function_data, {allAlternate: {}});\n                            tableFunction.fillArray(Wptm.style.table, {allAlternate: {}});\n                            window.jquery(wptm_element.tableContainer).handsontable('render');\n                            tableFunction.saveChanges(true);\n                        },\n                        hidden: function () {\n                            if (typeof table_function_data.allAlternate !== 'undefined' && typeof table_function_data.allAlternate.even !== 'undefined') {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"delete_row_dbtable\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                if (Wptm.newSelect === 'row') {\n                                    return '<span>' + wptmContext.delete_row_db_table + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                if (typeof Wptm.query_option.columns_list !== \"undefined\") {\n                                    var not_create = false;\n                                    var warning_craete = '';\n\n                                    if (Wptm.query_option.tables_list.length > 1) {\n                                        not_create = true;\n                                        warning_craete = wptmText.warning_delete_row_multiple_db_table;\n                                    }\n\n                                    var selection = table_function_data.selection;\n                                    if (not_create || typeof Wptm.query_option.column_options[table_function_data.keyPosition] === 'undefined') {\n                                        bootbox.alert(warning_craete, wptmText.Ok);\n                                        return true;\n                                    } else if (typeof selection[0] !== 'undefined') {\n                                        var id_row = Wptm.datas[selection[0][0]][table_function_data.keyPosition];\n                                        var field = Wptm.query_option.column_options[table_function_data.keyPosition].Field;\n                                        tableFunction.deleteRowDbTable(Wptm.query_option.tables_list[0], field, id_row);\n                                    }\n                                }\n                                return true;\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            var selection = table_function_data.selection;\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"row\" || selection[0][2] - selection[0][0] >= 1 || !table_function_data.mysqlEdit) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"create_row_dbtable\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                if (Wptm.newSelect === 'row') {\n                                    return '<span>' + wptmContext.create_row_db_table + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                var popup = {\n                                    'html': wptm_element.content_popup_hide.find('#create_row_dbtable'),\n                                    'showAction': function () {\n                                        return true;\n                                    },\n                                    'submitAction': function () {\n                                        if (typeof Wptm.query_option.columns_list !== \"undefined\") {\n                                            var list_value = {};\n                                            var dbtable = '';\n                                            var not_create = false;\n                                            var warning_craete = '';\n                                            window.jquery.each(Wptm.query_option.columns_list, function (i, v) {\n                                                if (v.canEdit == 1) {\n                                                    var value = wptm_element.wptm_popup.find('input.table_column[data-column-name=\"' + v.table + '.' + v.Field + '\"]').val();\n                                                    var validate = tableFunction.validate_type_cell(\n                                                        v.Type,\n                                                        value\n                                                    );\n                                                    // if (!(typeof list_value[v.table] !== 'undefined')) {\n                                                    //     list_value[v.table] = {};\n                                                    // }\n                                                    // list_value[v.table][v.Field] = value;\n                                                    list_value[v.Field] = value;\n                                                    dbtable = v.table;\n                                                    if (Wptm.query_option.tables_list.length > 1) {\n                                                        not_create = true;\n                                                        warning_craete = wptmText.warning_craete_row_multiple_db_table;\n                                                    } else {\n                                                        if (!validate && v.Null !== 'YES') {\n                                                            not_create = true;\n                                                            warning_craete = wptmText.warning_craete_row_db_table;\n                                                        }\n                                                    }\n                                                }\n\n                                                if (Wptm.query_option.columns_list.length == i + 1) {\n                                                    if (not_create) {\n                                                        bootbox.alert(warning_craete, wptmText.Ok);\n                                                        return true;\n                                                    } else {\n                                                        tableFunction.createRowDbTable(dbtable, list_value);\n                                                        wptm_element.wptm_popup.find('.colose_popup').trigger('click');\n                                                        return true;\n                                                    }\n                                                }\n                                            });\n                                        }\n                                        return true;\n                                    },\n                                    'cancelAction': function () {\n                                        return true;\n                                    }\n                                };\n                                selectOption.wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect === 'undefined' || Wptm.newSelect !== \"row\" || !table_function_data.mysqlEdit) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"rows_size\": {\n                        name: function () {\n                            if (typeof Wptm.newSelect !== 'undefined') {\n                                var selectSize = table_function_data.selection[table_function_data.selectionSize - 1];\n                                if (Wptm.newSelect === 'row') {\n                                    if (selectSize[0] !== selectSize[2]) {\n                                        return '<span>' + wptmContext.define + 's ' + (selectSize[0] + 1) + '-' + (selectSize[2] + 1) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.define + '</span>';\n                                } else {\n                                    if (selectSize[1] !== selectSize[3]) {\n                                        return '<span>' + wptmContext.define + 's ' + String.fromCharCode(65 + selectSize[1]) + '-' + String.fromCharCode(65 + selectSize[3]) + '</span>';\n                                    }\n                                    return '<span>' + wptmContext.defineColumn + '</span>';\n                                }\n                            }\n                        },\n                        callback: function (key, selection, clickEvent) {\n                            if (Wptm.newSelect === 'row') {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_row\"]').trigger('click');\n                            } else {\n                                wptm_element.primary_toolbars.find('.table_option[name=\"resize_column\"]').trigger('click');\n                            }\n                            return true;\n                        },\n                        hidden: function () {\n                            if (typeof Wptm.newSelect === 'undefined' || (Wptm.newSelect !== \"row\" && Wptm.newSelect !== \"col\")) {\n                                return true;\n                            }\n                            if (Wptm.max_Col * Wptm.max_row > 0) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"protect_range\": {\n                        name: function () {\n                            return '<span>' + wptmContext.protect_range + '</span>';\n                        },\n                        callback: function (key, selections, clickEvent) {\n                            wptm_element.primary_toolbars.find('.table_option[name=\"lock_ranger_cells\"]').trigger('click');\n                            return true;\n                        },\n                        hidden: function () {\n                            if (wptm_administrator == 1) {\n                                return false;\n                            }\n                            return true;\n                        }\n                    },\n                    \"Add tooltip\": {\n                        name: wptmContext.tooltip,\n                        callback: function (key, selection, clickEvent) {\n                            wptm_element.editToolTip.trigger('click');\n                        },\n                        hidden: function () {\n                            if (Wptm.max_Col * Wptm.max_row < 1) {\n                                return true;\n                            }\n                            if (table_function_data.selectionSize > 1\n                                || (table_function_data.selection[0][2] - table_function_data.selection[0][0] > 0\n                                    || table_function_data.selection[0][3] - table_function_data.selection[0][1] > 0)) {\n                                return true;\n                            }\n                            return false;\n                        }\n                    }\n                }\n            })\n    });\n\n    wptm_element.tableContainer.find('.ht_clone_top_left_corner').unbind('click').on('click', function () {\n        var max_col = parseInt(Wptm.max_Col) > 0 ? Wptm.max_Col : Wptm.datas[0].length;\n        var max_row = parseInt(Wptm.max_row) > 0 ? Wptm.max_row : Wptm.datas.length;\n        jquery(wptm_element.tableContainer).handsontable(\"selectCells\", [[0, 0, max_row - 1, max_col - 1]]);\n    });\n\n    // search key\n    wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search').on('keyup', function (event) {\n        if (event.keyCode === 13) {\n            wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n        } else if (jquery(this).val() === '') {\n            wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n        }\n    });\n\n    wptm_element.primary_toolbars.find('.search-menu').find('.search_table').click(function () {\n        var textSearch = wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search');\n        var queryResult = jquery(Wptm.container).data('handsontable').getPlugin('search').query(textSearch.val());\n        jquery(Wptm.container).data('handsontable').render();\n    });\n\n    wptm_element.primary_toolbars.find('.search-menu').find('.reload_search').click(function () {\n        wptm_element.primary_toolbars.find('.search-menu').find('#dp-form-search').val('');\n        wptm_element.primary_toolbars.find('.search-menu').find('.search_table').trigger('click');\n    });\n\n    /*select menu option function*/\n    selectOption.selectOption();\n\n    /*more function Eg: rename table*/\n    window.wptm_element.primary_toolbars.find('.wptm_name_edit').text(window.Wptm.title);\n}\n\n/*\n* function change Wptm.mergeCellsSetting when mergecell/unMergeCell action\n*/\nfunction getMergeCells(argument, checkUnmerge) {\n    if (typeof window.table_function_data.mergeCells === 'undefined') {\n        window.table_function_data.mergeCells = [];\n        if (window.Wptm.mergeCellsSetting.length > 0) {\n            var i;\n            for (i = 0; i < window.Wptm.mergeCellsSetting.length; i++) {\n                window.table_function_data.mergeCells['d' + window.Wptm.mergeCellsSetting[i].row + window.Wptm.mergeCellsSetting[i].col] = window.Wptm.mergeCellsSetting[i];\n            }\n        }\n    }\n    if (checkUnmerge) {\n        for (i in table_function_data.mergeCells) {\n            if (argument[0].from.row <= table_function_data.mergeCells[i].row\n                && table_function_data.mergeCells[i].row <= argument[0].to.row\n                && argument[0].from.col <= table_function_data.mergeCells[i].col\n                && table_function_data.mergeCells[i].col <= argument[0].to.col) {\n                delete table_function_data.mergeCells[i];\n            }\n        }\n    } else {\n        var key = 'd' + argument[0].from.row + argument[0].from.col;\n        table_function_data.mergeCells[key] = argument[1];\n    }\n}\n\n/*\n* Function update mergecells when change rows and cols\n* */\nfunction updateMergeCells(firstRender) {\n    window.Wptm.mergeCellsSetting = [];\n    var ht = jquery(Wptm.container).handsontable('getInstance');\n    var mergeSetting = ht.getPlugin('mergeCells').mergedCellsCollection;\n    var i = 0, ij = 0, ij2 = 0;\n\n    if (mergeSetting.mergedCells.length < 1) {//save\n        tableFunction.saveChanges();\n    }\n\n    table_function_data.start_merge_cell_col = {};\n\n    for (i = 0; i < mergeSetting.mergedCells.length; i++) {\n        window.Wptm.mergeCellsSetting[i] = {\n            col: mergeSetting.mergedCells[i].col,\n            colspan: mergeSetting.mergedCells[i].colspan,\n            row: mergeSetting.mergedCells[i].row,\n            rowspan: mergeSetting.mergedCells[i].rowspan\n        };\n        if (typeof table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col] == 'undefined') {\n            table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col] = [];\n        }\n        table_function_data.start_merge_cell_col[mergeSetting.mergedCells[i].col][mergeSetting.mergedCells[i].row] = i;\n    }\n\n    if (firstRender) {\n        tableFunction.saveChanges(firstRender);\n    }\n}\n\n/*\n* calculator height table container\n* style: style of table,\n* getRowsHeight: true(get getRowHeight), false(not get getRowHeight),\n* top: true(get height of ht_clone_top), false(not get height of ht_clone_top)\n* */\nfunction calHeightTable(style, getRowsHeight, top, rowRender) {\n    var rows = style.rows.length;\n    if (rows === undefined) {\n        rows = Object.keys(style.rows).length;\n    }\n\n    var height = 0;\n    var htCloneTop = window.wptm_element.tableContainer.find('.ht_clone_top');\n\n    if (getRowsHeight) {\n        for (var i = 0; i < rows; i++) {\n            window.Wptm.rowsHeight[i] = window.Wptm.container.handsontable('getRowHeight', i);\n            height += window.Wptm.rowsHeight[i];\n        }\n    } else {\n        //remove setTimeout when resize rows\n        // clearTimeout(window.setHeightTable);\n\n        height = window.Wptm.table_height;\n        var newHeight = window.Wptm.container.handsontable('getRowHeight', rowRender);\n        if (typeof window.Wptm.rowsHeight[rowRender] === 'undefined') {\n            window.Wptm.rowsHeight[rowRender] = 0;\n        }\n        height += newHeight - window.Wptm.rowsHeight[rowRender];\n        window.Wptm.rowsHeight[rowRender] = newHeight;\n    }\n\n    if (top) {\n        height += htCloneTop.outerHeight();\n    }\n    return height;\n}\n\n/**\n * Set position for html cell editer popup\n *\n * @param checkScroll Check whether to perform\n * @returns {boolean}\n */\nfunction afterScrollEditors (checkScroll) {\n    var handsontableInputHolder = wptm_element.tableContainer.find('.handsontableInputHolder');\n    if (checkScroll === true && (handsontableInputHolder.hasClass('wptm_set_top') || handsontableInputHolder.hasClass('wptm_set_left'))) {\n        var position = handsontableInputHolder.position();\n\n        var $table = wptm_element.tableContainer.find('.wtHider');\n\n        if (handsontableInputHolder.hasClass('wptm_set_top')) {\n            var tdOffsetTop = handsontableInputHolder.data('tdOffsetTop');\n            var outerHeight = handsontableInputHolder.outerHeight();\n            var heightTable = wptm_element.tableContainer.outerHeight() > $table.outerHeight() ? wptm_element.tableContainer.outerHeight() : $table.outerHeight();\n            var new_top = tdOffsetTop + outerHeight - heightTable + 10;\n\n            if (new_top > 0) {\n                handsontableInputHolder.css({top: position.top - new_top});\n            }\n        }\n        if (handsontableInputHolder.hasClass('wptm_set_left')) {\n            var tdOffsetLeft = handsontableInputHolder.data('tdOffsetLeft');\n            var outerWidth = handsontableInputHolder.outerWidth();\n            var widthTable = wptm_element.tableContainer.outerWidth() > $table.outerWidth() ? wptm_element.tableContainer.outerWidth() : $table.outerWidth();\n            var new_left = tdOffsetLeft + outerWidth - widthTable + 10;\n\n            if (new_left > 0) {\n                handsontableInputHolder.css({left: position.left - new_left});\n            }\n        }\n    }\n    return false;\n}\n\nexport {initHandsontable, getMergeCells, calHeightTable}","import wptmPreview from \"./_wptm\";\nimport tableFunction from \"./_functions\";\nimport change_theme from \"./_changeTheme\";\nimport alternating from \"./_alternating\";\nimport DropChart from \"./_chart\";\n\n//Control functions when select table items\nconst selectOption = function () {\n    var wptm_element = window.wptm_element;\n    var popupOption = {};\n    var render = false;\n    var autoRender;\n    var check_saving;\n    var new_col_types = [];\n    var changed_cols = [];\n\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return false;\n    }\n\n    if (Wptm.max_Col * Wptm.max_row < 1) {\n        return false;\n    }\n\n    custom_select_box.call(window.jquery('#setting-cells .wptm_select_box_before'), window.jquery);\n\n    // jquery(Wptm.container).data('handsontable').getPlugin('hiddenColumns').query(textSearch.val());\n\n    wptm_element.primary_toolbars.find('.table_option:not(.menu_loading)').unbind('change click').on('change click', function (e) {\n        var function_data = window.table_function_data;\n        var Wptm = window.Wptm;\n        var $ = window.jquery;\n\n        if ($(this).parent('li.no_active').length > 0) {\n            return false;\n        }\n\n        var popup = $.extend({}, {});\n        var html = '';\n        //for undo\n        // var oldStyle = JSON.parse(JSON.stringify(Wptm.style));\n        //for mergecells\n        // var ht = Wptm.container.handsontable('getInstance');\n\n        var selection = {};\n        selection = table_function_data.selection;\n\n        /*click cell*/\n        switch ($(this).attr('name')) {\n            case 'rename_menu':\n                // Wptm.container.handsontable('updateSettings', {\n                //     hiddenColumns: {\n                //         columns: [2, 3],\n                //         indicators: true\n                //     }\n                // });\n                // var ht = jquery(Wptm.container).handsontable('getInstance');\n                // var hiddenColumnsPlugin = ht.getPlugin('hiddenColumns');\n                // hiddenColumnsPlugin.hideColumn(1, 4);\n                tableFunction.setText.call(\n                    $(this),\n                    wptm_element.primary_toolbars.find('.wptm_name_edit'),\n                    '#primary_toolbars .wptm_name_edit',\n                    {'url': wptm_ajaxurl + \"task=table.setTitle&id=\" + Wptm.id + '&title=', 'selected': true}\n                );\n                break;\n            case 'save_menu':\n                tableFunction.saveChanges(true);\n                break;\n            case 'export_menu':\n                // if (Wptm.type == 'mysql') {\n                //     return false;\n                // }\n                html = '';\n                html += '<div>';\n                html += '<div  class=\"popup_top border_top\">';\n                html += '<span>' + wptmText.import_export_style + ' :</span>';\n                html += '</div>';\n                html += '<span class=\"popup_select style_export wptm_select_box_before\" data-value=\"1\">' + wptmText.import_export_data_styles + '</span>';\n                html += '<ul class=\"wptm_select_box\">';\n                html += '<li data-value=\"1\">' + wptmText.import_export_data_styles + '</li>';\n                html += '<li data-value=\"0\">' + wptmText.import_export_data_only + '</li>';\n                html += '</ul>';\n                html += '<div><input type=\"button\" class=\"wptm_button wptm_done\" value=\"Export excel\" id=\"export_excel\"></div>';\n                html += '</div>';\n                popup = {\n                    'html': $(html),\n                    'selector': {'export_excel': '.style_export'},\n                    'showAction': function () {\n                        custom_select_box.call(this.find('.style_export'), $);\n                    },\n                    'option': {'export_excel': 1},\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, false);\n\n                //Export-excel\n                $('#export_excel').bind('click', function (e) {\n                    var format = default_value.export_excel_format;\n                    var url = wptm_ajaxurl + 'task=excel.export&id=' + idTable + '&format_excel=' + format;\n\n                    url = url + '&onlydata=' + popup.option['export_excel'];\n\n                    $.fileDownload(url, {\n                        failCallback: function (html, url) {\n                            bootbox.alert(html, wptmText.Ok);\n                        }\n                    });\n                });\n                break;\n            case 'source_menu':\n                var curr_page = window.location.href;\n                var cells = curr_page.split(\"?\");\n                var new_url;\n                if (canInsert) {\n                    new_url = cells[0] + '?page=wptm&type=dbtable&id_table=' + idTable + '&noheader=1&caninsert=1';\n                } else {\n                    new_url = cells[0] + '?page=wptm&type=dbtable&id_table=' + idTable;\n                }\n                window.location = new_url;\n                break;\n            case 'access_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#access_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('.wptm_done').addClass('wptm_blu');\n                        this.find('.wptm_cancel').addClass('wptm_grey');\n\n                        if (typeof Wptm.author !== 'undefined' && parseInt(Wptm.author) > 0) {\n                            this.find('#jform_role_table').val(parseInt(Wptm.author)).change();\n                        }\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var author = this.find('#jform_role_table').val();\n                        if (parseInt(author) > 0 && parseInt(author) !== parseInt(Wptm.author)) {//change own category\n                            var jsonVar = {\n                                data: JSON.stringify({0: author}),\n                                id: Wptm.id,\n                                type: 1\n                            };\n                            $.ajax({\n                                url: wptm_ajaxurl + \"task=user.save\",\n                                dataType: \"json\",\n                                type: \"POST\",\n                                data: jsonVar,\n                                beforeSend: function () {\n                                    wptm_element.settingTable.find('.wptm_saving').removeClass('wptm_hiden');\n                                },\n                                success: function (datas) {\n                                    if (datas.response === true) {\n                                        Wptm.author = author;\n                                    } else {\n                                        bootbox.alert(datas.response, wptmText.Ok);\n                                    }\n                                    wptm_element.settingTable.find('.wptm_saving').addClass('wptm_hiden');\n                                },\n                                error: function (jqxhr, textStatus, error) {\n                                    bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n                                }\n                            });\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'select_theme_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#table_styles')\n                };\n\n                wptm_popup(wptm_element.wptm_popup, popup, true);\n\n                wptm_element.wptm_popup.find('#table_styles a').click(function () {\n                    e.preventDefault();\n                    var cellsData = Wptm.container.handsontable('getData');\n                    var ret = true;\n                    var nbCols = 0;\n                    var id = $(this).data('id');\n\n                    //check table data exist\n                    $.each(cellsData, function (index, value) {\n                        nbCols = value.length;\n                        $.each(value, function (i, v) {\n                            if (v && v.toString().trim() !== '') {\n                                ret = false;\n                                return false;\n                            }\n                        });\n                    });\n\n                    change_theme(ret, id, cellsData);\n                })\n                break;\n            case 'alternate_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#alternating_color'),\n                    'showAction': function () {\n                        var selection, reSelection, valueRange;\n                        valueRange = ''\n                        if (Wptm.type === 'mysql') {\n                            Wptm.container.handsontable(\"selectAll\");\n                            selection = $.extend([], function_data.selection[0]);\n                        } else {\n                            if (typeof function_data.selection === 'undefined' || function_data.selection === undefined || function_data.selection === false) { //if unselected cells\n                                var i;\n                                if (_.size(function_data.oldAlternate) < 1 || typeof Wptm.style.table.alternateColorValue === 'undefined') {\n                                    selection = [0, 0, _.size(Wptm.style.cols) - 1, _.size(Wptm.style.rows) - 1];\n                                    valueRange = 'a1:';\n                                    //remove undefined cols in array\n                                    var cols = [];\n                                    for (i = 0; i < _.size(Wptm.style.cols); i++) {\n                                        if (typeof Wptm.style.cols[i] !== 'undefined' && Wptm.style.cols[i] !== undefined && Wptm.style.cols[i] !== null) {\n                                            cols[i] = Wptm.style.cols[i];\n                                        }\n                                    }\n                                    Wptm.style.cols = cols;\n\n                                    valueRange += String.fromCharCode(97 + _.size(Wptm.style.cols) - 1);\n                                    valueRange += _.size(Wptm.style.rows);\n                                }\n                            } else {\n                                selection = $.extend([], function_data.selection[0]);\n                                // check if selecting more than 3 rows then process\n                                var selection_rows = selection[2] - selection[0];\n                                if (selection_rows >= 2) {\n                                    if (_.size(function_data.oldAlternate) >= 1 || typeof Wptm.style.table.alternateColorValue !== 'undefined') {\n                                        for (var i = 0; i < _.size(function_data.oldAlternate); i++) {\n                                            var oldAlternateData = function_data.oldAlternate[i];\n                                            if (oldAlternateData !== false && typeof oldAlternateData.selection !== 'undefined') {\n                                                var isSameSelection = tableFunction.isSameArray(selection, oldAlternateData.selection);\n                                                if (isSameSelection) {\n                                                    var colorData = oldAlternateData.default.split('|');\n                                                    var dftAlternateHeader = colorData[0];\n                                                    var dftAlternateTile1 = colorData[1];\n                                                    var dftAlternateTile2 = colorData[2];\n                                                    var dftAlternateFooter = colorData[3];\n                                                    var currTile = this.find('.pane-color-tile[data-tile-header=\"' + dftAlternateHeader + '\"][data-tile-1=\"' + dftAlternateTile1 + '\"][data-tile-2=\"' + dftAlternateTile2 + '\"][data-tile-footer=\"' + dftAlternateFooter + '\"]');\n                                                    currTile.addClass('active');\n                                                    if (oldAlternateData.header !== '') {\n                                                        this.find('.banding-header-checkbox').trigger('click');\n                                                    }\n                                                    if (oldAlternateData.footer !== '') {\n                                                        this.find('.banding-footer-checkbox').trigger('click');\n                                                    }\n                                                }\n                                            }\n\n                                        }\n                                    }\n                                }\n                            }\n                        }\n\n                        if (function_data.selectionSize > 0) {\n                            selection = $.extend([], function_data.selection[0]);\n                            for (i = 0; i < function_data.selectionSize; i++) {\n                                if (function_data.selection[i][0] < selection[0]) {\n                                    selection[0] = function_data.selection[i][0];\n                                }\n                                if (function_data.selection[i][1] < selection[1]) {\n                                    selection[1] = function_data.selection[i][1];\n                                }\n                                if (function_data.selection[i][2] > selection[2]) {\n                                    selection[2] = function_data.selection[i][2];\n                                }\n                                if (function_data.selection[i][3] > selection[3]) {\n                                    selection[3] = function_data.selection[i][3];\n                                }\n                            }\n                            valueRange += String.fromCharCode(97 + selection[1]) + (selection[0] + 1)\n                                + ':' + String.fromCharCode(97 + selection[3]) + (selection[2] + 1);\n                        }\n\n                        if (valueRange !== '') {\n                            this.find('.cellRangeLabelAlternate').val(valueRange);\n                            this.find('#get_select_cells').trigger('click');\n                        }\n\n                        this.find('.formatting_style .pane-color-tile').on('click', (e) => {\n                            var that = $(e.currentTarget);\n                            //check exist selector and\n                            selection = $.extend([], function_data.selection[0]);\n\n                            if (typeof selection[1] !== 'undefined' && Math.abs(selection[0] - selection[2]) > 1) {\n                                if (Wptm.type === 'mysql') { //alternate for all cell\n                                    function_data.allAlternate = {};\n                                    function_data.allAlternate.even = that.data('tile-1');\n                                    function_data.allAlternate.old = that.data('tile-2');\n                                    function_data.allAlternate.header = that.data('tile-header');\n                                    function_data.allAlternate.footer = that.data('tile-footer');\n                                    function_data.allAlternate.default = '' + function_data.allAlternate.header + '|' + function_data.allAlternate.even + '|' + function_data.allAlternate.old + '|' + function_data.allAlternate.footer;\n\n                                    if (this.find('.banding-header-checkbox:checked').length < 1) {\n                                        function_data.allAlternate.header = '';\n                                    }\n\n                                    if (this.find('.banding-footer-checkbox:checked').length < 1) {\n                                        function_data.allAlternate.footer = '';\n                                    }\n                                    alternating.renderCell();\n                                } else {\n                                    var count = alternating.setNumberAlternate(selection, function_data.oldAlternate);\n\n                                    /*create/reset oldAlternate[count]*/\n                                    function_data.oldAlternate[count] = {};\n                                    function_data.oldAlternate[count].selection = selection;\n                                    function_data.oldAlternate[count].even = that.data('tile-1');\n                                    function_data.oldAlternate[count].old = that.data('tile-2');\n                                    function_data.oldAlternate[count].header = that.data('tile-header');\n                                    function_data.oldAlternate[count].footer = that.data('tile-footer');\n\n                                    function_data.oldAlternate[count].default = '' + function_data.oldAlternate[count].header + '|' + function_data.oldAlternate[count].even + '|' + function_data.oldAlternate[count].old + '|' + function_data.oldAlternate[count].footer;\n\n                                    if (this.find('.banding-header-checkbox:checked').length < 1) {\n                                        function_data.oldAlternate[count].header = '';\n                                    }\n\n                                    if (this.find('.banding-footer-checkbox:checked').length < 1) {\n                                        function_data.oldAlternate[count].footer = '';\n                                    }\n                                    alternating.selectAlternatingColor(function_data.oldAlternate, selection, count),\n                                        alternating.renderCell();\n                                }\n\n                                this.find('.pane-color-tile.active').removeClass('active');\n                                that.addClass('active');\n                            }\n                            return false;\n                        });\n\n                        this.find('.banding-header-footer-checkbox-wrapper input').on('click', (e) => {\n                            selection = $.extend([], function_data.selection[0]);\n                            if (typeof selection[1] !== 'undefined' && Math.abs(selection[0] - selection[2]) > 1) {\n                                if (Wptm.type === 'mysql') { //alternate for all cell\n                                    if (typeof function_data.allAlternate.default !== 'undefined') {\n                                        var defaultStyle = function_data.allAlternate.default.split(\"|\");\n\n                                        if (this.find('.banding-header-checkbox:checked').length > 0) {\n                                            function_data.allAlternate.header = defaultStyle[0];\n                                        } else {\n                                            function_data.allAlternate.header = '';\n                                        }\n\n                                        if (this.find('.banding-footer-checkbox:checked').length > 0) {\n                                            function_data.allAlternate.footer = defaultStyle[3];\n                                        } else {\n                                            function_data.allAlternate.footer = '';\n                                        }\n                                        alternating.renderCell();\n                                    }\n                                } else {\n                                    var oldCount = _.size(function_data.oldAlternate);\n                                    var count = alternating.setNumberAlternate(selection, function_data.oldAlternate);\n                                    if (oldCount !== count) {\n                                        var defaultStyle = [];\n                                        if (typeof function_data.oldAlternate[count].default !== 'undefined') {\n                                            defaultStyle = function_data.oldAlternate[count].default.split(\"|\");\n                                        } else {\n                                            if (this.find('.pane-color-tile.active').length > 0) {\n                                                defaultStyle[0] = this.find('.pane-color-tile.active').find('.pane-color-tile-header').data('value');\n                                                defaultStyle[3] = this.find('.pane-color-tile.active').find('.pane-color-tile-footer').data('value');\n                                            } else {\n                                                defaultStyle[0] = function_data.oldAlternate[count].header;\n                                                defaultStyle[3] = function_data.oldAlternate[count].footer;\n                                            }\n                                        }\n                                        if (this.find('.banding-header-checkbox:checked').length > 0) {\n                                            function_data.oldAlternate[count].header = defaultStyle[0];\n                                        } else {\n                                            function_data.oldAlternate[count].header = '';\n                                        }\n\n                                        if (this.find('.banding-footer-checkbox:checked').length > 0) {\n                                            function_data.oldAlternate[count].footer = defaultStyle[3];\n                                        } else {\n                                            function_data.oldAlternate[count].footer = '';\n                                        }\n\n                                        function_data.oldAlternate[count].default = '' + defaultStyle[0] + '|' + function_data.oldAlternate[count].even + '|' + function_data.oldAlternate[count].old + '|' + defaultStyle[3];\n\n                                        alternating.selectAlternatingColor(function_data.oldAlternate, selection, count),\n                                            alternating.renderCell();\n                                    }\n                                }\n                            }\n                            return true;\n                        });\n\n                        this.find('#alternate_color_done').click((e) => {\n                            e.preventDefault();\n                            alternating.applyAlternate.call(this);\n                        });\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (_.size(function_data.checkChangeAlternate) > 0) {\n                            if (Wptm.type === 'mysql') { //alternate for all cell\n                                function_data.allAlternate = {};\n                            } else {\n                                Wptm.style.cells = $.extend({}, alternating.reAlternateColor());\n                                function_data.oldAlternate = $.extend({}, Wptm.style.table.alternateColorValue);\n                            }\n\n                            alternating.renderCell();\n                        }\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'resize_column':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_size_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        var selection = function_data.selection;\n                        var change_selected = false;\n                        for (var i = 0; i < selection.length; i++) {\n                            if (Wptm.newSelect === 'col') {\n                                if (selection[i][0] !== 0 || selection[i][2] !== Wptm.max_row - 1) {\n                                    function_data.selection.splice(i, 1);\n                                    change_selected = true;\n                                }\n                            }\n                        }\n\n                        this.find('#jform_row_height-lbl').closest('.control-group').addClass('wptm_hiden');\n                        this.find('.popup_top span').text(wptmContext.columns_width_start);\n                        if (function_data.selectionSize > 1) {\n                            this.find('#jform_col_width-lbl').text(wptmContext.columns_width_start);\n                        }\n\n                        if (function_data.selectionSize < 2) {\n                            if (selection[0][1] !== selection[0][3]) {//columns\n                                var text = [];\n                                if (selection[0][1] > 25) {\n                                    text[0] = String.fromCharCode(65) + String.fromCharCode(65 + selection[0][1] - 26);\n                                } else {\n                                    text[0] = String.fromCharCode(65 + selection[0][1]);\n                                }\n                                if (selection[0][3] > 25) {\n                                    text[1] = String.fromCharCode(65) + String.fromCharCode(65 + selection[0][3] - 26);\n                                } else {\n                                    text[1] = String.fromCharCode(65 + selection[0][3]);\n                                }\n                                this.find('#jform_col_width-lbl')\n                                    .text(wptmContext.columns_width_start + text[0] + '-' + text[1]);\n                            }\n                        }\n\n                        this.find('.cellRangeLabelAlternate').addClass('select_column').data('text_change', '#jform_col_width-lbl');\n                        if (change_selected) {\n                            $(Wptm.container).handsontable(\"selectCells\", function_data.selection);\n                            tableFunction.getSelectedVal(function_data.selection[selection.length - 1], this.find('.cellRangeLabelAlternate'));\n                        }\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var col_width_val = this.find('#cell_col_width').val();\n                        selection = function_data.selection;\n                        var i = -1;\n                        var ii = 0;\n                        if (typeof selection !== 'undefined' && selection !== undefined && function_data.selectionSize > 0) {\n                            for (ii = 0; ii < function_data.selectionSize; ii++) {\n                                for (i = selection[ii][1]; i <= selection[ii][3]; i++) {\n                                    if (typeof Wptm.style.cols[i] === 'undefined' ||  Wptm.style.cols[i] === null) {\n                                        Wptm.style.cols[i] = [i, {width: parseInt(col_width_val)}];\n                                    }\n                                    Wptm.style.cols[i][1].width = parseInt(col_width_val);\n                                }\n                            }\n                            i++;\n                        }\n                        if (i !== -1) { //have changing\n                            table_function_data.needSaveAfterRender = true;\n                            tableFunction.pullDims(Wptm, $);\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        wptm_element.wptm_popup.find('.content').contents().remove();\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'resize_row':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_size_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        var selection = function_data.selection;\n                        var change_selected = false;\n                        for (var i = 0; i < selection.length; i++) {\n                            if (Wptm.newSelect === 'row') {\n                                if (selection[i][1] !== 0 || selection[i][3] !== Wptm.max_Col - 1) {\n                                    function_data.selection.splice(i, 1);\n                                    change_selected = true;\n                                }\n                            }\n                        }\n\n                        this.find('#jform_col_width-lbl').closest('.control-group').addClass('wptm_hiden');\n                        this.find('.popup_top span').text(wptmContext.rows_height_start);\n                        if (Wptm.type === 'mysql') {\n                            this.find('#all_cell_row_height').closest('.control-group').removeClass('wptm_hiden');\n                            this.find('#jform_row_height-lbl').text(wptmContext.row_height + ' (header):');\n                            this.find('#all_cell_row_height').val(Wptm.style.table.allRowHeight);\n                        } else {\n                            if (function_data.selectionSize > 1) {\n                                this.find('#jform_row_height-lbl').text(wptmContext.rows_height);\n                            } else {\n                                if (selection[0][0] !== selection[0][2]) {//rows\n                                    this.find('#jform_row_height-lbl')\n                                        .text(wptmContext.rows_height_start + (selection[0][0] + 1) + '-' + (selection[0][2] + 1));\n                                }\n                            }\n                        }\n\n                        this.find('.cellRangeLabelAlternate').addClass('select_row').data('text_change', '#jform_row_height-lbl')\n                        if (change_selected) {\n                            $(Wptm.container).handsontable(\"selectCells\", function_data.selection);\n                            tableFunction.getSelectedVal(function_data.selection[selection.length - 1], this.find('.cellRangeLabelAlternate'));\n                        }\n                        return true;\n                    },\n                    'submitAction': function () {\n                        var row_height_val = this.find('#cell_row_height').val();\n                        var all_row_height_val = this.find('#all_cell_row_height').val();\n                        selection = function_data.selection;\n                        var i = -1;\n                        var ii = 0;\n                        if (typeof selection !== 'undefined' && selection !== undefined && function_data.selectionSize > 0) {\n                            for (ii = 0; ii < function_data.selectionSize; ii++) {\n                                for (i = selection[ii][0]; i <= selection[ii][2]; i++) {\n                                    if (Wptm.type !== 'mysql') {\n                                        if (typeof Wptm.style.rows[i] === 'undefined') {\n                                            Wptm.style.rows[i] = [i, {height: parseInt(row_height_val)}];\n                                        }\n                                        Wptm.style.rows[i][1].height = parseInt(row_height_val);\n                                    }\n                                }\n                            }\n                            if (Wptm.type == 'mysql') {\n                                Wptm.style.rows[0][1].height = row_height_val;\n                                var all_heigt = parseFloat(all_row_height_val);\n                                for (i = 1; i < Wptm.max_row; i++) {\n                                    if (typeof Wptm.style.rows[i] === 'undefined') {\n                                        Wptm.style.rows[i] = [i, {height: all_heigt}];\n                                    }\n                                    Wptm.style.rows[i][1].height = all_heigt;\n                                }\n                                Wptm.style.table = tableFunction.fillArray(Wptm.style.table, {allRowHeight: all_heigt});\n                            }\n                            i++;\n                        }\n                        if (i !== -1) { //have changing\n                            table_function_data.needSaveAfterRender = true;\n                            tableFunction.pullDims(Wptm, $);\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        wptm_element.wptm_popup.find('.content').contents().remove();\n                        return true;\n                    }\n                };\n                if (Wptm.type === 'mysql') {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, false);\n                } else {\n                    wptm_popup(wptm_element.wptm_popup, popup, true, true);\n                }\n                break;\n            case 'header_option_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#header_option'),\n                    'showAction': function() {\n                        var length = -1;\n                        for (var i = 4; i > 0; i--) {\n                            if (typeof Wptm.datas[i] !== 'undefined') {\n                                for (var ii = 0; ii < Wptm.datas[i].length; ii++) {\n                                    if (Wptm.datas[i][ii] !== '') {\n                                        length = i;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (length > -1) {\n                                break;\n                            }\n                        }\n                        this.find('#number_first_rows').next().find('li[data-value=' + (length + 1) + ']').nextAll().hide();\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm, 'headerOption', this.find('#number_first_rows').next('.wptm_select_box'), length + 1 > 0 ? 1 : 0);\n                        if (Wptm.type == 'mysql') {\n                            this.find('#number_first_rows').addClass('no_active');\n                        } else {\n                            custom_select_box.call(this.find('#number_first_rows'), $);\n                        }\n                        //freeze_row\n                        var freeze_row = parseInt(Wptm.style.table.freeze_row) > 0 ? 1 : 0;\n                        tableFunction.updateSwitchButtonFromStyleObject({'freeze_row': freeze_row}, 'freeze_row', this.find('#freeze_row'), '0');\n                    },\n                    'submitAction': function () {\n                        if (Wptm.type !== 'mysql') {\n                            if (this.find('#number_first_rows').data('value') !== '') {\n                                if (this.find('#number_first_rows').data('value') != Wptm.headerOption) {\n                                    saveData.push({\n                                        action: 'set_header_option',\n                                        value: this.find('#number_first_rows').data('value')\n                                    });\n                                }\n                                Wptm.headerOption = parseInt(this.find('#number_first_rows').data('value'));\n                            }\n                        }\n\n                        Wptm.style.table.freeze_row = this.find(\"#freeze_row\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.freeze_row > 0) {\n                            $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: Wptm.headerOption});\n                        } else {\n                            $(Wptm.container).handsontable('updateSettings', {fixedRowsTop: 0});\n                        }\n\n                        tableFunction.saveChanges(true);\n                        this.siblings('.colose_popup').trigger('click');\n\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'sort_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#sortable_table'),\n                    'showAction': function () {\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'use_sortable', this.find('#use_sortable'), '0');\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'default_order_sortable', this.find('#default_order_sortable').next('.wptm_select_box'), '');\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'default_sortable', this.find('#default_sortable').next('.wptm_select_box'), '');\n                        custom_select_box.call(this.find('#default_order_sortable'), $);\n                        custom_select_box.call(this.find('#default_sortable'), $);\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.use_sortable = this.find(\"#use_sortable\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.use_sortable == 1) {\n                            wptm_element.primary_toolbars.find('.sort_menu').parent().addClass('selected');\n                        } else {\n                            wptm_element.primary_toolbars.find('.sort_menu').parent().removeClass('selected');\n                        }\n\n                        if (this.find('#default_order_sortable').data('value') !== '') {\n                            Wptm.style.table.default_order_sortable = this.find('#default_order_sortable').data('value');\n                        }\n                        Wptm.style.table.default_sortable = this.find('#default_sortable').data('value');\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'download_button_menu':\n                if ($(this).parent().hasClass('selected')) {\n                    Wptm.style.table.download_button = 0;\n                    $(this).parent().removeClass('selected');\n                } else {\n                    Wptm.style.table.download_button = 1;\n                    $(this).parent().addClass('selected');\n                }\n                tableFunction.saveChanges(true);\n                break;\n            case 'filters_menu':\n                if ($(this).parent().hasClass('selected')) {\n                    Wptm.style.table.enable_filters = 0;\n                    $(this).parent().removeClass('selected');\n                } else {\n                    Wptm.style.table.enable_filters = 1;\n                    $(this).parent().addClass('selected');\n                }\n                tableFunction.saveChanges(true);\n                break;\n            case 'column_type_menu':\n                tableFunction.default_sortable(window.Wptm.datas);\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#column_type_table'),\n                    'showAction': function () {\n                        var col_types = Wptm.style.table.col_types;\n\n                        this.find('tbody tr').each(function () {\n                            var i = $(this).data('col');\n                            col_types[i] = typeof col_types[i] !== 'undefined' ? col_types[i].toLowerCase() === 'varchar(255)' ? 'varchar' : col_types[i].toLowerCase() : 'varchar';\n                            if (Wptm.type === 'mysql') {\n                                $(this).find('.wptm_select_box_before').addClass('no_active').text(col_types[i]);\n                            } else {\n                                tableFunction.updateParamFromStyleObjectSelectBox(col_types, i, $(this).find('.wptm_select_box'), 'varchar');\n                                custom_select_box.call($(this).find('.column_type'), $);\n                            }\n                        });\n                    },\n                    'submitAction': function () {\n                        var cols_selected = [];\n                        if (Wptm.type !== 'mysql') {\n                            this.find('tbody tr').each(function () {\n                                var i = $(this).data('col');\n                                var that = $(this).find('.wptm_select_box_before');\n                                if (that.data('value') !== '') {\n                                    if (that.data('value') != Wptm.style.table.col_types[i]) {\n                                        cols_selected[i] = that.data('value');\n                                    }\n                                    Wptm.style.table.col_types[i] = that.data('value');\n                                }\n                            });\n\n                            if (cols_selected.length > 0) {\n                                saveData.push({\n                                    action: 'set_columns_types',\n                                    value: cols_selected\n                                });\n                            }\n                            tableFunction.cleanHandsontable();\n                            tableFunction.saveChanges(true);\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'responsive_menu':\n                tableFunction.default_sortable(window.Wptm.datas);\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#responsive_table'),\n                    'selector': {\n                        'responsive_type': '#responsive_type',\n                        'table_breakpoint': '.table_breakpoint',\n                        'table_height': '.table_height',\n                        'freeze_col': '#freeze_col',\n                        'responsive_col': '#responsive_col',\n                        'style_repeated': '#style_repeated',\n                        'responsive_priority': '#responsive_priority'\n                    },\n                    'option': {\n                        'responsive_type': Wptm.style.table.responsive_type,\n                        'freeze_col': Wptm.style.table.freeze_col,\n                        'table_height': Wptm.style.table.table_height,\n                        'style_repeated': Wptm.style.table.style_repeated,\n                        'table_breakpoint': Wptm.style.table.table_breakpoint,\n                    },\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'responsive_type', this.find('#responsive_type').next('.wptm_select_box'), 'scroll');\n                        custom_select_box.call(this.find('#responsive_type'), $);\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'freeze_col', this.find('#freeze_col').next('.wptm_select_box'), '0');\n                        custom_select_box.call(this.find('#freeze_col'), $);\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(popup.option, 'style_repeated', this.find('#style_repeated').next('.wptm_select_box'), '0');\n                        custom_select_box.call(this.find('#style_repeated'), $);\n\n                        tableFunction.updateParamFromStyleObject(popup.option, 'table_height', this.find('.table_height'), '0');\n                        tableFunction.updateParamFromStyleObject(popup.option, 'table_breakpoint', this.find('.table_breakpoint'), '980');\n\n                        this.find('table tr .responsive_priority').each(function () {\n                            custom_select_box.call($(this), $);\n                        });\n\n                        popup.inputAction.call(this, 'responsive_type');\n                        check_saving = false;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.responsive_type = this.find('#responsive_type').data('value');\n                        Wptm.style.table.freeze_col = this.find(\"#freeze_col\").data('value');\n                        Wptm.style.table.style_repeated = this.find(\"#style_repeated\").data('value');\n                        Wptm.style.table.table_height = popup.option.table_height;\n                        Wptm.style.table.table_breakpoint = popup.option.table_breakpoint;\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    },\n                    'inputAction': function (selector) {\n                        if (selector === 'responsive_type') {\n                            if (popup.option.responsive_type === 'scroll') {\n                                this.find('.hiding').hide();\n                                this.find('.repeatedHeader').hide();\n                                this.find('.scrolling').show();\n                            }\n\n                            if (popup.option.responsive_type === 'repeatedHeader') {\n                                this.find('.hiding').hide();\n                                this.find('.scrolling').hide();\n                                this.find('.repeatedHeader').show();\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: false,\n                                    fixedColumnsLeft: 0\n                                });\n                            }\n\n                            if (popup.option.responsive_type === 'hideCols') {\n                                this.find('.hiding').show();\n                                this.find('.scrolling').hide();\n                                this.find('.repeatedHeader').hide();\n\n                                tableFunction.responsive_col.call(this.find('#responsive_col'), Wptm);\n                            }\n                        }\n\n                        //scrolling\n                        if (selector === 'freeze_col') {\n                            if (parseInt(popup.option.freeze_col) === 0) {\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: false,\n                                    fixedColumnsLeft: 0\n                                });\n                            } else {\n                                $(Wptm.container).handsontable('updateSettings', {\n                                    manualColumnFreeze: true,\n                                    fixedColumnsLeft: popup.option.freeze_col\n                                });\n                            }\n                        }\n\n                        for (var i = 0; i < _.size(Wptm.style.cols); i++) {\n                            if(typeof Wptm.style.cols[i] !== 'undefined' && Wptm.style.cols[i] !== null) {\n                                var col_priority = typeof Wptm.style.cols[i][1].res_priority !== 'undefined' ? Wptm.style.cols[i][1].res_priority: 0;\n                                if (typeof col_priority !== 'undefined') {\n                                    var curr_col = wptm_element.wptm_popup.find('table tbody tr').eq(i);\n                                    curr_col.find('.responsive_priority').text(col_priority).data('value', col_priority);\n                                }\n                            }\n                        }\n                        $('.responsive_priority').unbind('change').on('change', (e) => {\n                            var col = $(e.target).closest('tr').data('col');\n\n                            if (typeof Wptm.style.cols[col] !== 'undefined' && Wptm.style.cols[col] !== null && $(e.target).val() !== Wptm.style.cols[col].res_priority) {\n                                check_saving = true;\n                            }\n                            Wptm.style.cols = tableFunction.fillArray(Wptm.style.cols, {res_priority: $(e.target).data('value')}, col);\n                        });\n                    },\n                    'cancelAction': function () {\n                        for (var key in popup.option) {\n                            if (popup.option[key] !== Wptm.style.table[key]) {\n                                check_saving = false;\n                                break;\n                            }\n                        }\n                        if (check_saving) {\n                            Wptm.style.table = $.extend({}, Wptm.style.table, popup.option), tableFunction.saveChanges();\n                        }\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'pagination_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#pagination_table'),\n                    'showAction': function () {\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'enable_pagination', this.find('#enable_pagination'), '0');\n\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'limit_rows', this.find('#limit_rows').next('.wptm_select_box'), 0);\n                        custom_select_box.call(this.find('#limit_rows'), $);\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.limit_rows = this.find('#limit_rows').data('value');\n                        Wptm.style.table.enable_pagination = this.find(\"#enable_pagination\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.enable_pagination == 1) {\n                            wptm_element.primary_toolbars.find('.pagination_menu').parent().addClass('selected');\n                        } else {\n                            wptm_element.primary_toolbars.find('.pagination_menu').parent().removeClass('selected');\n                        }\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'date_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#date_menu'),\n                    'inputEnter': true,\n                    'render': true,\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'date_formats', this.find('#date_format'), '');\n\n                        this.find('.select_date_format li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var date_format = $(e.currentTarget).addClass('active').data('value');\n                            if (typeof date_format !== 'undefined' && date_format !== '') {\n                                this.find('#date_format').val(date_format);\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (this.find('#date_format').val() !== '') {\n                            Wptm.style.table.date_formats = this.find('#date_format').val();\n                            function_data.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n                        }\n\n                        function_data = tableFunction.createRegExpFormat(function_data, false, Wptm.style.table.date_formats);\n                        table_function_data.needSaveAfterRender = true;\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'date_menu_cell':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#date_menu_cell'),\n                    'inputEnter': true,\n                    'render': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'date_formats', this.find('#date_format'), '');\n\n                        this.find('.select_date_format li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var date_format = $(e.currentTarget).addClass('active').data('value');\n                            if (typeof date_format !== 'undefined' && date_format !== '') {\n                                this.find('.date_formats').val(date_format);\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.date_formats').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {\n                                date_formats: this.find('.date_formats').val(),\n                                date_formats_momentjs: tableFunction.momentjsFormat(this.find('.date_formats').val())});\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'lock_ranger_cells':\n                if (wptm_administrator !== 1) {\n                    break;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#lock_ranger_cells'),\n                    'inputEnter': true,\n                    'render': true,\n                    'current_rangers': null,\n                    'current_rangers_user': null,\n                    'showAction': function () {\n                        var current_rangers_user_defalt = this.find('.wptm_select_box').find('li:first').data('value');\n                        custom_select_box.call(this.find('#jform_role_can_edit_lock'), $, null, true);\n                        tableFunction.updateParamFromStyleObjectSelectBox('', 0, this.find('#jform_role_can_edit_lock').next('.wptm_select_box'),  current_rangers_user_defalt, null, true);\n\n                        // wptm_element.wptm_popup.find('.content .control-group:first').after(window.wptm_element.content_popup_hide.find('#select_cells').clone());\n                        var function_data = window.table_function_data;\n                        if (typeof function_data.selection !== 'undefined' && function_data.selection[0] !== undefined && _.size(function_data.selection[0]) > 0) {\n                            var selection = function_data.selection[0];\n                            if (selection[0] == 0 && selection[2] == Wptm.max_row - 1) {\n                                tableFunction.getSelectedVal([false, selection[1], false, selection[3]], this.find('.cellRangeLabelAlternate'));\n                            } else {\n                                if (selection[1] == 0 && selection[3] == Wptm.max_Col - 1) {\n                                    tableFunction.getSelectedVal([selection[0], false, selection[2], false], this.find('.cellRangeLabelAlternate'));\n                                } else {\n                                    tableFunction.getSelectedVal(selection, this.find('.cellRangeLabelAlternate'));\n                                }\n                            }\n                        }\n\n                        this.find('#get_select_cells').val(wptmText.Save_range);\n\n                        var current_ranger = null;\n                        if (typeof Wptm.style.table.lock_ranger_cells !== 'undefined') {\n                            $.each(Wptm.style.table.lock_ranger_cells, (i, v) => {\n                                if (v !== '') {\n                                    var $lock_ranger_cell = this.find('.select_lock_ranger_cells').find('.wptm_hiden').clone();\n                                    $lock_ranger_cell.removeClass('wptm_hiden');\n                                    $lock_ranger_cell.attr('data-value', v).find('.label_text').text(v);\n                                    this.find('.select_lock_ranger_cells').append($lock_ranger_cell);\n                                }\n                            });\n                        } else {\n                            Wptm.style.table.lock_ranger_cells = [];\n                        }\n                        if (typeof Wptm.style.table.lock_ranger_cells_user == 'undefined') {\n                            Wptm.style.table.lock_ranger_cells_user = [];\n                        }\n                        popup.current_rangers = jquery.extend([], Wptm.style.table.lock_ranger_cells);\n                        popup.current_rangers_user = jquery.extend([], Wptm.style.table.lock_ranger_cells_user);\n\n                        this.find('.cellRangeLabelAlternate').unbind('keyup').on('click', function (e) {\n                            e.preventDefault();\n                            return false;\n                        });\n                        var select_ranger = () => {\n                            //select\n                            this.find('.select_lock_ranger_cells').find('.nfd-format-pill:not(.wptm_hiden)').unbind('click').on('click', (e) => {\n                                if (!$(e.target).hasClass('delete_range')) {\n                                    $(e.currentTarget).siblings('.nfd-format-pill.active').removeClass('active');\n                                    current_ranger = popup.current_rangers.indexOf($(e.currentTarget).find('.label_text').text());\n                                    this.find('.cellRangeLabelAlternate').val(popup.current_rangers[current_ranger]);\n                                    alternating.affterRangeLabe.call(this, window.Wptm, window.jquery);\n                                    $(e.currentTarget).addClass('active');\n                                    // jform_role_can_edit_lock\n                                    tableFunction.updateParamFromStyleObjectSelectBox(popup.current_rangers_user, current_ranger, this.find('#jform_role_can_edit_lock').next('.wptm_select_box'), current_rangers_user_defalt, null, true);\n\n                                    // this.find('#popup_done').addClass('not_active');\n                                }\n                            });\n\n                            //delete\n                            this.find('.select_lock_ranger_cells').find('.nfd-format-pill:not(.wptm_hiden) .delete_range').unbind('click').on('click', (e) => {\n                                e.preventDefault();\n                                current_ranger = popup.current_rangers.indexOf(this.find('.cellRangeLabelAlternate').val());\n                                var $li = $(e.currentTarget).parents('.nfd-format-pill');\n\n                                if ($li.hasClass('active')) {\n                                    $li.removeClass('active');\n                                    this.find('.cellRangeLabelAlternate').val('');\n                                }\n                                popup.current_rangers.splice(current_ranger, 1);\n                                popup.current_rangers_user.splice(current_ranger, 1);\n                                $li.remove();\n                                tableFunction.updateParamFromStyleObjectSelectBox('', current_ranger, this.find('#jform_role_can_edit_lock').next('.wptm_select_box'),  current_rangers_user_defalt, null, true);\n\n                                // this.find('#popup_done').removeClass('not_active');\n                            });\n                        }\n\n                        //apply\n                        this.find('#get_select_cells').unbind('click').on('click', () => {\n                            alternating.affterRangeLabe.call(this, window.Wptm, window.jquery);\n                            var ranger = this.find('.cellRangeLabelAlternate').val();\n\n                            if (ranger !== '') {\n                                var value = ranger.replace(/[ ]+/g, \"\").toUpperCase();\n                                var arrayRange = value.split(\":\");\n                                if (arrayRange.length < 2) {\n                                    ranger += ':' + ranger;\n                                } else if (arrayRange.length > 2) {\n                                    return false;\n                                }\n                                var data_role_can_edit_lock = this.find('#jform_role_can_edit_lock').data('value');\n                                if (current_ranger == null) {//new\n                                    this.find('.nfd-format-pill.active').removeClass('active');\n                                    var $lock_ranger_cell1 = this.find('.select_lock_ranger_cells').find('.wptm_hiden').clone();\n                                    $lock_ranger_cell1.removeClass('wptm_hiden').addClass('active');\n                                    $lock_ranger_cell1.attr('data-value', ranger).find('.label_text').text(ranger);\n                                    this.find('.select_lock_ranger_cells').append($lock_ranger_cell1);\n                                    popup.current_rangers.push(ranger);\n                                    popup.current_rangers_user.push(data_role_can_edit_lock === '' ? 'ADMINISTRATOR' : data_role_can_edit_lock);\n                                } else {\n                                    this.find('.select_lock_ranger_cells').find('.nfd-format-pill.active').attr('data-value', ranger).find('.label_text').text(ranger);\n                                    popup.current_rangers[current_ranger] = ranger;\n                                    popup.current_rangers_user[current_ranger] = data_role_can_edit_lock === '' ? 'ADMINISTRATOR' : data_role_can_edit_lock;\n                                }\n                            }\n                            // this.find('#popup_done').removeClass('not_active');\n\n                            this.find('.cellRangeLabelAlternate').val('');\n                            this.find('.nfd-format-pill.active').removeClass('active');\n                            current_ranger = null;\n                            select_ranger();\n                        });\n\n                        select_ranger();\n\n                        return true;\n                    },\n                    'submitAction': function () {\n                        this.find('#get_select_cells').trigger('click');\n                        setTimeout( () => {\n                            Wptm.style.table.lock_ranger_cells = jquery.extend([], popup.current_rangers);\n                            Wptm.style.table.lock_ranger_cells_user = jquery.extend([], popup.current_rangers_user);\n                            this.siblings('.colose_popup').trigger('click');\n                            tableFunction.saveChanges(true);\n                        }, 200);\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        Wptm.style.table.lock_ranger_cells = jquery.extend([], popup.current_rangers);\n                        Wptm.style.table.lock_ranger_cells_user = jquery.extend([], popup.current_rangers_user);\n                        tableFunction.saveChanges(true);\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, false);\n                break;\n            case 'curency_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#curency_menu'),\n                    'render': true,\n                    'inputEnter': true,\n                    'selector': {\n                        'symbol_position': '#symbol_position'\n                    },\n                    'option': {\n                        'symbol_position': Wptm.style.table.symbol_position\n                    },\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'currency_symbol', this.find('#currency_symbol'), '');\n                        tableFunction.updateParamFromStyleObjectSelectBox(Wptm.style.table, 'symbol_position', this.find('#symbol_position').next('.wptm_select_box'), '');\n                        custom_select_box.call(this.find('#symbol_position'), $);\n\n                        this.find('.select_curency_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var currency_symbol = $(e.currentTarget).addClass('active').data('currency_sym');\n                            if (typeof currency_symbol !== 'undefined' && currency_symbol !== '') {\n                                this.find('#currency_symbol').val(currency_symbol);\n                            }\n\n                            var symbol_position = $(e.currentTarget).data('symbol_position');\n                            if (typeof symbol_position !== 'undefined' && symbol_position !== '') {\n                                this.find('#symbol_position').data('value', symbol_position).text(symbol_position == 1 ? 'After': 'Before').change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (this.find('#currency_symbol').val() !== '') {\n                            Wptm.style.table.currency_symbol = this.find('#currency_symbol').val();\n                        }\n                        function_data = tableFunction.createRegExpFormat(function_data, Wptm.style.table.currency_symbol, false);\n\n                        Wptm.style.table = $.extend({}, Wptm.style.table, popup.option);\n                        table_function_data.needSaveAfterRender = true;\n                        tableFunction.setFormat_accounting();\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'curency_menu_cell':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#curency_menu_cell'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        custom_select_box.call(this.find('.symbol_position'), $);\n\n                        this.find('.select_curency_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var currency_symbol = $(e.currentTarget).addClass('active').data('currency_sym');\n                            if (typeof currency_symbol !== 'undefined' && currency_symbol !== '' && currency_symbol !== false) {\n                                this.find('.currency_symbol').val(currency_symbol);\n                            }\n\n                            var symbol_position = $(e.currentTarget).data('symbol_position');\n                            if (typeof symbol_position !== 'undefined' && symbol_position !== '' && symbol_position !== false) {\n                                this.find('.symbol_position').data('value', symbol_position).text(symbol_position == 1 ? 'After': 'Before').change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.currency_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {currency_symbol: this.find('.currency_symbol').val(), currency_symbol_second: null});\n                        }\n\n                        if (typeof this.find('.symbol_position').data('value') !== 'undefined' && this.find('.symbol_position').data('value') !== '') {\n                            tableFunction.getFillArray(selection, Wptm, {symbol_position: this.find('.symbol_position').data('value'), symbol_position_second: null});\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'decimal_menu':\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#decimal_menu'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'thousand_symbol', this.find('#thousand_symbol'), '');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'decimal_symbol', this.find('#decimal_symbol'), '');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'decimal_count', this.find('#decimal_count'), '');\n                        this.find('.select_decimal_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var thousand_symbol = $(e.currentTarget).addClass('active').data('thousand_symbol');\n                            if (typeof thousand_symbol !== 'undefined') {\n                                this.find('#thousand_symbol').val(thousand_symbol).change();\n                            }\n\n                            var decimal_symbol = $(e.currentTarget).data('decimal_symbol');\n                            if (typeof decimal_symbol !== 'undefined') {\n                                this.find('#decimal_symbol').val(decimal_symbol).change();\n                            }\n\n                            var decimal_count = $(e.currentTarget).data('decimal_count');\n                            if (typeof decimal_count !== 'undefined' && decimal_count !== '') {\n                                this.find('#decimal_count').val(decimal_count).change();\n                            } else {\n                                this.find('#decimal_count').val(0).change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('#decimal_symbol').val() !== 'undefined') {\n                            Wptm.style.table.decimal_symbol = this.find('#decimal_symbol').val();\n                        }\n                        if (typeof this.find('#decimal_count').val() !== 'undefined') {\n                            Wptm.style.table.decimal_count = this.find('#decimal_count').val() == '' ? 0: this.find('#decimal_count').val();\n                        }\n                        if (typeof this.find('#thousand_symbol').val() !== 'undefined') {\n                            Wptm.style.table.thousand_symbol = this.find('#thousand_symbol').val();\n                        }\n                        table_function_data.needSaveAfterRender = true;\n                        tableFunction.setFormat_accounting();\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'decimal_menu_cell':\n                if (Wptm.type === 'mysql') {\n                    return true;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#decimal_menu_cell'),\n                    'render': true,\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('#popup_done').val('Apply');\n                        this.find('.select_decimal_menu li').unbind('click').on('click', (e) => {\n                            $(e.currentTarget).siblings('.active').removeClass('active');\n                            var thousand_symbol = $(e.currentTarget).addClass('active').data('thousand_symbol');\n                            if (typeof thousand_symbol !== 'undefined' && thousand_symbol !== false) {\n                                this.find('.thousand_symbol').val(thousand_symbol).change();\n                            }\n\n                            var decimal_symbol = $(e.currentTarget).data('decimal_symbol');\n                            if (typeof decimal_symbol !== 'undefined' && decimal_symbol !== false) {\n                                this.find('.decimal_symbol').val(decimal_symbol).change();\n                            }\n\n                            var decimal_count = $(e.currentTarget).data('decimal_count');\n                            if (typeof decimal_count !== 'undefined' && decimal_count !== '' && decimal_count !== false) {\n                                this.find('.decimal_count').val(decimal_count).change();\n                            } else {\n                                this.find('.decimal_count').val(0).change();\n                            }\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        if (typeof this.find('.decimal_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {decimal_symbol: this.find('.decimal_symbol').val(), decimal_symbol_second: null});\n                        }\n                        if (typeof this.find('.decimal_count').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {decimal_count: this.find('.decimal_count').val() == '' ? 0: this.find('.decimal_count').val(), decimal_count_second: null});\n                        }\n                        if (typeof this.find('.thousand_symbol').val() !== 'undefined') {\n                            tableFunction.getFillArray(selection, Wptm, {thousand_symbol: this.find('.thousand_symbol').val(), thousand_symbol_second: null});\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        tableFunction.saveChanges(true);\n\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'google_sheets_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#google_sheets_menu'),\n                    'show_google_url': function (text_url, $done) {\n                        if (text_url !== '') {\n                            $done.show();\n\n                            if (this.find('#auto_push').is(\":checked\")) {\n                                this.find('#google_url').parent().show();\n                            } else {\n                                this.find('#google_url').parent().hide();\n                            }\n                        } else {\n                            $done.hide();\n                        }\n\n                        if (typeof Wptm.syn_hash !== 'undefined' && Wptm.syn_hash !== '') {\n                            this.find('#google_url').val(Wptm.syn_hash);\n                        } else {\n                            this.find('#google_url').val('' + Wptm.id + tableFunction.hashFnv32a());\n                        }\n\n                        var text = 'function send' + Wptm.id + 'sheetspush() {\\n var response = UrlFetchApp.fetch(\"'\n                            + wptm_ajaxurl_site + 'task=sitecontrol.scriptGoogle&id_table=' + Wptm.id + '&wptmhash=' + this.find('#google_url').val() + '\");\\n}';\n                        this.find('.wptm_copy_text_content').text(text);\n\n                        this.find('#google_url').siblings('.copy_text').unbind('click').on('click', (e) => {\n                            tableFunction.copy_text($(e.target), this.find('.wptm_copy_text_content').val());\n                            this.find('.wptm_copied').show().animate({opacity: '1'}, \"slow\").delay(1000).animate({'opacity': '0'}, 10);\n                        });\n                    },\n                    'showAction': function () {\n                        this.find('#fetch_browse').hide();\n                        this.find('#jform_excel_url-lbl').hide();\n                        this.find('#import_style').parent().hide();\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_sync', this.find('#auto_sync'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'spreadsheet_style', this.find('#spreadsheet_style'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_push', this.find('#auto_push'), '0');\n\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'spreadsheet_url', this.find('#spreadsheet_url'), '');\n                        check_saving = 0;\n\n                        popup.show_google_url.call(this, Wptm.style.table.spreadsheet_url, this.find('#google_url').closest('.control-group'));\n                        this.find('#spreadsheet_url').on('keyup', (e) => {\n                            popup.show_google_url.call(this, $(e.currentTarget).val(), this.find('#google_url').closest('.control-group'));\n                        });\n\n                        this.find('#auto_push').on('change', (e) => {\n                            popup.show_google_url.call(this, this.find('#spreadsheet_url').val(), this.find('#google_url').parent());\n                        });\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.spreadsheet_url = this.find(\"#spreadsheet_url\").val();\n                            if (Wptm.style.table.spreadsheet_url === '' || Wptm.style.table.spreadsheet_url === undefined) {\n                                return false;\n                            }\n\n                            Wptm.style.table.spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                            if (Wptm.style.table.auto_sync === 1) {\n                                Wptm.style.table.excel_auto_sync = 0;\n                            }\n\n                            Wptm.style.table.auto_push = this.find(\"#auto_push\").is(\":checked\") ? 1 : 0;\n\n                            var data = {'type': 'spreadsheet'};\n                            table_function_data.fetch_data = data;\n\n                            if (this.find('#google_url').val() !== '') {\n                                Wptm.syn_hash = this.find('#google_url').val();\n                            } else {\n                                Wptm.syn_hash = '' + Wptm.id + tableFunction.hashFnv32a();\n                            }\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.spreadsheet_url = this.find(\"#spreadsheet_url\").val();\n\n                        Wptm.style.table.spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n\n                        Wptm.style.table.auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.auto_sync === 1) {\n                            Wptm.style.table.excel_auto_sync = 0;\n                        }\n\n                        Wptm.style.table.auto_push = this.find(\"#auto_push\").is(\":checked\") ? 1 : 0;\n\n                        check_saving = 1;\n\n                        if (this.find('#google_url').val() !== '') {\n                            Wptm.syn_hash = this.find('#google_url').val();\n                        }\n\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (check_saving === 1) {\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    },\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'onedrive_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#onedrive_menu'),\n                    'showAction': function () {\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'onedrive_style', this.find('#onedrive_style'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'auto_sync_onedrive', this.find('#auto_sync_onedrive'), '0');\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'onedrive_url', this.find('#onedrive_url'), '');\n                        check_saving = 0;\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.onedrive_url = this.find(\"#onedrive_url\").val();\n                            var dataSync = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', true);\n                            Wptm.style.table.onedrive_url = dataSync.url;\n\n                            if (!dataSync) {\n                                return false;\n                            }\n\n                            Wptm.style.table.onedrive_style = this.find(\"#onedrive_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.auto_sync_onedrive = this.find(\"#auto_sync_onedrive\").is(\":checked\") ? 1 : 0;\n\n                            var data = {'type': 'onedrive'};\n                            table_function_data.fetch_data = data;\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.onedrive_url = this.find(\"#onedrive_url\").val();\n                        Wptm.style.table.onedrive_style = this.find(\"#onedrive_style\").is(\":checked\") ? 1 : 0;\n                        Wptm.style.table.auto_sync_onedrive = this.find(\"#auto_sync_onedrive\").is(\":checked\") ? 1 : 0;\n\n                        check_saving = 1;\n\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        if (check_saving === 1) {\n                            var dataSync = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', false);\n                            Wptm.style.table.onedrive_url = dataSync.url;\n\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    },\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'synchronization_menu':\n                if (Wptm.type == 'mysql') {\n                    return false;\n                }\n                popup = {\n                    'html': wptm_element.content_popup_hide.find('#google_sheets_menu'),\n                    'inputEnter': true,\n                    'showAction': function () {\n                        this.find('#google_url').parent().hide();\n                        this.find('#jform_spreadsheet_url-lbl').hide();\n                        this.find(\"#auto_push\").closest('.push-notification-group').hide();\n                        if (typeof default_value.enable_import_excel !== 'undefined'\n                            && default_value.enable_import_excel == '1') {\n                            this.find('#google_sheets_menu .control-group').eq(0).before(wptm_element.content_popup_hide.find('#import_excel'));\n                            this.find('#google_sheets_menu').addClass('excel_syn');\n                        }\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'excel_auto_sync', this.find('#auto_sync'), '0');\n                        tableFunction.updateSwitchButtonFromStyleObject(Wptm.style.table, 'excel_spreadsheet_style', this.find('#spreadsheet_style'), '0');\n\n                        tableFunction.updateParamFromStyleObject(Wptm.style.table, 'excel_url', this.find('#spreadsheet_url'), '');\n                        check_saving = 0;\n\n                        this.find('#fetch_google').unbind('click').on('click', (e) => {\n                            Wptm.style.table.excel_url = this.find(\"#spreadsheet_url\").val();\n                            if (Wptm.style.table.excel_url === '' || Wptm.style.table.excel_url === undefined) {\n                                return false;\n                            }\n\n                            Wptm.style.table.excel_spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n                            Wptm.style.table.excel_auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                            if (Wptm.style.table.excel_auto_sync === 1) {\n                                Wptm.style.table.auto_sync = 0;\n                            }\n\n                            var data = {'type': 'excel'};\n                            table_function_data.fetch_data = data;\n\n                            tableFunction.saveChanges(true);\n                            return true;\n                        });\n\n                        custom_select_box.call(this.find('#import_style'), $);\n                        return true;\n                    },\n                    'submitAction': function () {\n                        Wptm.style.table.excel_auto_sync = this.find(\"#auto_sync\").is(\":checked\") ? 1 : 0;\n                        if (Wptm.style.table.excel_auto_sync === 1) {\n                            Wptm.style.table.auto_sync = 0;\n                        }\n                        Wptm.style.table.excel_spreadsheet_style = this.find(\"#spreadsheet_style\").is(\":checked\") ? 1 : 0;\n\n                        Wptm.style.table.excel_url = this.find(\"#spreadsheet_url\").val();\n\n                        check_saving = 1;\n                        this.siblings('.colose_popup').trigger('click');\n                        return true;\n                    },\n                    'cancelAction': function () {\n                        this.find('#import_excel').appendTo(wptm_element.content_popup_hide);\n                        if (check_saving === 1) {\n                            tableFunction.saveChanges(true);\n                        }\n                        return true;\n                    }\n                };\n                wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n                break;\n            case 'new_chart_menu':\n                DropChart.functions.addChart();\n                break;\n            case 'view_chart_menu':\n                if (Wptm.dataChart.length > 0) {\n                    wptm_element.settingTable.find('.ajax_loading').addClass('loadding').removeClass('wptm_hiden');\n                    $(this).closest('li').addClass('menu_loading');\n                    tableFunction.showChartOrTable(true, jquery('#list_chart').find('.chart-menu').eq(0));\n                } else {\n                    bootbox.alert(wptmText.CHART_NOT_EXIST, wptmText.GOT_IT);\n                }\n                break;\n            case 'editToolTip':\n                var content = $('#tooltip_content').val();\n\n                if (content !== '') {\n                    wptm_element.tableContainer.find('tbody td.current').addClass('isTooltipContent');\n                } else {\n                    wptm_element.tableContainer.find('tbody td.current').removeClass('isTooltipContent');\n                }\n\n                if (typeof content !== 'undefined') {\n                    var i, j;\n                    var selection = table_function_data.selection[0];\n                    var width = $('#tooltip_width').val();\n                    for (i = selection[0]; i <= selection[2]; i++) {\n                        for (j = selection[1]; j <= selection[3]; j++) {\n                            if (width !== '') {\n                                Wptm.style.cells = tableFunction.fillArray(Wptm.style.cells, {\n                                    tooltip_content: content,\n                                    tooltip_width: width\n                                }, i, j);\n                            } else {\n                                Wptm.style.cells = tableFunction.fillArray(Wptm.style.cells, {tooltip_content: content}, i, j);\n                            }\n                            if (i == selection[2] && j == selection[3]) {\n                                saveData.push({action: 'style', selection: table_function_data.selection, style: {\n                                        tooltip_content: content,\n                                        tooltip_width: width\n                                    }});\n                                tableFunction.saveChanges();\n                            }\n                        }\n                    }\n                }\n                break;\n        }\n        return false;\n    });\n\n    //select option in sub-menu(first top menu)\n    wptm_element.primary_toolbars.find('.has_sub_menu ul li').on('change click', function () {\n        if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n            return false;\n        }\n\n        var function_data = window.table_function_data;\n        var Wptm = window.Wptm;\n        var $ = window.jquery;\n        var option_name = $(this).parents('.sub-menu').siblings('.table_option');\n        switch (option_name.attr('name')) {\n            case 'align_menu':\n                Wptm.style.table.table_align = $(this).attr('name').toString();\n                $(this).siblings('.selected').removeClass('selected');\n                $(this).addClass('selected');\n                break;\n        }\n        return true;\n    });\n\n    wptm_element.primary_toolbars.find('a.cell_option').unbind('click').on('click', function (e) {\n        e.preventDefault();\n\n        render = second_menu.call(this, render);\n        clearTimeout(autoRender);\n\n        autoRender = setTimeout(function () {\n            if (render === true) {\n                table_function_data.needSaveAfterRender = true;\n                window.jquery(window.Wptm.container).data('handsontable').render();\n            }\n            render = false;\n        }, 200);\n    });\n\n    wptm_element.primary_toolbars.find('.cell_option').unbind('change').on('change', function (e) {\n        e.preventDefault();\n\n        render = second_menu.call(this, render);\n        clearTimeout(autoRender);\n\n        autoRender = setTimeout(function () {\n            if (render === true) {\n                table_function_data.needSaveAfterRender = true;\n                window.jquery(window.Wptm.container).data('handsontable').render();\n            }\n            render = false;\n        }, 200);\n    });\n\n    //select calculator function\n    wptm_element.primary_toolbars.find('.calculater_function').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (Wptm.type !== 'html') {\n            return;\n        }\n        var $ = window.jquery;\n\n        var selection = $.extend({}, table_function_data.selection);\n        var calculater = $(this).data('calculater');\n\n        tableFunction.change_value_cells(selection, '=' + calculater + '()');\n        var CellValue = document.getElementById('CellValue');\n\n        wptm_element.cellValue.focus().val('=' + calculater + '()');\n\n        if (CellValue) {\n            if (typeof CellValue.setSelectionRange === 'function') {\n                var x = calculater.length + 2;\n                CellValue.setSelectionRange(x, x);\n            }\n            wptm_element.cellValue.click();\n        }\n    });\n\n    //change value cells by #CellValue\n    wptm_element.cellValue.on('keyup', function (e) {\n        if (wptm_element.cellValue.val() !== table_function_data.cellValueChange) {\n            table_function_data.checkCellValueChange = table_function_data.selection;\n        } else {\n            table_function_data.checkCellValueChange = false;\n        }\n        if (e.keyCode === 13 && Wptm.type == 'html') {\n            tableFunction.change_value_cells(table_function_data.selection, wptm_element.cellValue.val());\n            var $ = window.jquery;\n            var selection = table_function_data.selection;\n            table_function_data.checkCellValueChange = false;\n            if (typeof selection[1] === 'undefined'\n                && typeof selection[0][2] !== 'undefined'\n                && selection[0][0] === selection[0][2]\n                && selection[0][1] === selection[0][3]) {\n                if (typeof Wptm.datas[selection[0][0] + 1] === 'undefined') {\n                    $(Wptm.container).handsontable(\"selectCell\", 0, selection[0][1] + 1, 0, selection[0][3] + 1);\n                } else {\n                    $(Wptm.container).handsontable(\"selectCell\", selection[0][0] + 1, selection[0][1], selection[0][2] + 1, selection[0][3]);\n                }\n            }\n        }\n        return true;\n    });\n};\n\n//event change value option in cell_menu\nfunction second_menu(render) {\n    if (!(window.Wptm.can.edit || (window.Wptm.can.editown && data.author === window.Wptm.author))) {\n        return false;\n    }\n\n    if (table_function_data.selectOption) {\n        return false;\n    }\n\n    var re_active = typeof arguments[1] !== 'undefined' && arguments[1] === 're_active' ? true : false;\n\n    var Wptm = window.Wptm;\n    var $ = window.jquery;\n    var value;\n    var parentLi = $(this).parents('.cells_option');\n    var i;\n    table_function_data.option_selected_mysql = '';\n\n    var selection = $.extend({}, table_function_data.selection);\n\n    if (Wptm.type === 'mysql') {\n        for (i = 0; i < table_function_data.selectionSize; i++) {\n            if (selection[i][0] + selection[i][2] !== 0) {//not cell in header\n                selection[i][0] = selection[i][0] > 0 ? 1 : selection[i][0];\n                selection[i][2] = _.size(Wptm.style.rows) - 1;\n                table_function_data.option_selected_mysql = jquery(this).attr('name');\n            }\n        }\n    }\n\n    if (typeof selection[0][1] === 'undefined') {\n        return;\n    }\n\n    switch ($(this).attr('name')) {\n        case 'undo_cell':\n            if ($(this).hasClass('active')) {\n                $(Wptm.container).handsontable('getInstance').undoRedo.undo()\n                render = true;\n            } else {\n                tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n            }\n            break;\n        case 'redo_cell':\n            if ($(this).hasClass('active')) {\n                $(Wptm.container).handsontable('getInstance').undoRedo.redo()\n                render = true;\n            } else {\n                tableFunction.status_notic(1, wptmText.some_action_cant_be_done + '!', $('#undoNotic'));\n            }\n            break;\n        case 'cell_font_family':\n            tableFunction.getFillArray(selection, Wptm, {cell_font_family: $(this).data('value')});\n            render = true;\n            break;\n        case 'cell_font_size':\n            tableFunction.getFillArray(selection, Wptm, {cell_font_size: $(this).val()});\n            render = true;\n            break;\n        case 'cell_format_bold':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n\n            tableFunction.getFillArray(selection, Wptm, {cell_font_bold: value});\n            render = true;\n            break;\n        case 'cell_font_underline':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n            tableFunction.getFillArray(selection, Wptm, {cell_font_underline: value});\n            render = true;\n            break;\n        case 'cell_font_italic':\n            if (parentLi.find('.active').length < 1) {\n                value = true;\n                parentLi.find('.cell_option').addClass('active');\n            } else {\n                value = false;\n                parentLi.find('.active').removeClass('active');\n            }\n            tableFunction.getFillArray(selection, Wptm, {cell_font_italic: value});\n            render = true;\n            break;\n        case 'cell_background_color':\n            value = $(this).val();\n            tableFunction.getFillArray(selection, Wptm, {cell_background_color: value});\n            $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n            render = true;\n            break;\n        case 'cell_font_color':\n            value = $(this).val();\n            tableFunction.getFillArray(selection, Wptm, {cell_font_color: value});\n            $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n            render = true;\n            break;\n        case 'format_align_left':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'left'});\n            render = true;\n            break;\n        case 'format_align_center':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'center'});\n            render = true;\n            break;\n        case 'format_align_right':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'right'});\n            render = true;\n            break;\n        case 'format_align_justify':\n            wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').addClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_text_align: 'justify'});\n            render = true;\n            break;\n        case 'vertical_align_bottom':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'bottom'});\n            render = true;\n            break;\n        case 'vertical_align_middle':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').addClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'middle'});\n            render = true;\n            break;\n        case 'vertical_align_top':\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n            wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').addClass('active');\n            tableFunction.getFillArray(selection, Wptm, {cell_vertical_align: 'top'});\n            render = true;\n            break;\n        case 'padding_border':\n            var popup;\n            popup = {\n                'html': wptm_element.content_popup_hide.find('#padding_border'),\n                'showAction': function () {\n                    var size_selection = table_function_data.selectionSize - 1;\n                    var cellStyle = window.Wptm.style.cells[selection[size_selection][0] + '!' + selection[size_selection][1]][2];\n\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_left', this.find('#jform_cell_padding_left'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_top', this.find('#jform_cell_padding_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_right', this.find('#jform_cell_padding_right'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_padding_bottom', this.find('#jform_cell_padding_bottom'), 0);\n\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_left_top', this.find('#jform_cell_background_radius_left_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_right_top', this.find('#jform_cell_background_radius_right_top'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_right_bottom', this.find('#jform_cell_background_radius_right_bottom'), 0);\n                    tableFunction.updateParamFromStyleObject(cellStyle, 'cell_background_radius_left_bottom', this.find('#jform_cell_background_radius_left_bottom'), 0);\n\n                    this.find('.observeChanges').unbind('change').on('change', (e) => {\n                        var name = $(e.currentTarget).attr('name');\n                        var value = $(e.currentTarget).val();\n                        switch (name) {\n                            case 'jform[jform_cell_padding_left]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_left: value});\n                                break;\n                            case 'jform[jform_cell_padding_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_top: value});\n                                break;\n                            case 'jform[jform_cell_padding_right]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_right: value});\n                                break;\n                            case 'jform[jform_cell_padding_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_padding_bottom: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_left_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_left_top: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_right_top]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_right_top: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_right_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_right_bottom: value});\n                                break;\n                            case 'jform[jform_cell_background_radius_left_bottom]':\n                                tableFunction.getFillArray(selection, Wptm, {cell_background_radius_left_bottom: value});\n                                break;\n                        }\n                    });\n                    return true;\n                },\n                'submitAction': function () {\n                    this.siblings('.colose_popup').trigger('click');\n                    tableFunction.saveChanges();\n                    return true;\n                },\n                'cancelAction': function () {\n                    window.jquery(window.Wptm.container).data('handsontable').render();\n                    return true;\n                }\n            };\n            wptm_popup(wptm_element.wptm_popup, popup, true, false, true);\n            break;\n        case 'cell_type':\n            if (Wptm.type !== 'mysql') {\n                if (parentLi.find('.active').length < 1) {\n                    tableFunction.getFillArray(selection, Wptm, {cell_type: 'html'}, \"set_cells_type\");\n                    parentLi.find('.cell_option').addClass('active');\n\n                    // add cell type == text for column selected\n                    var i, jj;\n                    var cols_selected = [];\n\n                    for (jj = 0; jj < table_function_data.selectionSize; jj++) {\n                        for (i = table_function_data.selection[jj][1]; i <= table_function_data.selection[jj][3]; i++) {\n                            cols_selected[i] = 'text';\n                            Wptm.style.table.col_types[i] = 'text';\n                        }\n                    }\n                    saveData.push({\n                        action: 'set_columns_types',\n                        value: cols_selected\n                    });\n                    tableFunction.saveChanges(true);\n                } else {\n                    tableFunction.getFillArray(selection, Wptm, {cell_type: null}, \"set_cells_type\");\n                    parentLi.find('.active').removeClass('active');\n                }\n                tableFunction.cleanHandsontable();\n                render = true;\n            }\n            break;\n        case 'border_color':\n            value = $(this).val();\n            $(this).parents('.wp-picker-container').find('.wp-color-result').css('color', value);\n            border_cell(selection, Wptm, 'color', render);\n            render = true;\n            break;\n        case 'border_all':\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(selection, Wptm, {cell_border_left: ''});\n                tableFunction.getFillArray(selection, Wptm, {cell_border_top: ''});\n                tableFunction.getFillArray(selection, Wptm, {cell_border_right: ''});\n                tableFunction.getFillArray(selection, Wptm, {cell_border_bottom: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(selection, Wptm, 'position', 'cell_border_left', 'cell_border_top', 'cell_border_right', 'cell_border_bottom');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_top':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][1], selection[i][0], selection[i][3]];\n            }\n            var parameter;\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                parameter = 'cell_border_top_start';\n            } else {\n                parameter = 'cell_border_top';\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                var x = {};\n                x[parameter] = '';\n                tableFunction.getFillArray(border_selection, Wptm, x);\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', parameter);\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_bottom':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][2], selection[i][1], selection[i][2], selection[i][3]];\n            }\n            var parameter;\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                parameter = 'cell_border_bottom_end';\n            } else {\n                parameter = 'cell_border_bottom';\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                var x = {};\n                x[parameter] = '';\n                tableFunction.getFillArray(border_selection, Wptm, x);\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', parameter);\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_left':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][1], selection[i][2], selection[i][1]];\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_left: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_left');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_right':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                border_selection[i] = [selection[i][0], selection[i][3], selection[i][2], selection[i][3]];\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_right: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_horizontal':\n            var border_selection = {};\n\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                if (selection[i][0] === selection[i][2]) {\n                    return false;\n                } else {\n                    border_selection[i] = [selection[i][0], selection[i][1], selection[i][2] - 1, selection[i][3]];\n                }\n            }\n\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_bottom: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_bottom');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_clear':\n            wptm_element.primary_toolbars.find('#cell_border > div > a.cell_option.active').each(function () {\n                jquery(this).removeClass('active');\n            });\n            tableFunction.getFillArray(selection, Wptm, {cell_border_left: ''});\n            tableFunction.getFillArray(selection, Wptm, {cell_border_top: ''});\n            tableFunction.getFillArray(selection, Wptm, {cell_border_right: ''});\n            tableFunction.getFillArray(selection, Wptm, {cell_border_bottom: ''});\n            if (table_function_data.option_selected_mysql !== '' && typeof table_function_data.option_selected_mysql !== 'undefined') {\n                tableFunction.getFillArray(selection, Wptm, {cell_border_top_start: ''});\n                tableFunction.getFillArray(selection, Wptm, {cell_border_bottom_end: ''});\n            }\n\n            // Get cells range above selection\n            var topCellsSelections = {};\n            Object.keys(selection).map(function(key, index) {\n                var x = selection[key][0] - 1 > 0 ? selection[key][0] - 1 : 0;\n                topCellsSelections[key] = [x, selection[key][1], x, selection[key][3]];\n            });\n            tableFunction.getFillArray(topCellsSelections, Wptm, {cell_border_bottom: ''});\n\n            var leftCellsSelections = {};\n            var fillLeftCells = true;\n            Object.keys(selection).map(function(key, index) {\n                var y = selection[key][1] - 1 > 0 ? selection[key][1] - 1 : 0;\n                leftCellsSelections[key] = [selection[key][0], y, selection[key][2], y];\n                if (parseInt(selection[key][1]) === 0) {\n                    fillLeftCells = false;\n                }\n            });\n            if (fillLeftCells) {\n                tableFunction.getFillArray(leftCellsSelections, Wptm, {cell_border_right: ''});\n            }\n\n            render = true;\n            break;\n        case 'border_vertical':\n            var border_selection = {};\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                if (selection[i][1] === selection[i][3]) {\n                    return false;\n                } else {\n                    border_selection[i] = [selection[i][0], selection[i][1], selection[i][2], selection[i][3] - 1];\n                }\n            }\n\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(border_selection, Wptm, {cell_border_right: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(border_selection, Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_inner':\n            var new_selection = [];\n            new_selection['bottom'] = [];\n            new_selection['right'] = [];\n            for (i = 0; i < table_function_data.selectionSize; i++) {\n                new_selection['bottom'][i] = $.extend([], selection[i]);\n                new_selection['right'][i] = $.extend([], selection[i]);\n                if (selection[i][1] === selection[i][3]) {\n                    return false;\n                } else {\n                    new_selection['right'][i][3] = selection[i][3] - 1;\n                }\n                if (selection[i][0] === selection[i][2]) {\n                    return false;\n                } else {\n                    new_selection['bottom'][i][2] = selection[i][2] - 1;\n                }\n            }\n            if ($(this).hasClass('active') && !re_active) {\n                tableFunction.getFillArray(new_selection['right'], Wptm, {cell_border_right: ''});\n                tableFunction.getFillArray(new_selection['bottom'], Wptm, {cell_border_bottom: ''});\n                $(this).removeClass('active');\n            } else {\n                border_cell(new_selection['bottom'], Wptm, 'position', 'cell_border_bottom');\n                border_cell(new_selection['right'], Wptm, 'position', 'cell_border_right');\n                $(this).addClass('active');\n            }\n            render = true;\n            break;\n        case 'border_outer':\n            var val, ij, ik;\n            if ($(this).hasClass('active') && !re_active) {\n                $(this).removeClass('active');\n                val = 'no_active';\n            } else {\n                $(this).addClass('active');\n                val = 'active';\n            }\n\n            $.map(selection, function (v) {\n                if (val === 'no_active') {\n                    for (ij = v[0]; ij <= v[2]; ij++) {\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_right: ''}, ij, v[1] - 1);//before cell\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_right: ''}, ij, v[3]);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_left: ''}, ij, v[3] + 1);//after cell\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_left: ''}, ij, v[1]);\n                    }\n                    for (ik = v[0]; ik <= v[2]; ik++) {\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_top: ''}, v[2] + 1, ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_top: ''}, v[0], ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_bottom: ''}, v[0] - 1, ik);\n                        tableFunction.fillArray(Wptm.style.cells, {cell_border_bottom: ''}, v[2], ik);\n                    }\n                } else {\n                    border_cell([[v[0], v[3], v[2], v[3]]], Wptm, 'position', 'cell_border_right');\n                    border_cell([[v[0], v[1], v[2], v[1]]], Wptm, 'position', 'cell_border_left');\n                    border_cell([[v[2], v[1], v[2], v[3]]], Wptm, 'position', 'cell_border_bottom');\n                    border_cell([[v[0], v[1], v[0], v[3]]], Wptm, 'position', 'cell_border_top');\n                }\n            });\n\n            render = true;\n            break;\n        case 'border_width':\n            border_cell(selection, Wptm, 'border_width', render);\n            render = true;\n            break;\n        case 'border_solid':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'border_dashed':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'border_dotted':\n            $(this).siblings('.border_style.active').removeClass('active');\n            $(this).addClass('active');\n            border_cell(selection, Wptm, 'border_style', render);\n\n            render = true;\n            break;\n        case 'merge_cell':\n            if (Wptm.type !== 'mysql') {\n                if ((selection[0][3] - selection[0][1] + selection[0][2] - selection[0][0]) < 1) {\n                    return false;\n                }\n                if (table_function_data.selectionSize > 1) {//if selection > 1 when not merge and select selection[0]\n                    $(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][2], selection[0][3]);\n                    return false;\n                }\n                if ($(this).hasClass('active')) {\n                    $(Wptm.container).handsontable('getInstance').getPlugin('mergeCells').unmergeSelection();\n                    $(this).removeClass('active');\n                } else {\n                    $(Wptm.container).handsontable('getInstance').getPlugin('mergeCells').mergeSelection();\n                    $(this).addClass('active');\n                }\n            }\n            break;\n    }\n    return render;\n}\n\n/**\n * Convert border value for cell\n *\n * @param selection Selected cells\n * @param Wptm\n */\nfunction border_cell(selection, Wptm) {\n    var border_color = wptm_element.primary_toolbars.find('#border_color').val();\n    if (typeof border_color === 'undefined' || border_color === '') {\n        border_color = 'rgba(0, 0, 0, 0)';\n    }\n    var cell_border_style = 'solid';\n    switch (wptm_element.primary_toolbars.find('#cell_border_style a.border_style.active').attr('name')) {\n        case 'border_solid':\n            cell_border_style = 'solid';\n            break;\n        case 'border_dashed':\n            cell_border_style = 'dashed';\n            break;\n        case 'border_dotted':\n            cell_border_style = 'dotted';\n            break;\n    }\n\n    var width = '1';\n    var cell_border_width = wptm_element.primary_toolbars.find('#cell_border_width').val();\n    width = cell_border_width !== '' ? cell_border_width : '1';\n\n    var position = [];\n    if (arguments[2] !== 'position') {\n        position = wptm_element.primary_toolbars.find('#cell_border > div > a.cell_option.active').each(function () {\n            second_menu.call(jquery(this), arguments[3], 're_active');\n        });\n        return false;\n    } else {\n        position = Array.prototype.slice.call(arguments, 3);\n    }\n    position.map(function (foo) {\n        var value = {};\n        value[foo] = '' + width + 'px ' + cell_border_style + ' ' + border_color;\n        switch (foo) {\n            case 'cell_border_top':\n                // Get cells range above selection\n                var topCellsSelections = {};\n                var topCellsSelections2;\n                tableFunction.getFillArray(selection, Wptm, value);\n                Object.keys(selection).map(function(key, index) {\n                    if (selection[key][0] > 0) {\n                        var x = selection[key][0] - 1;\n                        topCellsSelections[key] = [x, selection[key][1], x, selection[key][3]];\n                    }\n                    if (selection[key][0] <= Wptm.headerOption && selection[key][2] >= Wptm.headerOption) {\n                        topCellsSelections2 = {};\n                        topCellsSelections2[key] = [Wptm.headerOption, selection[key][1], Wptm.headerOption, selection[key][3]];\n                        tableFunction.getFillArray(topCellsSelections2, Wptm, {'cell_border_top': ''});\n                    }\n                });\n                if (typeof topCellsSelections[0] !== 'undefined') {\n                    tableFunction.getFillArray(topCellsSelections, Wptm, {cell_border_bottom: '' + width + 'px ' + cell_border_style + ' ' + border_color});\n                }\n                break;\n            case 'cell_border_left':\n                // Get cells range left selection\n                var leftCellsSelections = {};\n                var fillLeftCells = true;\n                Object.keys(selection).map(function(key, index) {\n                    var y = selection[key][1] - 1 > 0 ? selection[key][1] - 1 : 0;\n                    if (parseInt(selection[key][1]) === 0) {\n                        fillLeftCells = false;\n                    }\n                    leftCellsSelections[key] = [selection[key][0], y, selection[key][2], y];\n                });\n                if (fillLeftCells) {\n                    tableFunction.getFillArray(leftCellsSelections, Wptm, {cell_border_right: '' + width + 'px ' + cell_border_style + ' ' + border_color});\n                }\n                tableFunction.getFillArray(selection, Wptm, value);\n                break;\n            default:\n                tableFunction.getFillArray(selection, Wptm, value);\n                break;\n        }\n    });\n\n}\n\n/*\npopup and action for this\nwptm_popup     #wptm_popup\npopup          object data popup\nclone          check clone content in popup\nselector_cells get selector cells to popup window\nsubmit_button  get submit button to popup window\n*/\nfunction wptm_popup(wptm_popup, popup, clone, selector_cells, submit_button, update_option_cell) {\n    if (update_option_cell === true) {\n        var selection = getSelector();\n        updateOptionValCell(jquery, Wptm, selection);\n    }\n\n    wptm_popup.find('.content').contents().remove();\n    var over_popup = wptm_popup.siblings('#over_popup');\n    if (!clone) {\n        var that = wptm_popup.find('.content').append(popup.html);\n    } else {\n        var that = wptm_popup.find('.content').append(popup.html.clone());\n        // window.jquery(html).appendTo(window.jquerywptm_popup.find('.content'));\n    }\n\n    if (selector_cells === true) {\n        wptm_popup.find('.content .popup_top').after(window.wptm_element.content_popup_hide.find('#select_cells').clone());\n        var function_data = window.table_function_data;\n        if (typeof function_data.selection !== 'undefined' && function_data.selection[0] !== undefined && _.size(function_data.selection[0]) > 0) {\n            tableFunction.getSelectedVal(function_data.selection[0], that.find('.cellRangeLabelAlternate'));\n        }\n    }\n\n    if (submit_button === true) {\n        that.find('>div').append(window.wptm_element.content_popup_hide.find('#submit_button').clone());\n    }\n    wptm_popup.animate({'opacity': '1'}, 10);\n\n    wptm_popup.show();\n    over_popup.show();\n\n    that.find('.tooltipster').tooltipster({\n        theme: 'tooltipster-borderless',\n        delay: 100,\n        maxWidth: 300,\n    });\n\n    //selection cells\n    that.find('#get_select_cells').unbind('click').on('click', function () {\n        alternating.affterRangeLabe.call(that, window.Wptm, window.jquery);\n        that.find('.cellRangeLabelAlternate').val();\n    });\n    that.find('.cellRangeLabelAlternate').on('keyup', function (e) {\n        if (e.which == 13) {\n            alternating.affterRangeLabe.call(that, window.Wptm, window.jquery);\n        }\n    });\n\n    /*action when show popup*/\n    if (typeof popup.showAction !== 'undefined') {\n        popup.showAction.call(that);\n    }\n\n    /*action selector*/\n    if (typeof popup.selector !== 'undefined') {\n        var select = select_input_popup.bind(popup, that);\n        select();\n    }\n\n    // select_tab\n    // that.find('.select_tab').find('.link-tab').on('click', function (e) {\n    //     e.preventDefault();\n    //     topTab.find('li.tab a[href=\"'+ tabHref +'\"]').click();\n    //     currentSubMenu.find('li.tab div.link-tab').removeClass('active');\n    //     $(this).addClass('active');\n    // });\n\n    /*action enter input*/\n    if (popup.inputEnter) {\n        that.find('input').on('keyup', function (e, i) {\n            if (e.keyCode === 13) {\n                if (typeof popup.submitAction !== 'undefined') {\n                    popup.submitAction.call(that);\n                } else {\n                    jquery(this).trigger('change');\n                }\n                wptm_popup.find('.colose_popup').trigger('click');\n            }\n            return true;\n        });\n    }\n\n    /*click done button*/\n    that.find('#popup_done').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (typeof popup.submitAction !== 'undefined' && !jquery(this).hasClass('not_active')) {\n            popup.submitAction.call(that);\n        }\n        return false;\n    });\n\n    /*click cancel button*/\n    that.find('#popup_cancel').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (typeof popup.cancelAction !== 'undefined') {\n            wptm_popup.animate({'opacity': '0'}, 10);\n            popup.cancelAction.call(that);\n        }\n        setTimeout(function () {\n            wptm_popup.hide();\n            over_popup.hide();\n        }, 200);\n        return false;\n    });\n\n    //action colose\n    wptm_popup.find('.colose_popup').unbind('click').on('click', function (e) {\n        e.preventDefault();\n        if (typeof popup.cancelAction !== 'undefined') {\n            wptm_popup.animate({'opacity': '0'}, 10);\n            popup.cancelAction.call(that);\n        }\n\n        if (typeof popup.render !== 'undefined' && popup.render === true) {\n            window.jquery(window.Wptm.container).data('handsontable').render();\n        }\n\n        setTimeout(function () {\n            wptm_popup.hide();\n            over_popup.hide();\n        }, 200);\n        return false;\n    });\n    over_popup.unbind('click').on('click', function (e) {\n        e.preventDefault();\n        wptm_popup.find('.colose_popup').trigger('click');\n        return false;\n    });\n\n    //set top for popup\n    //wptm_popup.css('top', (over_popup.outerHeight() - wptm_popup.outerHeight()) / 2);\n\n    return false;\n}\n\n/**\n * Selector Control function in popup\n *\n * @param that Wptm_popup.find('.content')\n */\nvar select_input_popup = function (that) {\n    if (typeof this.selector !== 'undefined') {\n        window.jquery.each(this.selector, (i, e) => {\n            that.find(e).change((e) => {\n                if (typeof this.option[i] !== 'undefined') {\n                    this.option[i] = window.jquery(e.currentTarget).val();\n                }\n                if (typeof this.inputAction !== 'undefined') {\n                    this.inputAction.call(that, i);\n                }\n            });\n        });\n    }\n}\n\n/**\n * add value for table_function_data.selection and table_function_data.selectionSize\n *\n * @returns {*}\n */\nvar getSelector = function () {\n    var selection = [];\n    // if (typeof selection === 'undefined' || selection === undefined || !selection) {\n    selection = window.jquery(window.Wptm.container).handsontable('getSelected');//get all cells selected ex:[[0,0,1,9],[3,0,3,9]]\n    // }\n    if (selection !== false && typeof selection !== 'undefined' && selection.length > 0) {\n        //check when handsontable('getSelected') return array[0] = array;\n        window.table_function_data.selectionSize = _.size(selection);\n        for (var i = 0; i < table_function_data.selectionSize; i++) {\n            if (selection[i][0] > selection[i][2]) {\n                selection[i] = [selection[i][2], selection[i][3], selection[i][0], selection[i][1]];\n            }\n            if (selection[i][1] > selection[i][3]) {\n                selection[i] = [selection[i][0], selection[i][3], selection[i][2], selection[i][1]];\n            }\n        }\n        window.table_function_data.selection = selection;\n    } else {\n        window.table_function_data.selection = false;\n        window.table_function_data.selectionSize = 0;\n    }\n    return selection;\n}\n\n/**\n * Update status item in cell_menu and table_menu by cell selected\n *\n * @param $\n * @param Wptm\n * @param selection Cell selected\n *\n * @returns {boolean}\n */\nvar loadSelection = function ($, Wptm, selection) {\n    selection = getSelector();\n    if (!selection) {\n        return true;\n    }\n    //show value cell to #CellValue when selector a cell\n    var size_selection = table_function_data.selectionSize - 1;\n    if (selection[size_selection][0] === selection[size_selection][2] && selection[size_selection][1] === selection[size_selection][3]) {\n        wptm_element.cellValue.val(Wptm.datas[selection[size_selection][0]][selection[size_selection][1]]);\n        table_function_data.cellValueChange = Wptm.datas[selection[size_selection][0]][selection[size_selection][1]];\n    } else {\n        wptm_element.cellValue.val('');\n        table_function_data.cellValueChange = '';\n    }\n    table_function_data.checkCellValueChange = false;\n\n    //set value option by selection\n    updateOptionValTable($, Wptm, selection);\n\n    updateOptionValCell($, Wptm, selection);\n    //Todo: populate jform_responsive_col\n\n    return true;\n}\n\n/**\n * Update status item in table_menu by cell seletoed\n *\n * @param $\n * @param Wptm\n * @param selection\n */\nfunction updateOptionValTable($, Wptm, selection) {\n    if (tableFunction.checkObjPropertyNested(Wptm.style, 'table')) {\n        var styleTable = Wptm.style.table;\n        var wptm_element = window.wptm_element;\n        var selector;\n        $.each(styleTable, function (index, value) {\n            switch (index) {\n                case 'enable_filters':\n                    selector = wptm_element.settingTable.find('.filters_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'download_button':\n                    selector = wptm_element.settingTable.find('.download_button_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'enable_pagination':\n                    selector = wptm_element.settingTable.find('.pagination_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'use_sortable':\n                    selector = wptm_element.settingTable.find('.sort_menu');\n                    if (value === 1 || value === '1') {\n                        selector.parent().addClass('selected');\n                    } else {\n                        selector.parent().removeClass('selected');\n                    }\n                    break;\n                case 'table_align':\n                    if (value !== '') {\n                        selector = wptm_element.settingTable.find('.align_menu').siblings('.sub-menu').find('li[name=\"' + value + '\"]');\n                        selector.siblings('li.selected').removeClass('selected');\n                        selector.addClass('selected');\n                    }\n                    break;\n                case 'col_types':\n                    if (typeof table_function_data.selection[0] !== 'undefined') {\n                        var first_column_selected = table_function_data.selection[0][1];\n                        if (typeof value[first_column_selected] !== 'undefined') {\n                            table_function_data.type_column_selected = value[first_column_selected];\n                        }\n                    }\n                    break;\n                default:\n                    break;\n            }\n        });\n    } else {\n\n    }\n}\n\n/**\n * Update status item in cell_menu by cell seletoed\n *\n * @param $\n * @param Wptm\n * @param selection\n */\nfunction updateOptionValCell($, Wptm, selection) {\n    var colsStyle = Wptm.style.cols;\n    var cellsStyle = Wptm.style.cells;\n    var rowsStyle = Wptm.style.rows;\n    var size_selection = table_function_data.selectionSize - 1;\n    if (size_selection < 0) {//not cell selected\n        return;\n    }\n    var endCell = [selection[size_selection][2], selection[size_selection][3]];\n    var end_cell = selection[size_selection][2] + '!' + selection[size_selection][3];\n\n    if (!tableFunction.checkObjPropertyNested(Wptm.style, 'cells')) {//fix when Wptm.style.cells not exist\n        Wptm.style.cells = {};\n    }\n\n    window.table_function_data.selectOption = true;//if == true then not click function\n    var cell_style = {};\n\n    if (typeof colsStyle[selection[size_selection][3]] !== 'undefined') {\n        cell_style = $.extend({}, colsStyle[selection[size_selection][3]][1]);\n    }\n    if (typeof rowsStyle[selection[size_selection][2]] !== 'undefined') {\n        cell_style = $.extend({}, cell_style, rowsStyle[selection[size_selection][2]][1]);\n    }\n\n    if (tableFunction.checkObjPropertyNested(Wptm.style, 'cells', end_cell, 2)) {\n        if ((Wptm.type === 'html' || selection[size_selection][2] === 0) && typeof cellsStyle[end_cell] !== 'undefined') {\n            cell_style = $.extend({}, cell_style, cellsStyle[end_cell][2]);\n        }\n    } else {//fix when Wptm.style.cells[endCell] not exist\n        tableFunction.getFillArray(selection, Wptm, {});\n    }\n\n    //tooltip\n    var $tooltip_content = $('#tooltip_content');\n    if ($tooltip_content.length > 0) {\n        tableFunction.updateParamFromStyleObject(cell_style, 'tooltip_width', $('#tooltip_width'), 0);\n\n        tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'tooltip_content');\n        tableFunction.updateParamFromStyleObject(cell_style, 'tooltip_content', $('#tooltip_content'), \"\");\n        var contenNeedToset = $('#tooltip_content').val();\n\n        var initTT = tinymce.extend({}, tinyMCEPreInit.mceInit['tooltip_content']);\n        try {\n            tinymce.init(initTT);\n        } catch (e) {\n        }\n\n        //add tinymce to this\n        tinyMCE.EditorManager.execCommand('mceAddEditor', true, 'tooltip_content');\n        if (tinyMCE.EditorManager.get('tooltip_content') != null) {\n            var ttEditor = tinyMCE.EditorManager.get('tooltip_content');\n            if (ttEditor && ttEditor.getContainer()) {\n                ttEditor.setContent(contenNeedToset);\n            }\n        }\n    }\n\n    if (tableFunction.checkCellsOptionsValidate(table_function_data.selection, 'cell_type', 'html')) {//hide cell formats\n        wptm_element.settingTable.find('a.date_menu_cell').parent('li').addClass('no_active');\n        wptm_element.settingTable.find('a.curency_menu_cell').parent('li').addClass('no_active');\n        wptm_element.settingTable.find('a.decimal_menu_cell').parent('li').addClass('no_active');\n    } else {\n        wptm_element.settingTable.find('a.date_menu_cell').parent('li').removeClass('no_active');\n        wptm_element.settingTable.find('a.curency_menu_cell').parent('li').removeClass('no_active');\n        wptm_element.settingTable.find('a.decimal_menu_cell').parent('li').removeClass('no_active');\n    }\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'thousand_symbol', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.thousand_symbol'), '');\n    tableFunction.updateParamFromStyleObject(cell_style, 'decimal_symbol', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.decimal_symbol'), '');\n    tableFunction.updateParamFromStyleObject(cell_style, 'decimal_count', wptm_element.content_popup_hide.find('#decimal_menu_cell').find('.decimal_count'), '');\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'currency_symbol', wptm_element.content_popup_hide.find('#curency_menu_cell').find('.currency_symbol'), '');\n    tableFunction.updateParamFromStyleObjectSelectBox(cell_style, 'symbol_position', wptm_element.content_popup_hide.find('#curency_menu_cell').find('.symbol_position').next('.wptm_select_box'), '');\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'date_formats', wptm_element.content_popup_hide.find('#date_menu_cell').find('.date_formats'), Wptm.style.table.date_formats);\n\n\n    tableFunction.updateParamFromStyleObjectSelectBox(cell_style, 'cell_font_family', wptm_element.primary_toolbars.find('#cell_font_family'), 'inherit');\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_size', wptm_element.primary_toolbars.find('#cell_font_size'), 13);\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_bold', wptm_element.primary_toolbars.find('#cell_format_bold'), false, function () {\n        active_table_option(this);\n    });\n\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_underline', wptm_element.primary_toolbars.find('#cell_format_underlined'), false,\n        function () {\n            active_table_option(this);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_italic', wptm_element.primary_toolbars.find('#cell_format_italic'), false,\n        function () {\n            active_table_option(this);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_background_color', wptm_element.primary_toolbars.find('#cell_background_color'), '',\n        function () {\n            var color = cell_style.cell_background_color;\n            this.wpColorPicker('color', color);\n            this.parents('.wp-picker-container').find('.wp-color-result').css('color', color);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_font_color', wptm_element.primary_toolbars.find('#cell_font_color'), '',\n        function () {\n            var color = cell_style.cell_font_color;\n            this.wpColorPicker('color', color);\n            this.parents('.wp-picker-container').find('.wp-color-result').css('color', color);\n        }\n    );\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_text_align', wptm_element.primary_toolbars.find('#cell_text_align'), 'left', function () {\n        var value = typeof cell_style.cell_text_align === 'undefined' ? '' : cell_style.cell_text_align;\n\n        wptm_element.primary_toolbars.find('a[name=\"format_align_left\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_center\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_right\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_justify\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"format_align_' + value + '\"]').addClass('active');\n    });\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_vertical_align', wptm_element.primary_toolbars.find('#cell_vertical_align'), 'middle', function () {\n        var value = typeof cell_style.cell_vertical_align === 'undefined' ? cell_style.cell_vertical_align = 'top' : cell_style.cell_vertical_align;\n\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_bottom\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_middle\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_top\"]').removeClass('active');\n        wptm_element.primary_toolbars.find('a[name=\"vertical_align_' + value + '\"]').addClass('active');\n    });\n    tableFunction.updateParamFromStyleObject(cell_style, 'cell_type', wptm_element.primary_toolbars.find('#cell_type'), '', function () {\n        var value = cell_style.cell_type;\n        if (typeof value === 'undefined' || value === '' || value === null) {\n            wptm_element.primary_toolbars.find('#cell_type').removeClass('active');\n        } else {\n            wptm_element.primary_toolbars.find('#cell_type').addClass('active');\n        }\n    });\n    wptm_element.primary_toolbars.find('#cell_border').find('a').each(function () {\n        $(this).removeClass('active');\n    });\n\n    var mergeCellRanger = {\n        'col': selection[size_selection][1],\n        'colspan': selection[size_selection][3] - selection[size_selection][1] + 1,\n        'row': selection[size_selection][0],\n        'rowspan': selection[size_selection][2] - selection[size_selection][0] + 1\n    };\n    if (Wptm.mergeCellsSetting.some(function (mergeCellsSetting) {\n        return mergeCellsSetting.col === mergeCellRanger.col && mergeCellsSetting.row === mergeCellRanger.row;\n    })) {\n        wptm_element.primary_toolbars.find('#merge_cell').addClass('active');\n    } else {\n        wptm_element.primary_toolbars.find('#merge_cell').removeClass('active');\n    }\n\n    window.table_function_data.selectOption = false;\n    //get size(height, width) end cells\n    tableFunction.getSizeCells($, Wptm, endCell);\n}\n\n\nfunction active_table_option(that) {\n    if (that.val() === true) {\n        that.addClass('active');\n    } else {\n        that.removeClass('active');\n    }\n}\n\n/**\n * Create custom select box\n *\n * @param $\n * @param select_function cell function when click select\n */\nfunction custom_select_box ($, select_function, multiple) {\n    $(this).on('click', function (e) {\n        var $that = $(this);\n        var old_value;\n\n        $('#mybootstrap').find('.wptm_select_box').each(function () {\n            $(this).hide();\n            $(this).siblings('.show').removeClass('show');\n        });\n        var position = $(this).position();\n\n        if ($(this).hasClass('show')) {\n            $(this).next().hide();\n            $(this).removeClass('show');\n            $(document).unbind('click.wptm_select_box');\n            return;\n        }\n        $that.addClass('show');\n        var $select = $(this).next().css({top: position.top + 40, left: position.left, 'min-width': $that.outerWidth()}).show();\n\n        if (multiple) {\n            $select.find('li input').prop(\"checked\", false);\n            old_value = $that.data('value').split('|');\n            $.each(old_value, function (i, v) {\n                $select.find('li[data-value=\"' + v + '\"]').find('input').prop(\"checked\", true);\n            })\n        } else {\n            old_value = $that.data('value');\n        }\n\n        $select.find('li').unbind('click').on('click', function (e) {\n            var text = '', data = '';\n            var li_tag = $(this);\n            if (multiple) {\n                if ($(e.target).is('input')) {\n                    li_tag = $(e.target).parent();\n                } else {\n                    li_tag.find('input').prop(\"checked\", !li_tag.find('input').is(\":checked\"));\n                }\n            }\n\n            console.log(li_tag);\n            if (!multiple || li_tag.hasClass('data-none')) {\n                text = li_tag.text();\n                data = li_tag.data('value');\n            } else {\n                $select.find('li:not(.data-none)').each(function (i, e) {\n                    if ($(e).find('input').is(\":checked\")) {\n                        if (data !== '') {\n                            text += ',' + $(e).text();\n                            data += '|' + $(e).data('value');\n                        } else {\n                            text += $(e).text();\n                            data += $(e).data('value');\n                        }\n                    }\n                });\n            }\n            $select.data('value', data).change();\n            console.log(data);\n            $that.val(data).text(text).data('value', data).change();\n\n            if (typeof select_function !== 'undefined' && select_function !== null) {\n                select_function.bind(li_tag.data('value'));\n            }\n            if (!multiple || li_tag.hasClass('data-none')) {\n                $('#mybootstrap').find('.wptm_select_box').hide();\n            }\n        });\n\n        $(document).bind('click.wptm_select_box', (e) => {\n            if (!$(e.target).is($(this)) && !(!!multiple && $(e.target).parents('.wptm_select_box').length > 0)) {\n                $select.hide();\n                $that.removeClass('show');\n                $(document).unbind('click.wptm_select_box');\n            }\n        });\n    });\n}\n\nexport default {selectOption, loadSelection, updateOptionValTable, wptm_popup}\n","/**\n * Wptm\n *\n * We developed this code with our hearts and passion.\n * We hope you found it useful, easy to understand and to customize.\n * Otherwise, please feel free to contact us at contact@joomunited.com *\n * @package Wptm\n * @copyright Copyright (C) 2014 JoomUnited (http://www.joomunited.com). All rights reserved.\n * @copyright Copyright (C) 2014 Damien Barrre (http://www.crac-design.com). All rights reserved.\n * @license GNU General Public License version 2 or later; http://www.gnu.org/licenses/gpl-2.0.html\n */\nimport tableFunction from \"./_functions\";\nimport {initHandsontable, getMergeCells, calHeightTable} from \"./_initHandsontable\";\nimport alternating from \"./_alternating\";\nimport selectOption from \"./_toolbarOptions\";\nimport DropChart from \"./_chart\";\nimport customRenderer from \"./_customRenderer\";\n\njQuery('title').text(wptmText.EDIT_TABLE_TITLE_TAG);\n\njQuery(window).bind('beforeunload', function(){\n    if(!checkTimeOut)\n        return true;\n});\n\njQuery(document).ready(function ($) {\n    window.jquery = $;\n\n    var popup = $(\"#wptm_popup\").draggable({\n        containment: \"#pwrapper\",\n        drag: function( event, ui ) {\n            $(this).css('transform', 'none');\n        },\n    });\n\n    var popup_edit_html_cell = $(\"#wptm_edit_html_cell\").draggable({\n        containment: \"#pwrapper\",\n        drag: function( event, ui ) {\n            $(this).css('transform', 'none');\n        },\n    });\n\n    $('.tip').tooltipster({\n        theme: 'tooltipster-borderless',\n        delay: 100,\n        distance: 5,\n    });\n    $(document).on('click', '.search-open-btn', function (e) {\n        var btn = $(this);\n        var search_menu = btn.closest('.search-menu');\n        if (!search_menu.hasClass(\"open\")) {\n            search_menu.addClass(\"open\");\n        }\n    });\n    $(document).on('mouseup', function (e) {\n        var container = $(\".search-menu\");\n        // if the target of the click isn't the container nor a descendant of the container\n        if (!container.is(e.target) && container.has(e.target).length === 0 && container.hasClass(\"open\")) {\n            container.removeClass(\"open\");\n        }\n    });\n    $('.wp-color-result-text').each(function () {\n        var tip = $(this).closest('.cells_option').attr('title');\n        $(this).attr('title', tip).tooltipster({\n            theme: 'tooltipster-borderless',\n            delay: 0,\n            distance: 5,\n        });\n    });\n    if (typeof (Wptm) == 'undefined') {\n        Wptm = {};\n        Wptm.can = {};\n        Wptm.can.create = true;\n        Wptm.can.edit = true;\n        Wptm.can.delete = true;\n        Wptm.selection = {};\n        Wptm.value_unit_chart = [];\n        Wptm.hyperlink = {};\n    } else {\n        Wptm.value_unit_chart = [];\n    }\n    Wptm.updateSettings = {};\n    Wptm.saveDataDbTable = [];\n\n    if (typeof (Wptm.can) == 'undefined') {\n        Wptm.can = {};\n        Wptm.can.create = true;\n        Wptm.can.edit = true;\n        Wptm.can.delete = true;\n        Wptm.hyperlink = {};\n    }\n\n    if (typeof (wptm_isAdmin) == 'undefined') {\n        wptm_isAdmin = false;\n    }\n    Wptm.clearHandsontable = true;\n    if (typeof chart_active !== 'undefined' && parseInt(chart_active) > 0) {\n        Wptm.chart_active = chart_active;\n    } else {\n        $('#over_loadding_open_chart').hide();\n    }\n\n    if (typeof window.parent.wptm_insert !== 'undefined' && typeof window.parent.wptm_insert.opend_table !== 'undefined') {\n        delete window.parent.wptm_insert.opend_table;\n    }\n\n    window.wptm_element = {\n        wpreview: $('#wptm-toolbars'),\n        primary_toolbars: $('#primary_toolbars'),\n        mainTabContent: $('#mainTabContent'),\n        tableContainer: $('#tableContainer'),\n        wptm_popup: $('#wptm_popup'),\n        content_popup_hide: $('#content_popup_hide'),\n        cellValue: $('#CellValue'),\n        settingCells: $('#setting-cells'),\n        settingTable: $('#table-setting'),\n        nameTable: $('#name-table'),\n        alternating_color: $('#alternating_color'),\n        editToolTip: $('#editToolTip'),\n        edit_html_cell: $('#edit_html_cell'),\n        wptm_edit_html_cell: $('#wptm_edit_html_cell'),\n        saveToolTipbtn: $('#saveToolTipbtn'),\n        chartTabContent: $('#chartTabContent'),\n        wptmContentChart: $('#wptm_chart .wptm_content_chart')\n    };\n\n    //saving all function data\n    window.table_function_data = {\n        replace_unit: {},\n        text_replace_unit: '',\n        text_replace_unit_function: '',\n        date_format: [],\n        check_value_data: true,\n        string_currency_symbols: '',\n        selectFetch: {},\n        allAlternate: {},\n        oldAlternate: {},\n        changeAlternate: [],\n        checkChangeAlternate: [],\n        selection: [],\n        styleToRender: '',\n        content: '',\n        needSaveAfterRender: false,\n        alternateIndex: '',\n        alternateSelection: [],\n        save_table_params: [],\n        firstRender: false,\n        accountingNumber : {}\n    };\n\n    // is writing\n    if (typeof idUser !== 'undefined' && idUser !== null) {\n        var listUserEdit = {};\n    }\n\n    /* init menu actions */\n\n    window.default_value = $.extend({}, {\n        'use_sortable': '0',\n        'fonts_used': [],\n        'fonts_local_used': [],\n        'default_sortable': '0',\n        'default_order_sortable': '1',\n        'table_align': 'center',\n        'responsive_type': 'scroll',\n        'table_breakpoint': '980',\n        'freeze_col': 0,\n        'table_height': 500,\n        'style_repeated': 0,\n        'freeze_row': 0,\n        'enable_filters': 0,\n        'enable_pagination': 0,\n        'allRowHeight': '',\n        'spreadsheet_url': '',\n        'spreadsheet_style': 0,\n        'auto_sync': 0,\n        'auto_push': 0,\n        'download_button': 0,\n        'col_types': [\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\",\"varchar\"]\n    }, default_value);\n\n    if (typeof idTable !== 'undefined' && idTable !== '') {\n        updatepreview(idTable);\n\n        if ($('.wptm-page').length > 0 && $('#adminmenuwrap').length > 0) {\n            Scrollbar.init(document.querySelector('#adminmenuwrap'), {\n                damping: 0.5,\n                thumbMinSize: 10,\n                alwaysShowTracks: false\n            });\n        }\n    }\n\n    //create new table\n    wptm_element.primary_toolbars.find('.new_table_menu').on('click', function (e) {\n        e.preventDefault();\n\n        if (!(Wptm.can.create)) {\n            return;\n        }\n\n        if (!wptm_permissions.can_create_tables) {\n            bootbox.alert(wptm_permissions.translate.wptm_create_tables, wptmText.Ok);\n            return false;\n        }\n\n        var id_category = Wptm.category;\n        var curr_page = window.location.href;\n        var cells = curr_page.split(\"?\");\n\n        $.ajax({\n            url: wptm_ajaxurl + \"task=table.add&id_category=\" + id_category,\n            type: \"POST\",\n            data: {},\n            dataType: \"json\",\n            success: function (datas) {\n                if (datas.response === true) {\n                    var new_url = cells[0] + '?page=wptm&id_table=' + datas.datas.id;\n                    window.open(new_url);\n                } else {\n                    bootbox.alert(datas.response, wptmText.Ok);\n                }\n            },\n            error: function (jqxhr, textStatus, error) {\n                bootbox.alert(textStatus + \" : \" + error, wptmText.Ok);\n            }\n        });\n        return false;\n    });\n\n    //Import Excel\n    //Init call back when file is uploaded successful\n    $(\"#procExcel\").dropzone({\n        url: \"admin-ajax.php?action=Wptm&task=excel.import\",\n        maxFiles: 1,\n        init: function () {\n            //Update form action\n            this.on(\"addedfile\", function (file) {\n                var dotPos = file.name.lastIndexOf('.') + 1;\n                var ext = file.name.substr(dotPos, file.name.length - dotPos);\n\n                if (ext !== 'xls' && ext !== 'xlsx') {\n                    bootbox.alert(wptmText.CHOOSE_EXCEL_FIE_TYPE, wptmText.Ok);\n                    this.options.autoProcessQueue = false;\n                    this.removeFile(file);\n                } else {\n                    if (this.options.autoProcessQueue === false) {\n                        this.options.autoProcessQueue = true;\n                    }\n                }\n            });\n\n            this.on(\"sending\", function (file, xhr, formData) {\n                file.previewElement.innerHTML = \"\";//remove Layout dropzone\n                //Add table id to formData\n                $(\"#jform_id_table\").val(idTable);\n                formData.append('id_table', idTable);\n                formData.append('onlydata', wptm_element.wptm_popup.find(\"#import_style\").val());\n\n                // Show the total progress bar when upload starts\n                wptm_element.wptm_popup.find(\".progress\").show();\n                wptm_element.wptm_popup.find(\".progress-bar-success\").css('width', 30 + '%');\n                wptm_element.wptm_popup.find(\".progress-bar-success\").css('opacity', 1);\n                // And disable the start button\n            });\n\n            this.on(\"success\", function (file, responseText) {\n                wptm_element.wptm_popup.find(\".progress\").fadeOut(1000);\n                var responseObj = JSON.parse(responseText);\n                file.previewElement.innerHTML = \"\";//remove Layout dropzone\n\n                wptm_element.wptm_popup.find('.colose_popup').trigger('click');\n                if (responseObj.response === true) {\n                    if (typeof responseObj.datas.too_large !== 'undefined') {\n                        bootbox.confirm(responseObj.datas.msg, wptmText.Cancel, wptmText.Ok, function (result) {\n                            if (result === true) {\n                                var jsonVar = {\n                                    id_table: responseObj.datas.id,\n                                    onlydata: responseObj.datas.onlydata,\n                                    file: encodeURI(responseObj.datas.file),\n                                    ignoreCheck: 1\n                                };\n                                $.ajax({\n                                    url: wptm_ajaxurl + \"task=excel.import\",\n                                    type: 'POST',\n                                    data: jsonVar,\n                                    success: function (datas) {\n                                        location.reload();\n                                    }\n                                })\n                            } else {\n                                //do nothing\n                            }\n                        });\n\n                    } else {\n                        location.reload();\n                    }\n                } else {\n                    bootbox.alert(typeof responseObj.response.text !== 'undefined' ? responseObj.response.text : responseObj.response, wptmText.Ok);\n                }\n            });\n\n            this.on('complete', function (file) {\n                this.removeFile(file);\n                setTimeout(function () {\n                    wptm_element.wptm_popup.find(\".progress-bar-success\").css('width', 0);\n                }, 6000);\n            });\n            // Update the total progress bar\n            this.on(\"uploadprogress\", function (file, progress) {\n                wptm_element.wptm_popup.find(\".progress-bar-success\").css('width', progress + \"%\");\n            });\n        }\n    });\n\n    if (typeof Wptm.wptm_error_message_read_file !== 'undefined') {\n        bootbox.alert(\n            wptmText.import_is_finished + '<br/>' +\n            wptmText.error_message_read_file_cells_concerned +\n            Wptm.wptm_error_message_read_file, wptmText.Ok);\n    }\n});\n\n//Call ajax to get all data of table, add value to Wptm, table_function_data\nfunction updatepreview(id, ajaxCallBack) {\n    /*remove after change theme*/\n    delete table_function_data.changeTheme;\n    var url = wptm_ajaxurl + \"view=table&format=json&id=\" + id;\n    var $ = jquery;\n\n    $.ajax({\n        url: url,\n        type: \"POST\",\n        data: {},\n        dataType: \"json\",\n    }).done(function (data) {\n        //TODO: check user role table\n        Wptm.id = id;\n        Wptm.title = data.title;\n        /*not change data cell(in db table)*/\n        Wptm.type = 'html';\n        Wptm.category = data.id_category;\n\n        /*set height rows variable*/\n        Wptm.rowsHeight = {};\n        Wptm.table_height = 0;\n\n        Wptm.hyperlink = {};\n        if (typeof data.type !== 'undefined') {\n            Wptm.type = data.type;\n        } else {\n            Wptm.type = (typeof data.params.table_type !== 'undefined') ? data.params.table_type : Wptm.type;\n        }\n\n        if (data.datas === '' || data.datas === false) {\n            delete Wptm.datas;\n            Wptm.datas = [\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n            ];\n        } else {\n            data.datas = JSON.stringify(data.datas);\n            try {\n                Wptm.datas = JSON.parse(data.datas);\n            } catch (err) {\n                Wptm.datas = [\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n                    [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n                ];\n            }\n        }\n\n        Wptm.style = $.parseJSON(data.style);\n\n        Wptm.css = data.css.replace(/\\\\n/g, \"\\n\");\n\n        if (data.params === \"\" || data.params === null || data.params.length == 0) {\n            Wptm.mergeCellsSetting = [];\n            Wptm.headerOption = 1;\n        } else {\n            if (typeof (data.params) == 'string') {\n                data.params = $.parseJSON(data.params);\n            }\n\n            if (typeof data.params.headerOption !== 'undefined') {\n                Wptm.headerOption = parseInt(data.params.headerOption);\n            } else {\n                Wptm.headerOption = 1;\n            }\n\n            if (typeof data.params.hyperlink !== 'undefined') {\n                if (typeof data.params.hyperlink === 'string') {\n                    data.params.hyperlink = data.params.hyperlink.replaceAll('\\\\\\\\\"', '\\\\\"');\n                    data.params.hyperlink = $.parseJSON(data.params.hyperlink);\n                }\n                $.each(data.params.hyperlink, function (index, value) {\n                    var rowCol = index.split(\"!\");\n                    if(typeof Wptm.datas[rowCol[0]] !== 'undefined') {\n                        if (typeof value.text == 'undefined') {\n                            value.text =  Wptm.datas[rowCol[0]][rowCol[1]];\n                        }\n                        Wptm.datas[rowCol[0]][rowCol[1]] = '<a target=\"_blank\" href=\"' + value.hyperlink + '\">' + value.text + '</a>';\n                    }\n                });\n                Wptm.hyperlink = data.params.hyperlink;\n            }\n\n            try {\n                if (typeof data.params.mergeSetting === 'string') {\n                    Wptm.mergeCellsSetting = $.parseJSON(data.params.mergeSetting);\n                } else if (typeof data.params.mergeSetting === 'object') {\n                    Wptm.mergeCellsSetting = data.params.mergeSetting;\n                }\n                if (Wptm.mergeCellsSetting == null) {\n                    Wptm.mergeCellsSetting = [];\n                }\n            } catch (e) {\n                Wptm.mergeCellsSetting = [];\n            }\n        }\n\n        /*set default table data*/\n        if (typeof (Wptm.style) === 'undefined' || Wptm.style === null) {\n            $.extend(Wptm, {\n                style: {\n                    table: {},\n                    rows: {},\n                    cols: {},\n                    cells: {}\n                },\n                css: ''\n            });\n        }\n\n        if (typeof (Wptm.style.rows) === 'undefined' || Wptm.style.rows === null) {\n            Wptm.style.rows = {};\n        }\n        if (typeof (Wptm.style.cols) === 'undefined' || Wptm.style.cols === null) {\n            Wptm.style.cols = {};\n            for (var number_col in Wptm.datas[0]) {\n                Wptm.style.cols[number_col] = [parseInt(number_col), {res_priority: parseInt(number_col)}];\n            }\n        } else {\n            for (var number_col in Wptm.datas[0]) {\n                if (typeof window.Wptm.style.cols[number_col] === 'undefined' || window.Wptm.style.cols[number_col] === null) {\n                    Wptm.style.cols[number_col] = [parseInt(number_col), {res_priority: parseInt(number_col)}];\n                } else  if (typeof window.Wptm.style.cols[number_col][1].res_priority === 'undefined') {\n                    Wptm.style.cols[number_col][1].res_priority =  parseInt(number_col);\n                }\n            }\n        }\n        if (typeof (Wptm.style.cells) === 'undefined' || Wptm.style.cells === null) {\n            Wptm.style.cells = {};\n        }\n\n        tableFunction.mergeCollsRowsstyleToCells();\n\n        Wptm.style.table = $.extend({}, window.default_value, Wptm.style.table);\n\n        if (typeof table_function_data.auto_sync !== 'undefined') {\n            Wptm.style.table.auto_sync = table_function_data.auto_sync;\n            Wptm.style.table.spreadsheet_style = table_function_data.spreadsheet_style;\n            Wptm.style.table.spreadsheet_url = table_function_data.spreadsheet_url;\n            delete table_function_data.auto_sync;\n        }\n\n        if (Wptm.style.table.spreadsheet_url !== '' && Wptm.style.table.spreadsheet_url.indexOf(\"docs.google.com/spreadsheet\") === -1) {//when first auto syn after update 2.7.0\n            if (table_function_data.auto_sync == 1) {\n                Wptm.style.table.excel_auto_sync = 1;\n                Wptm.style.table.auto_sync = 0;\n                Wptm.style.table.excel_spreadsheet_style = Wptm.style.table.spreadsheet_style;\n            }\n            Wptm.style.table.excel_url = table_function_data.spreadsheet_url;\n            table_function_data.spreadsheet_url = '';\n            Wptm.style.table.spreadsheet_url = '';\n        }\n\n        if (Wptm.headerOption > 0 && (typeof Wptm.style.table.header_data === 'undefined' || Wptm.style.table.header_data.length < Wptm.headerOption)) {\n            Wptm.style.table.header_data = [];\n            for (var j = 0; j < Wptm.headerOption; j++) {\n                Wptm.style.table.header_data[j] = Wptm.datas[j];\n            }\n        }\n\n\n        window.table_function_data = tableFunction.createRegExpFormat(table_function_data, Wptm.style.table.currency_symbol, Wptm.style.table.date_formats);\n\n        if (Wptm.style.table.date_formats !== '') {\n            window.table_function_data.date_formats_momentjs = tableFunction.momentjsFormat(Wptm.style.table.date_formats);\n        }\n\n        window.Wptm = $.extend({}, window.Wptm, Wptm);\n\n        $('#jform_css').val(Wptm.css);\n        $('#jform_css').change();\n        tableFunction.parseCss($);\n\n        tableFunction.setFormat_accounting();\n\n        var handRisize, clearHandRisize;\n        window.onresize = function () {\n            if (!clearHandRisize) {\n                clearTimeout(handRisize);\n            }\n\n            clearHandRisize = false;\n            handRisize = setTimeout(function () {\n                var height = tableFunction.calculateTableHeight(window.jquery('#wptm-toolbars'));\n                jquery(Wptm.container).handsontable('updateSettings', {height: height});\n                clearHandRisize = true;\n            }, 500);\n        };\n\n        if (typeof (Wptm.style.table.alternateColorValue) === 'undefined' || typeof Wptm.style.table.alternateColorValue[0] === 'undefined') {\n            var styleRows = null;\n            alternating.setAlternateColor(styleRows, window.Wptm, window.wptm_element);\n        }\n\n        if (_.size(window.table_function_data.oldAlternate) < 1) {\n            window.table_function_data.oldAlternate = $.extend({}, Wptm.style.table.alternateColorValue);\n        }\n\n        if (_.size(window.table_function_data.allAlternate) < 1) {\n            window.table_function_data.allAlternate = $.extend({}, Wptm.style.table.allAlternate);\n        }\n\n        //update option table\n        selectOption.updateOptionValTable($, window.Wptm, [0, 0, 0, 0]);\n\n        codemirror_tooltip($);\n\n        $('#list_chart').find('.current_table a').text(Wptm.title);\n        if (Wptm.type !== 'html') {\n            // wptm_element.primary_toolbars.find('.wptm_name_edit').after('<div class=\"wptm_warning\"><p>' + wptmText.notice_msg_table_database + '</p></div>');\n            if (wptm_element.settingTable.find('.table-menu a.source_menu').length > 0) {\n                wptm_element.settingTable.find('.table-menu a.source_menu').parent().show();\n            }\n            if (Wptm.style.table.allRowHeight < 10 || isNaN(Wptm.style.table.allRowHeight)) {\n                Wptm.style.table.allRowHeight = 30;\n            }\n        } else {\n            wptm_element.settingTable.find('.table-menu a.source_menu').parent().hide();\n        }\n\n        // window.Wptm.type = 'html';\n\n        //check edit columns, get column key\n        if (window.Wptm.type === 'mysql') {\n            Wptm.query_option = data.query_option;\n            if (Wptm.query_option.column_options !== null && Wptm.query_option.column_options.length > 0) {\n                table_function_data.columns = [];\n                for (var i in Wptm.query_option.column_options) {\n                    if (parseInt(Wptm.query_option.column_options[i].canEdit) !== 1 || (Wptm.query_option.column_options[i].table + '.' + Wptm.query_option.column_options[i].Field === Wptm.style.table.priKey)) {\n                        table_function_data.columns[i] = {readOnly: true};\n                    } else {\n                        table_function_data.columns[i] = {readOnly: false}\n                    }\n                    if (typeof Wptm.style.table.lock_columns !== 'undefined'\n                        && Wptm.style.table.lock_columns[i] != 0) {\n                        table_function_data.columns[i] = {readOnly: true};\n                    }\n                    if (Wptm.style.table.priKey === Wptm.query_option.column_options[i].table + '.' + Wptm.query_option.column_options[i].Field) {\n                        table_function_data.keyPosition = i;\n                    }\n                }\n            }\n        // } else {\n        //     if (wptm_administrator !== 1 && typeof Wptm.style.table.protect_columns !== 'undefined') {\n        //         table_function_data.columns = [];\n        //         for (var ij2 in Wptm.style.table.protect_columns) {\n        //             if (Wptm.style.table.protect_columns[ij2] != 0) {\n        //                 table_function_data.columns[ij2] = {readOnly: true};\n        //             } else {\n        //                 table_function_data.columns[ij2] = {readOnly: false}\n        //             }\n        //         }\n        //     }\n        }\n\n        if (typeof Wptm.style.table.lock_ranger_cells !== 'undefined' && Wptm.style.table.lock_ranger_cells.length > 0) {\n            tableFunction.create_ranger_cells_lock(Wptm, table_function_data, null);\n        }\n\n        table_function_data.mysqlEdit = window.Wptm.type === 'mysql' && parseInt(Wptm.table_editing) === 1;\n\n        /*render table */\n        initHandsontable(Wptm.datas);\n        wptm_element.primary_toolbars.find('.wptm_name_edit').click(function () {\n            if (!$(this).hasClass('editable')) {\n                tableFunction.setText.call(\n                    $(this),\n                    wptm_element.primary_toolbars.find('.wptm_name_edit'),\n                    '#primary_toolbars .wptm_name_edit',\n                    {'url': wptm_ajaxurl + \"task=table.setTitle&id=\" + Wptm.id + '&title=', 'selected': true}\n                );\n            }\n        });\n\n        $(window).bind('keydown', function(event) {//CTRL + S\n            if (!(event.which == 83 && (event.ctrlKey || event.metaKey)) && !(event.which == 19)) return true;\n            tableFunction.saveChanges(true);\n            event.preventDefault();\n            return false;\n        });\n    });\n}\n\nfunction checkLightOrDark(color) {\n    var r, g, b, hsp;\n\n    if (color.match(/^rgb/)) {\n        color = color.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/);\n        r = color[1];\n        g = color[2];\n        b = color[3];\n    }\n    else {\n        color = +(\"0x\" + color.slice(1).replace(color.length < 5 && /./g, '$&$&'));\n        r = color >> 16;\n        g = color >> 8 & 255;\n        b = color & 255;\n    }\n\n    hsp = Math.sqrt(\n        0.299 * (r * r) +\n        0.587 * (g * g) +\n        0.114 * (b * b)\n    );\n\n    if (hsp>127.5) {\n        return 1;\n    }\n    else {\n        return 0;\n    }\n}\n\n//custom cell editor\nfunction codemirror_tooltip($) {\n    window.CustomEditor = Handsontable.editors.TextEditor.prototype.extend();\n\n    window.CustomEditor.prototype.open = function () {\n        $(this.TEXTAREA).attr('id', 'editor1');\n        var lightOrDark = checkLightOrDark($(this.TEXTAREA).css( \"backgroundColor\" ));\n        if (lightOrDark === 0) {\n            $(this.TEXTAREA).css({'color':'#ffffff'});\n        } else {\n            $(this.TEXTAREA).css({'color':'#000000'});\n        }\n        var cell_html = false;\n\n        if (typeof (Wptm.style.cells[this.row + '!' + this.col]) !== 'undefined' && typeof (Wptm.style.cells[this.row + '!' + this.col][2].cell_type) !== 'undefined' && Wptm.style.cells[this.row + '!' + this.col][2].cell_type === 'html') {\n            cell_html = true;\n            Handsontable.editors.TextEditor.prototype.close.apply(this, arguments);\n            tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'html_cell_content');\n\n            var initTT = tinymce.extend({}, tinyMCEPreInit.mceInit['html_cell_content']);\n            try {\n                tinymce.init(initTT);\n            } catch (e) {\n            }\n\n            //add tinymce to this\n            var content = '';\n            if (typeof Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]] !== 'undefined'\n            && Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]] !== null) {\n                content = Wptm.datas[table_function_data.selection[0][0]][table_function_data.selection[0][1]];\n            }\n            tinyMCE.EditorManager.execCommand('mceAddEditor', true, 'html_cell_content');\n            if (tinyMCE.EditorManager.get('html_cell_content') != null) {\n                var ttEditor = tinyMCE.EditorManager.get('html_cell_content');\n                if (ttEditor && ttEditor.getContainer()) {\n                    ttEditor.setContent(content);\n                }\n            }\n\n            wptm_element.edit_html_cell.trigger('click');\n        } else {\n            tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'html_cell_content');\n            Handsontable.editors.TextEditor.prototype.open.apply(this, arguments);\n        }\n\n        // change width of popup when click html cell\n        if (!cell_html) {\n            wptm_element.tableContainer.find('.handsontableInputHolder').css('position', 'absolute').css('visibility', 'visible');\n        }\n    };\n\n    window.CustomEditor.prototype.getValue = function () {\n        if (typeof (tinyMCE) === 'undefined' || !tinyMCE.EditorManager.get('html_cell_content')) {\n            return Handsontable.editors.TextEditor.prototype.getValue.apply(this, arguments);\n        }\n    };\n\n    window.CustomEditor.prototype.setValue = function (newValue) {\n        if (typeof (tinyMCE) === 'undefined' || !tinyMCE.EditorManager.get('html_cell_content')) {\n            return Handsontable.editors.TextEditor.prototype.setValue.apply(this, arguments);\n        }\n    };\n\n    wptm_element.edit_html_cell.wptm_leanModal({\n        top: 100, background: '#ffffff', closeButton: '#cancel_html_cell_btn',\n        beforeInit: function () {\n            var position = tableFunction.setPositionForHtmlCellEditor();\n            this.top = position.top;\n            this.left = position.left + 'px';\n            this.marginLeft = '0px';\n        },\n        before_colose_modal: function () {\n            var content = tinyMCE.EditorManager.get('html_cell_content').getContent();\n            window.jquery(window.Wptm.container).data('handsontable').setDataAtCell(table_function_data.selection[0][0], table_function_data.selection[0][1], content);\n        }\n    });\n\n    //codemirror\n    var myTextArea = document.getElementById(\"jform_css\");\n    var myCssEditor = CodeMirror.fromTextArea(myTextArea, {mode: \"css\", lineNumbers: true});\n    var ww = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n    var wh = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    if (window.parent) {\n        ww = window.parent.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n        wh = window.parent.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n    }\n\n    myCssEditor.setSize(ww * 50 / 100, wh - 500);\n\n    wptm_element.primary_toolbars.find('.custom-menu').wptm_leanModal({\n        top: 200,\n        background: '#ffffff',\n        closeButton: '#cancelCssbtn',\n        beforeShow: function () {\n            var selection = table_function_data.selection;\n            var ht = jQuery(Wptm.container).handsontable('getInstance');\n            ht.updateSettings({\n                cells: function (row, col, prop) {\n                    if (selection[0][0] === row && selection[0][1] === col) {\n                        var cellProperties = {};\n\n                        cellProperties.readOnly = true;\n                        return cellProperties;\n                    }\n                }\n            });\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        },\n        before_colose_modal: function () {\n            var selection = table_function_data.selection;\n\n            var ht = jQuery(Wptm.container).handsontable('getInstance');\n            ht.updateSettings({\n                cells: function (row, col, prop) {\n                    if (selection[0][0] === row && selection[0][1] === col) {\n                        var cellProperties = {};\n\n                        cellProperties.readOnly = false;\n                        return cellProperties;\n                    }\n                }\n            });\n            window.jquery(Wptm.container).handsontable(\"selectCell\", selection[0][0], selection[0][1], selection[0][0], selection[0][1]);\n        },\n        modalShow: function () {\n            myCssEditor.refresh();\n            myCssEditor.focus();\n        }\n    });\n\n    $(myTextArea).on('change', function () {\n        myCssEditor.setValue($(myTextArea).val().replace(/\\\\n/g, \"\\n\"));\n    });\n\n    // myCssEditor.on(\"blur\", function() {\n    $(\"#saveCssbtn\").click(function () {\n        myCssEditor.save();\n        tableFunction.parseCss($);\n        $(myTextArea).trigger(\"propertychange\");\n        //close leanModal\n        $(\"#lean_overlay\").fadeOut(200);\n        $(\"#wptm_customCSS\").css({\"display\": \"none\"})\n    });\n\n    wptm_element.editToolTip.wptm_leanModal({\n        top: 100, background: '#ffffff', closeButton: '#cancelToolTipbtn', modalShow: function () {\n        }\n    });\n\n    wptm_element.saveToolTipbtn.click(function () {\n        var ttEditor = tinyMCE.EditorManager.get('tooltip_content');\n        ttEditor.save();\n        $(\"#tooltip_content\").trigger(\"change\");\n        //close leanModal\n        $(\"#lean_overlay\").fadeOut(200);\n\n        $(\"#wptm_editToolTip\").css({\"display\": \"none\"});\n        $('#edit_toolTip').trigger('change');\n    })\n\n    tinyMCEPreInit.mceInit['html_cell_content'] = tinyMCEPreInit.mceInit['wptmditor'];\n    tinyMCEPreInit.mceInit['tooltip_content'] = tinyMCEPreInit.mceInit['wptm_tooltip'];\n    tinyMCE.EditorManager.execCommand('mceRemoveEditor', true, 'wptmditor');\n    $('#wp-wptmditor-wrap').hide();\n}\n\n//fetch google sheet, import file excel\nfunction fetchSpreadsheet(obj) {\n    tableFunction.loading(wptm_element.wpreview);\n\n    var auto_sync, spreadsheet_style, url;\n    var $close_popup = wptm_element.wptm_popup.find('.colose_popup');\n    var loader = wptm_element.wptm_popup.find('.lds-ring');\n    var popup_notification = wptm_element.wptm_popup.find('.popup_notification');\n    var data;\n\n    if (obj.type === 'spreadsheet') {\n        data = tableFunction.getLinkSync(Wptm.style.table.spreadsheet_url, 'spreadsheet', true);\n        if (!data) {\n            return false;\n        }\n        // url = encodeURI(Wptm.style.table.spreadsheet_url);\n        // auto_sync = Wptm.style.table.auto_sync != '1' ? 0 : 1;\n        // spreadsheet_style = Wptm.style.table.spreadsheet_style != '1' ? 0 : 1;\n        // if (url.indexOf(\"docs.google.com/spreadsheet\") === -1) {\n        //     bootbox.alert(wptmText.error_link_google_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.spreadsheet_url = '';\n        //     return;\n        // }\n        //\n        // //check publish link\n        // var end_link = url.split('?');\n        // var end_link0 = end_link[0].slice(-7);\n        // if (end_link0.match(/html|csv|pdf|xlsx/gi) === null && (typeof end_link[1] !== \"undefined\" && end_link[1].match(/sharing|html|csv|pdf|xlsx/gi) === null)) {\n        //     bootbox.alert(wptmText.error_link_google_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.spreadsheet_url = '';\n        //     return;\n        // }\n    } else if (obj.type === 'excel') {\n        data = tableFunction.getLinkSync(Wptm.style.table.excel_url, 'excel', true);\n        if (!data) {\n            return false;\n        }\n        // url = encodeURI(Wptm.style.table.excel_url);\n        // auto_sync = Wptm.style.table.excel_auto_sync != '1' ? 0 : 1;\n        // spreadsheet_style = Wptm.style.table.excel_spreadsheet_style != '1' ? 0 : 1;\n        // if (url.indexOf(\"docs.google.com/spreadsheet\") !== -1) {\n        //     bootbox.alert(wptmText.error_link_import_sync, wptmText.GOT_IT);\n        //     Wptm.style.table.excel_url = '';\n        //     return;\n        // }\n    } else if (obj.type === 'onedrive') {\n        data = tableFunction.getLinkSync(Wptm.style.table.onedrive_url, 'onedrive', true);\n        if (!data) {\n            return false;\n        }\n    }\n\n    var jsonVar = {\n        spreadsheet_url: data.url,\n        id: Wptm.id,\n        sync: data.auto_sync,\n        syncType: obj.type,\n        style: data.spreadsheet_style\n    };\n    delete table_function_data.fetch_data;\n\n    jquery.ajax({\n        url: wptm_ajaxurl + \"task=excel.fetchSpreadsheet&id=\" + Wptm.id,\n        type: \"POST\",\n        data: jsonVar,\n        beforeSend: function() {\n            loader.removeClass('wptm_hiden');\n            popup_notification.addClass('wptm_hiden');\n        },\n        success: function (datas) {\n            loader.addClass('wptm_hiden');\n            var result = jQuery.parseJSON(datas);\n            if (result.response === true) {\n                if (obj.type === 'spreadsheet') {\n                    // table_function_data.auto_sync = result.datas.sync;\n                    table_function_data.spreadsheet_style = result.datas.style;\n                    table_function_data.spreadsheet_url = Wptm.style.table.spreadsheet_url;\n                } else if(obj.type === 'excel') {\n                    // table_function_data.excel_auto_sync = result.datas.sync;\n                    table_function_data.excel_spreadsheet_style = result.datas.style;\n                    table_function_data.excel_url = Wptm.style.table.excel_url;\n                } else if(obj.type === 'onedrive') {\n                    // table_function_data.excel_auto_sync = result.datas.sync;\n                    table_function_data.onedrive_style = result.datas.style;\n                    table_function_data.onedrive_url = Wptm.style.table.onedrive_url;\n                }\n                updatepreview(Wptm.id);\n                popup_notification.html('<span class=\"noti_success\">'+wptmText.DATA_HAS_BEEN_FETCHED+'</span>');\n                if (typeof result.datas.error !== 'undefined' && result.datas.error !== '') {\n                    popup_notification.html('<span class=\"noti_false\">'+result.datas.error+'</span>');\n                    popup_notification.removeClass('wptm_hiden');\n                } else {\n                    if (typeof result.datas.error_read_file !== 'undefined' && result.datas.error_read_file !== '') {\n                        setTimeout(function () {\n                            bootbox.alert(\n                                wptmText.import_is_finished + '<br/>' +\n                                wptmText.error_message_read_file_cells_concerned +\n                                result.datas.error_read_file, wptmText.Ok);\n                        }, 500);\n                    }\n                    popup_notification.removeClass('wptm_hiden');\n                    $close_popup.trigger('click');\n                }\n            } else {\n                popup_notification.html('<span class=\"noti_false\">'+result.response+'</span>');\n                popup_notification.removeClass('wptm_hiden');\n            }\n            tableFunction.rloading(wptm_element.wpreview);\n        },\n        error: function (jqxhr, textStatus, error) {\n            popup_notification.html('<span class=\"noti_false\">'+wptmText.have_error+'</span>');\n            popup_notification.removeClass('wptm_hiden');\n            tableFunction.rloading(wptm_element.wpreview);\n        }\n    });\n}\n\nfunction updateDimession() {\n    var rows = [];\n    var i = 0;\n    for (var row in Wptm.style.rows) {\n        var h = jQuery('#tableContainer .ht_master .htCore tr').eq(i + 1).height();\n        rows[row] = h;\n        i++;\n    }\n\n    jQuery(Wptm.container).handsontable('updateSettings', {rowHeights: rows});\n\n    var ht = jQuery(Wptm.container).handsontable('getInstance');\n    ht.runHooks('afterRowResize');\n}\n\nexport default {\n    updatepreview,\n    fetchSpreadsheet\n};\n"],"sourceRoot":""}